<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/neumino/thinky#readme"

    >thinky (v2.3.8)</a>
</h1>
<h4>RethinkDB ORM for Node.js</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky">module thinky</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document">
            function <span class="apidocSignatureSpan">thinky.</span>document
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed">
            function <span class="apidocSignatureSpan">thinky.</span>feed
            <span class="apidocSignatureSpan">(feed, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model">
            function <span class="apidocSignatureSpan">thinky.</span>model
            <span class="apidocSignatureSpan">(name, schema, options, thinky)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query">
            function <span class="apidocSignatureSpan">thinky.</span>query
            <span class="apidocSignatureSpan">(model, query, options, error)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>document.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>errors</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>feed.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>model.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>query.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>schema</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>type</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.</span>util</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.document">module thinky.document</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.document">
            function <span class="apidocSignatureSpan">thinky.</span>document
            <span class="apidocSignatureSpan">(model, options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.document.prototype">module thinky.document.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.__makeSavableCopy">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>__makeSavableCopy
            <span class="apidocSignatureSpan">(doc, schema, options, model, r)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._batchSave">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_batchSave
            <span class="apidocSignatureSpan">(executeInsert)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._batchSaveSelf">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_batchSaveSelf
            <span class="apidocSignatureSpan">(executeInsert)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._delete">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_delete
            <span class="apidocSignatureSpan">(docToDelete, deleteAll, deletedDocs, deleteSelf, updateParents, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._deleteHook">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_deleteHook
            <span class="apidocSignatureSpan">(docToDelete, deleteAll, deletedDocs, deleteSelf, updateParents, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._emitRetrieve">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_emitRetrieve
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._generateDefault">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_generateDefault
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._getModel">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getModel
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._getOptions">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getOptions
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._getSchemaOptions">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getSchemaOptions
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._getVirtual">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getVirtual
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._makeSavableCopy">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_makeSavableCopy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._merge">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_merge
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._onSaved">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_onSaved
            <span class="apidocSignatureSpan">(result, docToSave, saveAll, savedModel, resolve, reject)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._onSavedBelongsTo">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_onSavedBelongsTo
            <span class="apidocSignatureSpan">( copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._save">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_save
            <span class="apidocSignatureSpan">(docToSave, saveAll, savedModel, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._saveHook">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveHook
            <span class="apidocSignatureSpan">(docToSave, saveAll, savedModel)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._saveLinks">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveLinks
            <span class="apidocSignatureSpan">(docToSave, saveAll, resolve, reject)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._saveMany">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveMany
            <span class="apidocSignatureSpan">(docToSave, saveAll, savedModel, resolve, reject)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._saveSelf">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveSelf
            <span class="apidocSignatureSpan">( copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._saveVirtual">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveVirtual
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._setFeed">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_setFeed
            <span class="apidocSignatureSpan">(feed)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._setOldValue">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_setOldValue
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._setUnSaved">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_setUnSaved
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._validateHook">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_validateHook
            <span class="apidocSignatureSpan">(options, modelToValidate, validateAll, validatedModel, prefix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype._validateIsAsync">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_validateIsAsync
            <span class="apidocSignatureSpan">(modelToValidate, validateAll, validatedModel)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.addRelation">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>addRelation
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.closeFeed">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>closeFeed
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.delete">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>delete
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.deleteAll">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>deleteAll
            <span class="apidocSignatureSpan">(docToDelete, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.generateVirtualValues">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>generateVirtualValues
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.getFeed">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>getFeed
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.getModel">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>getModel
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.getOldValue">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>getOldValue
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.isSaved">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>isSaved
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.merge">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>merge
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.purge">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>purge
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.removeRelation">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>removeRelation
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.save">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>save
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.saveAll">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>saveAll
            <span class="apidocSignatureSpan">(docToSave, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.setSaved">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>setSaved
            <span class="apidocSignatureSpan">(all)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.validate">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>validate
            <span class="apidocSignatureSpan">(options, modelToValidate, validateAll, validatedModel, prefix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.document.prototype.validateAll">
            function <span class="apidocSignatureSpan">thinky.document.prototype.</span>validateAll
            <span class="apidocSignatureSpan">(options, modelToValidate)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.errors">module thinky.errors</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.errors.DocumentNotFound">
            function <span class="apidocSignatureSpan">thinky.errors.</span>DocumentNotFound
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.errors.DuplicatePrimaryKey">
            function <span class="apidocSignatureSpan">thinky.errors.</span>DuplicatePrimaryKey
            <span class="apidocSignatureSpan">(message, primaryKey)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.errors.InvalidWrite">
            function <span class="apidocSignatureSpan">thinky.errors.</span>InvalidWrite
            <span class="apidocSignatureSpan">(message, raw)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.errors.ThinkyError">
            function <span class="apidocSignatureSpan">thinky.errors.</span>ThinkyError
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.errors.ValidationError">
            function <span class="apidocSignatureSpan">thinky.errors.</span>ValidationError
            <span class="apidocSignatureSpan">(message)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.errors.create">
            function <span class="apidocSignatureSpan">thinky.errors.</span>create
            <span class="apidocSignatureSpan">(errorOrMessage)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.errors.</span>DOCUMENT_NOT_FOUND_REGEX</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">thinky.errors.</span>DUPLICATE_PRIMARY_KEY_REGEX</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.feed">module thinky.feed</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.feed">
            function <span class="apidocSignatureSpan">thinky.</span>feed
            <span class="apidocSignatureSpan">(feed, model)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.feed.prototype">module thinky.feed.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype._each">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_each
            <span class="apidocSignatureSpan">(callback, onFinish)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype._eachCb">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_eachCb
            <span class="apidocSignatureSpan">(err, data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype._makeEmitter">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_makeEmitter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype._next">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_next
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.addListener">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>addListener
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.close">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>close
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.emit">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>emit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.listeners">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>listeners
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.on">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>on
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.once">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>once
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.removeAllListeners">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>removeAllListeners
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.removeListener">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>removeListener
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.setMaxListeners">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>setMaxListeners
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.toArray">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>toArray
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.feed.prototype.toString">
            function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.model">module thinky.model</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.model">
            function <span class="apidocSignatureSpan">thinky.</span>model
            <span class="apidocSignatureSpan">(name, schema, options, thinky)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.new">
            function <span class="apidocSignatureSpan">thinky.model.</span>new
            <span class="apidocSignatureSpan">(name, schema, options, thinky)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.super_">
            function <span class="apidocSignatureSpan">thinky.model.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.model.prototype">module thinky.model.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.ISO8601">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ISO8601
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype._createIndex">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_createIndex
            <span class="apidocSignatureSpan">(name, fn, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype._get">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_get
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype._getModel">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_getModel
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype._parse">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_parse
            <span class="apidocSignatureSpan">(data, ungroup)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype._promisesReady">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_promisesReady
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype._setError">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_setError
            <span class="apidocSignatureSpan">(error)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype._waitFor">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_waitFor
            <span class="apidocSignatureSpan">(promise)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.add">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>add
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.and">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>and
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.append">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>append
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.april">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>april
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.args">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>args
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.asc">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>asc
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.august">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>august
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.avg">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>avg
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.belongsTo">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>belongsTo
            <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.between">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>between
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.binary">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>binary
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.bracket">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>bracket
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.branch">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>branch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.catch">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>catch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.ceil">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ceil
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.changeAt">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>changeAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.changes">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>changes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.circle">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>circle
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.coerceTo">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>coerceTo
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.concatMap">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>concatMap
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.config">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>config
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.contains">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>contains
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.count">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>count
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.date">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>date
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.day">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>day
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.dayOfWeek">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dayOfWeek
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.dayOfYear">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dayOfYear
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.db">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>db
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.dbCreate">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dbCreate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.dbDrop">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dbDrop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.dbList">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dbList
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.december">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>december
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.default">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>default
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.define">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>define
            <span class="apidocSignatureSpan">(key, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.defineStatic">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>defineStatic
            <span class="apidocSignatureSpan">(key, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.delay">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>delay
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.delete">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>delete
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.deleteAt">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>deleteAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.desc">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>desc
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.difference">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>difference
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.distance">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>distance
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.distinct">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>distinct
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.div">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>div
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.do">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>do
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.docAddListener">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docAddListener
            <span class="apidocSignatureSpan">(eventKey, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.docListeners">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docListeners
            <span class="apidocSignatureSpan">(eventKey, raw)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.docOn">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docOn
            <span class="apidocSignatureSpan">(eventKey, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.docOnce">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docOnce
            <span class="apidocSignatureSpan">(eventKey, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.docRemoveAllListeners">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docRemoveAllListeners
            <span class="apidocSignatureSpan">(ev)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.docRemoveListener">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docRemoveListener
            <span class="apidocSignatureSpan">(ev, listener)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.docSetMaxListeners">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docSetMaxListeners
            <span class="apidocSignatureSpan">(n)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.downcase">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>downcase
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.during">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>during
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.ensureIndex">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ensureIndex
            <span class="apidocSignatureSpan">(name, fn, opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.epochTime">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>epochTime
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.eq">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>eq
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.eqJoin">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>eqJoin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.error">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>error
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.execute">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>execute
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.expr">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>expr
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.february">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>february
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.fill">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>fill
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.filter">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>filter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.finally">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>finally
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.floor">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>floor
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.fold">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>fold
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.forEach">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>forEach
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.friday">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>friday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.ge">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.geojson">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>geojson
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.get">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>get
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.getAll">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getAll
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.getField">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getField
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.getIntersecting">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getIntersecting
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.getJoin">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getJoin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.getNearest">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getNearest
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.getOptions">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getOptions
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.getTableName">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getTableName
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.grant">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>grant
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.group">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>group
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.gt">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>gt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.hasAndBelongsToMany">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasAndBelongsToMany
            <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.hasFields">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasFields
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.hasMany">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasMany
            <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.hasOne">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasOne
            <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.hours">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hours
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.http">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>http
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.inTimezone">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>inTimezone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.includes">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>includes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.indexCreate">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexCreate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.indexDrop">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexDrop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.indexList">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexList
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.indexRename">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexRename
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.indexStatus">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexStatus
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.indexWait">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexWait
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.indexesOf">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexesOf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.info">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>info
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.innerJoin">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>innerJoin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.insert">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>insert
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.insertAt">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>insertAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.intersects">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>intersects
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.isEmpty">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>isEmpty
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.january">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>january
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.js">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>js
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.json">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>json
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.july">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>july
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.june">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>june
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.keys">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>keys
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.le">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>le
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.limit">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>limit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.line">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>line
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.literal">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>literal
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.lt">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>lt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.map">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>map
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.march">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>march
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.match">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>match
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.max">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>max
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.maxval">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>maxval
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.may">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>may
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.merge">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>merge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.min">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>min
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.minutes">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>minutes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.minval">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>minval
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.mod">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>mod
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.monday">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>monday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.month">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>month
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.mul">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>mul
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.ne">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ne
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.not">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>not
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.november">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>november
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.now">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>now
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.nth">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>nth
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.object">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>object
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.october">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>october
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.offsetsOf">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>offsetsOf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.or">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>or
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.orderBy">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>orderBy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.outerJoin">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>outerJoin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.pluck">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>pluck
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.point">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>point
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.polygon">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>polygon
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.polygonSub">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>polygonSub
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.post">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>post
            <span class="apidocSignatureSpan">(ev, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.pre">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>pre
            <span class="apidocSignatureSpan">(ev, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.prepend">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>prepend
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.random">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>random
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.range">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>range
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.ready">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ready
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.rebalance">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>rebalance
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.reconfigure">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>reconfigure
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.reduce">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>reduce
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.removeRelations">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>removeRelations
            <span class="apidocSignatureSpan">(relationsToRemove)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.replace">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>replace
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.round">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>round
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.row">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>row
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.run">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>run
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.sample">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sample
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.saturday">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>saturday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.save">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>save
            <span class="apidocSignatureSpan">(docs, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.seconds">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>seconds
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.september">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>september
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.setDifference">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setDifference
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.setInsert">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setInsert
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.setIntersection">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setIntersection
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.setUnion">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setUnion
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.skip">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>skip
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.slice">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>slice
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.spliceAt">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>spliceAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.split">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>split
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.status">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>status
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.sub">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sub
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.sum">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sum
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.sunday">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sunday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.sync">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sync
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.table">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>table
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.tableCreate">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableCreate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.tableDrop">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableDrop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.tableList">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableList
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.tableReady">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableReady
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.then">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>then
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.thursday">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>thursday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.time">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>time
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.timeOfDay">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>timeOfDay
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.timezone">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>timezone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.toEpochTime">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toEpochTime
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.toGeojson">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toGeojson
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.toISO8601">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toISO8601
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.toJSON">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toJSON
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.toJsonString">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toJsonString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.toStream">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toStream
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.toString">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.tuesday">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tuesday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.typeOf">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>typeOf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.ungroup">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ungroup
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.union">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>union
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.upcase">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>upcase
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.update">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>update
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.uuid">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>uuid
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.values">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>values
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.wait">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>wait
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.wednesday">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>wednesday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.withFields">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>withFields
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.without">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>without
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.year">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>year
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.model.prototype.zip">
            function <span class="apidocSignatureSpan">thinky.model.prototype.</span>zip
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.query">module thinky.query</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.query">
            function <span class="apidocSignatureSpan">thinky.</span>query
            <span class="apidocSignatureSpan">(model, query, options, error)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.query.prototype">module thinky.query.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.ISO8601">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ISO8601
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype._convertGroupedData">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_convertGroupedData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype._execute">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_execute
            <span class="apidocSignatureSpan">(options, parse)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype._executeCallback">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_executeCallback
            <span class="apidocSignatureSpan">(fullOptions, parse, groupFormat)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype._get">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_get
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype._isPointWrite">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_isPointWrite
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype._validateQueryResult">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_validateQueryResult
            <span class="apidocSignatureSpan">(result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype._validateUngroupResult">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_validateUngroupResult
            <span class="apidocSignatureSpan">(result)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.add">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>add
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.addRelation">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>addRelation
            <span class="apidocSignatureSpan">(field, joinedDocument)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.and">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>and
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.append">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>append
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.april">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>april
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.args">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>args
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.asc">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>asc
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.august">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>august
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.avg">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>avg
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.between">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>between
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.binary">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>binary
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.bindExecute">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>bindExecute
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.bindRun">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>bindRun
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.bracket">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>bracket
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.branch">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>branch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.catch">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>catch
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.ceil">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ceil
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.changeAt">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>changeAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.changes">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>changes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.circle">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>circle
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.coerceTo">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>coerceTo
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.concatMap">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>concatMap
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.config">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>config
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.contains">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>contains
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.count">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>count
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.date">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>date
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.day">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>day
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.dayOfWeek">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dayOfWeek
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.dayOfYear">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dayOfYear
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.db">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>db
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.dbCreate">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dbCreate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.dbDrop">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dbDrop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.dbList">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dbList
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.december">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>december
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.default">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>default
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.delay">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>delay
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.delete">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>delete
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.deleteAt">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>deleteAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.desc">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>desc
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.difference">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>difference
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.distance">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>distance
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.distinct">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>distinct
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.div">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>div
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.do">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>do
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.downcase">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>downcase
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.during">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>during
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.epochTime">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>epochTime
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.eq">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>eq
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.eqJoin">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>eqJoin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.error">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>error
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.execute">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>execute
            <span class="apidocSignatureSpan">(options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.expr">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>expr
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.february">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>february
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.fill">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>fill
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.filter">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>filter
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.finally">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>finally
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.floor">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>floor
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.fold">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>fold
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.forEach">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>forEach
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.friday">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>friday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.ge">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.geojson">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>geojson
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.get">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>get
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.getAll">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getAll
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.getField">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getField
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.getIntersecting">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getIntersecting
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.getJoin">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getJoin
            <span class="apidocSignatureSpan">(modelToGet, getAll, gotModel)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.getNearest">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getNearest
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.grant">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>grant
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.group">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>group
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.gt">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>gt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.hasFields">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>hasFields
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.hours">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>hours
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.http">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>http
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.inTimezone">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>inTimezone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.includes">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>includes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.indexCreate">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexCreate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.indexDrop">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexDrop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.indexList">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexList
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.indexRename">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexRename
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.indexStatus">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexStatus
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.indexWait">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexWait
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.indexesOf">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexesOf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.info">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>info
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.innerJoin">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>innerJoin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.insert">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>insert
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.insertAt">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>insertAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.intersects">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>intersects
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.isEmpty">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>isEmpty
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.january">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>january
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.js">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>js
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.json">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>json
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.july">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>july
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.june">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>june
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.keys">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>keys
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.le">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>le
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.limit">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>limit
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.line">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>line
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.literal">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>literal
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.lt">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>lt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.map">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>map
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.march">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>march
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.match">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>match
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.max">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>max
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.maxval">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>maxval
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.may">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>may
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.merge">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>merge
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.min">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>min
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.minutes">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>minutes
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.minval">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>minval
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.mod">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>mod
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.monday">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>monday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.month">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>month
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.mul">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>mul
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.ne">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ne
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.not">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>not
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.november">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>november
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.now">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>now
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.nth">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>nth
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.object">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>object
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.october">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>october
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.offsetsOf">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>offsetsOf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.or">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>or
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.orderBy">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>orderBy
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.outerJoin">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>outerJoin
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.pluck">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>pluck
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.point">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>point
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.polygon">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>polygon
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.polygonSub">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>polygonSub
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.prepend">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>prepend
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.random">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>random
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.range">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>range
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.rebalance">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>rebalance
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.reconfigure">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>reconfigure
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.reduce">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>reduce
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.removeRelation">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>removeRelation
            <span class="apidocSignatureSpan">(field, joinedDocument)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.replace">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>replace
            <span class="apidocSignatureSpan">(value, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.round">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>round
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.row">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>row
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.run">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>run
            <span class="apidocSignatureSpan">(options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.sample">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sample
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.saturday">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>saturday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.seconds">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>seconds
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.september">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>september
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.setDifference">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setDifference
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.setInsert">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setInsert
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.setIntersection">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setIntersection
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.setPointWrite">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setPointWrite
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.setPostValidation">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setPostValidation
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.setUnion">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setUnion
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.skip">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>skip
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.slice">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>slice
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.spliceAt">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>spliceAt
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.split">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>split
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.status">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>status
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.sub">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sub
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.sum">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sum
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.sunday">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sunday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.sync">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sync
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.table">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>table
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.tableCreate">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tableCreate
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.tableDrop">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tableDrop
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.tableList">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tableList
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.then">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>then
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.thursday">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>thursday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.time">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>time
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.timeOfDay">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>timeOfDay
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.timezone">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>timezone
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.toEpochTime">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toEpochTime
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.toGeojson">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toGeojson
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.toISO8601">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toISO8601
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.toJSON">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toJSON
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.toJsonString">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toJsonString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.toStream">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toStream
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.toString">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toString
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.tuesday">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tuesday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.typeOf">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>typeOf
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.ungroup">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ungroup
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.union">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>union
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.upcase">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>upcase
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.update">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>update
            <span class="apidocSignatureSpan">(value, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.uuid">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>uuid
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.values">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>values
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.wait">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>wait
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.wednesday">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>wednesday
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.withFields">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>withFields
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.without">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>without
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.year">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>year
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.query.prototype.zip">
            function <span class="apidocSignatureSpan">thinky.query.prototype.</span>zip
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.schema">module thinky.schema</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.schema.generateDefault">
            function <span class="apidocSignatureSpan">thinky.schema.</span>generateDefault
            <span class="apidocSignatureSpan">(doc, defaultField, originalDoc)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.schema.generateVirtual">
            function <span class="apidocSignatureSpan">thinky.schema.</span>generateVirtual
            <span class="apidocSignatureSpan">(doc, defaultField, originalDoc, virtual)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.schema.parse">
            function <span class="apidocSignatureSpan">thinky.schema.</span>parse
            <span class="apidocSignatureSpan">(schema, prefix, options, model)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.schema.validate">
            function <span class="apidocSignatureSpan">thinky.schema.</span>validate
            <span class="apidocSignatureSpan">(doc, schema, prefix, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">thinky.schema.</span>arrayPrefix</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.thinky.util">module thinky.util</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.bindEmitter">
            function <span class="apidocSignatureSpan">thinky.util.</span>bindEmitter
            <span class="apidocSignatureSpan">(self)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.changeProto">
            function <span class="apidocSignatureSpan">thinky.util.</span>changeProto
            <span class="apidocSignatureSpan">(object, newProto)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.deepCopy">
            function <span class="apidocSignatureSpan">thinky.util.</span>deepCopy
            <span class="apidocSignatureSpan">(value)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.extraField">
            function <span class="apidocSignatureSpan">thinky.util.</span>extraField
            <span class="apidocSignatureSpan">(prefix, key)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.extractPrimaryKey">
            function <span class="apidocSignatureSpan">thinky.util.</span>extractPrimaryKey
            <span class="apidocSignatureSpan">(oldValue, newValue, primaryKey)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.hook">
            function <span class="apidocSignatureSpan">thinky.util.</span>hook
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.isPlainObject">
            function <span class="apidocSignatureSpan">thinky.util.</span>isPlainObject
            <span class="apidocSignatureSpan">(obj)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.loopKeys">
            function <span class="apidocSignatureSpan">thinky.util.</span>loopKeys
            <span class="apidocSignatureSpan">(obj, fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.looseType">
            function <span class="apidocSignatureSpan">thinky.util.</span>looseType
            <span class="apidocSignatureSpan">(prefix, expected)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.mergeOptions">
            function <span class="apidocSignatureSpan">thinky.util.</span>mergeOptions
            <span class="apidocSignatureSpan">(options, newOptions)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.pseudoTypeError">
            function <span class="apidocSignatureSpan">thinky.util.</span>pseudoTypeError
            <span class="apidocSignatureSpan">(type, missingField, prefix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.recurse">
            function <span class="apidocSignatureSpan">thinky.util.</span>recurse
            <span class="apidocSignatureSpan">(key, joins, modelTo, all, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.strictType">
            function <span class="apidocSignatureSpan">thinky.util.</span>strictType
            <span class="apidocSignatureSpan">(prefix, expected)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.toArray">
            function <span class="apidocSignatureSpan">thinky.util.</span>toArray
            <span class="apidocSignatureSpan">(args)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.tryCatch">
            function <span class="apidocSignatureSpan">thinky.util.</span>tryCatch
            <span class="apidocSignatureSpan">(toTry, handleError)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.undefinedField">
            function <span class="apidocSignatureSpan">thinky.util.</span>undefinedField
            <span class="apidocSignatureSpan">(prefix)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.thinky.util.validateIfUndefined">
            function <span class="apidocSignatureSpan">thinky.util.</span>validateIfUndefined
            <span class="apidocSignatureSpan">(value, prefix, type, options)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky" id="apidoc.module.thinky">module thinky</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.document" id="apidoc.element.thinky.document">
        function <span class="apidocSignatureSpan">thinky.</span>document
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Document(model, options) {
  var self = this;  // Keep a reference to itself.

  this.constructor = model;  // The constructor for this model
  this._model = model._getModel(); // The instance of Model

  // We don&#x27;t want to store options if they are different
  // than the one provided by the model
  if (util.isPlainObject(options)) {
    this._schemaOptions = {};
    this._schemaOptions.enforce_missing =
        (options.enforce_missing != null) ? options.enforce_missing : model.getOptions().enforce_missing;
    this._schemaOptions.enforce_extra =
        (options.enforce_extra != null) ? options.enforce_extra : model.getOptions().enforce_extra;
    this._schemaOptions.enforce_type =
        (options.enforce_type != null) ? options.enforce_type : model.getOptions().enforce_type;
  }

  //TODO: We do not need to make a deep copy. We can do the same as for this._schemaOptions.
  options = options || {};
  this._options = {};
  this._options.timeFormat = (options.timeFormat != null) ? options.timeFormat : model.getOptions().timeFormat;
  this._options.validate = (options.validate != null) ? options.validate : model.getOptions().validate;

  this._saved = options.saved || false;  // Whether the document is saved or not

  util.bindEmitter(self);  // Copy methods from eventEmitter

  // links to hasOne/hasMany documents
  // We use it to know if some links have been removed/added before saving.
  // Example: { key: doc } or { key: [docs] }
  this._belongsTo = {};
  this._hasOne = {};
  this._hasMany = {};
  // Example: { &#x3c;linkTableName&#x3e;: { &#x3c;valueOfRightKey&#x3e;: true, ... }, ... }
  this._links = {}

  // Keep reference of any doc having a link pointing to this
  // So we can clean when users do doc.belongsToDoc.delete()
  this._parents = {
    _hasOne: {},      // &#x3c;tableName&#x3e;: [{doc, key}]
    _hasMany: {},     // &#x3c;tableName&#x3e;: [{doc, key}]
    _belongsTo: {},   // &#x3c;tableName&#x3e;: [{doc, key, foreignKey}]
    _belongsLinks: {} // &#x3c;tableName&#x3e;: [{doc, key}]
  }

  // Bind listeners of the model to this documents.
  util.loopKeys(model._listeners, function(listeners, eventKey) {
    for(var j=0; j&#x3c;listeners[eventKey].length; j++) {
      if (listeners[eventKey][j].once === false) {
        self.addListener(eventKey, listeners[eventKey][j].listener);
      }
      else if (listeners[eventKey][j].once === true) {
        self.once(eventKey, listeners[eventKey][j].listener);
      }
    }
  });


  // Atom feed
  this._active = false;
  this._feed = null;

  // Add customized methods of the model on this document.
  util.loopKeys(model._methods, function(methods, key) {
    if (self[key] === undefined) {
      self[key] = methods[key];
    }
    else {
      //TODO: Should we warn the users? Throw an error?
      console.log(self[key]);
      console.log(&#x22;A property &#x22;+key+&#x22; is already defined in the prototype chain. Skipping.&#x22;);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed" id="apidoc.element.thinky.feed">
        function <span class="apidocSignatureSpan">thinky.</span>feed
        <span class="apidocSignatureSpan">(feed, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Feed(feed, model) {
  this.feed = feed;
  this.model = model;
  this._closed = false;

  this.each = this._each;
  this.next = this._next;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model" id="apidoc.element.thinky.model">
        function <span class="apidocSignatureSpan">thinky.</span>model
        <span class="apidocSignatureSpan">(name, schema, options, thinky)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Model(name, schema, options, thinky) {
<span class="apidocCodeCommentSpan">  /**
   * Name of the table used
   * @type {string}
   */
</span>  this._name = name;

  // We want a deep copy
  options = options || {};
  this._options = {};
  this._options.enforce_missing = (options.enforce_missing != null) ? options.enforce_missing : thinky._options.enforce_missing;
  this._options.enforce_extra = (options.enforce_extra != null) ? options.enforce_extra : thinky._options.enforce_extra;
  this._options.enforce_type = (options.enforce_type != null) ? options.enforce_type : thinky._options.enforce_type;
  this._options.timeFormat = (options.timeFormat != null) ? options.timeFormat : thinky._options.timeFormat;
  this._options.validate = (options.validate != null) ? options.validate : thinky._options.validate;

  this._schema = schemaUtil.parse(schema, &#x27;&#x27;, this._options, this);
  //console.log(JSON.stringify(this._schema, null, 2));

  this.virtualFields = [];
  this.defaultFields = [];
  this._schema._getDefaultFields([], this.defaultFields, this.virtualFields)

  this.needToGenerateFields = (this.defaultFields.length+this.virtualFields.length) !== 0;

  this._pk = (options.pk != null) ? options.pk : &#x27;id&#x27;;

  this._table = (options.table != null) ? options.table : {};
  this._table.primaryKey = this._pk;

  this._thinky = thinky;

  this._validator = options.validator;

  this._indexes = {}; // indexName -&#x3e; true
  this._pendingPromises = [];

  this._error = null; // If an error occured, we won&#x27;t let people save things

  this._listeners = {};
  this._maxListeners = 10;
  this._joins = {};
  this._localKeys = {}; // key used as a foreign key by another model

  // This is to track joins that were not directly called by this model but that we still need
  // to purge the database
  this._reverseJoins = {};

  this._methods = {};
  this._staticMethods = {};
  this._async = {
    init: false,
    retrieve: false,
    save: false,
    validate: false
  };

  this._pre = {
    save: [],
    delete: [],
    validate: []
  };
  this._post = {
    init: [],
    retrieve: [],
    save: [],
    delete: [],
    validate: []
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  util.loopKeys(self._getModel()._joins, function(joins, key) {
if (util.recurse(key, joins, modelToValidate, validateAll, validatedModel)) {
  switch (joins[key].type) {
    case &#x27;hasOne&#x27;:
    case &#x27;belongsTo&#x27;:
      if (util.isPlainObject(self[key])) {
        if (self[key] instanceof Document === false) {
          self[key] = new self._getModel()._joins[key].<span class="apidocCodeKeywordSpan">model</span>(self[key]);
        }
        // We do not propagate the options of this document, but only those given to validate
        var promise = self[key].validate(options, modelToValidate[key], validateAll, validatedModel, prefix+&#x27;[&#x27;+key+&#
x27;]&#x27;);
        if (promise instanceof Promise) {
          promises.push(promise);
          promise = null;
        }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query" id="apidoc.element.thinky.query">
        function <span class="apidocSignatureSpan">thinky.</span>query
        <span class="apidocSignatureSpan">(model, query, options, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Query(model, query, options, error) {
  var self = this;

  this._model = model; // constructor of the model we should use for the results.
  if (model !== undefined) {
    this._r = model._getModel()._thinky.r;
    util.loopKeys(model._getModel()._staticMethods, function(staticMethods, key) {
      (function(_key) {
        self[_key] = function() {
          return staticMethods[_key].apply(self, arguments);
        };
      })(key);
    });
  }

  if (query !== undefined) {
    this._query = query;
   }
  else if (model !== undefined) {
    // By default, we initialize the query to `r.table(&#x3c;tableName&#x3e;)`.
    this._query = this._r.table(model.getTableName());
  }

  if (util.isPlainObject(options)) {
    if (options.postValidation) {
      this._postValidation = options.postValidation === true;
    }
    if (options.ungroup) {
      this._ungroup = options.ungroup === true;
    }
    else {
      this._ungroup = false;
    }
  }
  else { // let the user rework the result after ungroup
    this._ungroup = false;
  }
  if (error) {
    // Note `Query.prototype.error` is defined because of `r.error`, so we shouldn&#x27;t
    // defined this.error.
    this._error = error;
  }
  this._pointWrite = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


















</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.document" id="apidoc.module.thinky.document">module thinky.document</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.document.document" id="apidoc.element.thinky.document.document">
        function <span class="apidocSignatureSpan">thinky.</span>document
        <span class="apidocSignatureSpan">(model, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Document(model, options) {
  var self = this;  // Keep a reference to itself.

  this.constructor = model;  // The constructor for this model
  this._model = model._getModel(); // The instance of Model

  // We don&#x27;t want to store options if they are different
  // than the one provided by the model
  if (util.isPlainObject(options)) {
    this._schemaOptions = {};
    this._schemaOptions.enforce_missing =
        (options.enforce_missing != null) ? options.enforce_missing : model.getOptions().enforce_missing;
    this._schemaOptions.enforce_extra =
        (options.enforce_extra != null) ? options.enforce_extra : model.getOptions().enforce_extra;
    this._schemaOptions.enforce_type =
        (options.enforce_type != null) ? options.enforce_type : model.getOptions().enforce_type;
  }

  //TODO: We do not need to make a deep copy. We can do the same as for this._schemaOptions.
  options = options || {};
  this._options = {};
  this._options.timeFormat = (options.timeFormat != null) ? options.timeFormat : model.getOptions().timeFormat;
  this._options.validate = (options.validate != null) ? options.validate : model.getOptions().validate;

  this._saved = options.saved || false;  // Whether the document is saved or not

  util.bindEmitter(self);  // Copy methods from eventEmitter

  // links to hasOne/hasMany documents
  // We use it to know if some links have been removed/added before saving.
  // Example: { key: doc } or { key: [docs] }
  this._belongsTo = {};
  this._hasOne = {};
  this._hasMany = {};
  // Example: { &#x3c;linkTableName&#x3e;: { &#x3c;valueOfRightKey&#x3e;: true, ... }, ... }
  this._links = {}

  // Keep reference of any doc having a link pointing to this
  // So we can clean when users do doc.belongsToDoc.delete()
  this._parents = {
    _hasOne: {},      // &#x3c;tableName&#x3e;: [{doc, key}]
    _hasMany: {},     // &#x3c;tableName&#x3e;: [{doc, key}]
    _belongsTo: {},   // &#x3c;tableName&#x3e;: [{doc, key, foreignKey}]
    _belongsLinks: {} // &#x3c;tableName&#x3e;: [{doc, key}]
  }

  // Bind listeners of the model to this documents.
  util.loopKeys(model._listeners, function(listeners, eventKey) {
    for(var j=0; j&#x3c;listeners[eventKey].length; j++) {
      if (listeners[eventKey][j].once === false) {
        self.addListener(eventKey, listeners[eventKey][j].listener);
      }
      else if (listeners[eventKey][j].once === true) {
        self.once(eventKey, listeners[eventKey][j].listener);
      }
    }
  });


  // Atom feed
  this._active = false;
  this._feed = null;

  // Add customized methods of the model on this document.
  util.loopKeys(model._methods, function(methods, key) {
    if (self[key] === undefined) {
      self[key] = methods[key];
    }
    else {
      //TODO: Should we warn the users? Throw an error?
      console.log(self[key]);
      console.log(&#x22;A property &#x22;+key+&#x22; is already defined in the prototype chain. Skipping.&#x22;);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.document.prototype" id="apidoc.module.thinky.document.prototype">module thinky.document.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.document.prototype.__makeSavableCopy" id="apidoc.element.thinky.document.prototype.__makeSavableCopy">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>__makeSavableCopy
        <span class="apidocSignatureSpan">(doc, schema, options, model, r)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">__makeSavableCopy = function (doc, schema, options, model, r) {
  var localOptions; // can be undefined
  if (schema !== undefined) {
    localOptions = schema._options;
  }

  // model is an instance of a Model (for the top level fields), or undefined
  var result, key, keys, nextSchema, copyFlag;
  if (type.isDate(schema) &#x26;&#x26; (typeof doc === &#x27;string&#x27; || typeof doc === &#x27;number&#x27;)) {
    if (typeof doc === &#x27;number&#x27;) {
      var numericDate = parseInt(doc, 10);
      if(!isNaN(numericDate)) {
        doc = numericDate;
      }
    }
    return new Date(doc); // Use r.ISO8601 and not `new Date()` to keep timezone
  }
  else if (type.isPoint(schema)) {
    if (util.isPlainObject(doc) &#x26;&#x26; (doc[&#x27;$reql_type$&#x27;] !== &#x22;GEOMETRY&#x22;)) {
      var keys = Object.keys(doc).sort();
      if ((keys.length === 2) &#x26;&#x26; (keys[0] === &#x27;latitude&#x27;) &#x26;&#x26; (keys[1] === &#x27;longitude&#x27;) &#x26;&#x26; (typeof doc.latitude === &#x22;number&#x22;) &#x26;&#x26; (
typeof doc.longitude === &#x22;number&#x22;)) {
        return r.point(doc.longitude, doc.latitude)
      }
      else if ((doc.type === &#x22;Point&#x22;) &#x26;&#x26; (Array.isArray(doc.coordinates)) &#x26;&#x26; (doc.coordinates.length === 2)) { // Geojson
        return r.geojson(doc)
      }
    }
    else if (Array.isArray(doc)) {
      if ((doc.length === 2) &#x26;&#x26; (typeof doc[0] === &#x22;number&#x22;) &#x26;&#x26; (typeof doc[1] === &#x22;number&#x22;)) {
        return r.point(doc[0], doc[1])
      }
    }
    else { // no transformation are required here, return doc
      return doc;
    }
  }
  else if (type.isNumber(schema) &#x26;&#x26; (typeof doc === &#x27;string&#x27;)) {
    var numericString = parseFloat(doc);
    if(!isNaN(numericString)){
      return numericString;
    }else{
      return doc;
    }
  }

  if (util.isPlainObject(doc) &#x26;&#x26; (doc instanceof Buffer === false)) {
    result = {};
    util.loopKeys(doc, function(doc, key) {
      copyFlag = true;
      if ((util.isPlainObject(model) === false) || (model._joins[key] === undefined)) { // We do not copy joined documents
        if ((schema !== undefined) &#x26;&#x26; (schema._schema !== undefined) &#x26;&#x26; (type.isVirtual(schema._schema[key]) === true)) {
          // We do not copy virtual
        }
        else if (((schema === undefined) || (schema._schema === undefined) || (schema._schema[key] === undefined)) &#x26;&#x26;
            (localOptions !== undefined) &#x26;&#x26; (localOptions.enforce_extra === &#x22;remove&#x22;)) {
          // We do not copy fields if enfroce_extra is &#x22;remove&#x22;
        }
        else {
          if ((schema !== undefined) &#x26;&#x26; (schema._schema !== undefined)) {
            nextSchema = schema._schema[key];
          }
          else {
            nextSchema = undefined;
          }
          result[key] = Document.prototype.__makeSavableCopy(doc[key], nextSchema, localOptions, undefined, r);
        }
      }
    });

    // Copy the fields that are used as foreign keys
    if (util.isPlainObject(model) === true) {
      util.loopKeys(model._localKeys, function(localKeys, localKey) {
        if (doc[localKey] !== undefined) {
          if (schema !== undefined) {
            nextSchema = schema._schema[key];
          }
          else {
            nextSchema = undefined;
          }
          //TODO: Do we want to copy the foreign key value? If yes, there&#x27;s no need for this loop
          //Do we want to copy the key from the joined document? If yes we need to replace doc[localKey]
          result[localKey] = Document.prototype.__makeSavableCopy(doc[localKey], nextSchema, localOptions, undefined, r);
        }
      });
    }
    return result;
  }
  else if (Array.isArray(doc)) {
    result = [];
    copyFlag = true;

    // Next schema
    if (type.isArray(schema)) {
      nextSchema = schema._schema;
    }
    else if ((util.isPlainObject(schema)) &#x26;&#x26; (schema._type !== undefined) &#x26;&#x26; (schema._schema !== undefined)) {
      nextSchema = schema._schema
      if (schema._type === &#x22;virtual&#x22;) {
        copyFlag = false;
      }
    }
    else {
      nextSchema = undefined;
    }
    if (copyFlag === true) {
      for(var i=0; i&#x3c;doc.length; i++) {
        result.push(Document.prototype.__makeSavableCopy(doc[i], nextSchema, localOptions, undefined, r));
      }
    }
    return result; ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...

 var r = this._getModel()._thinky.r;

 if (this._getModel().needToGenerateFields === true){
   this._generateDefault();
 }

 return this.<span class="apidocCodeKeywordSpan">__makeSavableCopy</span>(this, schema, this._getOptions(), model, r)
}


/**
* Internal helper for _makeSavableCopy.
* generating the dfault and virtual fields.
* @return {any} the copy of the field/object.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._batchSave" id="apidoc.element.thinky.document.prototype._batchSave">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_batchSave
        <span class="apidocSignatureSpan">(executeInsert)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_batchSave = function (executeInsert) {
  // Keep in sync with _save
  var self = this;
  self.emit(&#x27;saving&#x27;, self);

  return util.hook({
    preHooks: self._getModel()._pre.save,
    postHooks: self._getModel()._post.save,
    doc: self,
    async: true,
    fn: self._batchSaveSelf,
    fnArgs: [executeInsert]
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  });
}

if (foundNonValidDoc === false) {
  Promise.all(promises).then(function() {
    var promises = [];
    for(var i=0; i&#x3c;docs.length; i++) {
      promises.push(docs[i].<span class="apidocCodeKeywordSpan">_batchSave</span>(executeInsert));
    }
    Promise.all(promises).then(function() {
      mainResolve(docs);
    }).error(function(error) {
      mainReject(error)
    });
  }).error(function(error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._batchSaveSelf" id="apidoc.element.thinky.document.prototype._batchSaveSelf">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_batchSaveSelf
        <span class="apidocSignatureSpan">(executeInsert)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_batchSaveSelf = function (executeInsert) {
  var self = this;

  return new Promise(function(resolve, reject) {
    self.getModel().ready().then(function() {
      executeInsert(resolve, reject)
    });
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._delete" id="apidoc.element.thinky.document.prototype._delete">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_delete
        <span class="apidocSignatureSpan">(docToDelete, deleteAll, deletedDocs, deleteSelf, updateParents, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_delete = function (docToDelete, deleteAll, deletedDocs, deleteSelf, updateParents, callback) {
  //TODO Set a (string) id per document and use it to perform faster lookup
  var self = this;

  if (util.isPlainObject(docToDelete) === false) {
    docToDelete = {};
  }

  deleteSelf = (deleteSelf === undefined) ? true: deleteSelf;

  return util.hook({
    preHooks: self._getModel()._pre.delete,
    postHooks: self._getModel()._post.delete,
    doc: self,
    async: true,
    fn: self._deleteHook,
    fnArgs: [docToDelete, deleteAll, deletedDocs, deleteSelf, updateParents, callback]
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* removing the foreign key for hasOne/hasMany joined documents, and remove the
* links for hasAndBelongsToMany joined documents if the link is built on the
* primary key.
* @param {Function=} callback
* @return {Promise=} Return a promise if no callback is provided
*/
Document.prototype.delete = function(callback) {
 return this.<span class="apidocCodeKeywordSpan">_delete</span>({}, false, [], true, true, callback)
}


/**
* Delete the document from the database and the joined documents. If
* `docToDelete` is undefined, it will delete all the joined documents, else it
* will limits itself to the one stored in the keys defined in `docToDelete`.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._deleteHook" id="apidoc.element.thinky.document.prototype._deleteHook">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_deleteHook
        <span class="apidocSignatureSpan">(docToDelete, deleteAll, deletedDocs, deleteSelf, updateParents, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_deleteHook = function (docToDelete, deleteAll, deletedDocs, deleteSelf, updateParents, callback) {
  var self = this;
  var model = self._getModel(); // instance of Model
  var constructor = self.getModel();
  var r = model._thinky.r;

  var promises = [];

  deletedDocs.push(self);
  util.loopKeys(self._getModel()._joins, function(joins, key) {
    if ((joins[key].type === &#x27;hasOne&#x27;) &#x26;&#x26; (self[key] instanceof Document)) {
      if ((self[key].isSaved() === true) &#x26;&#x26;
        ((key in docToDelete) || ((deleteAll === true) &#x26;&#x26; (deletedDocs.indexOf(self[key]) === -1)))) {

        (function(key) {
          promises.push(new Promise(function(resolve, reject) {
            self[key]._delete(docToDelete[key], deleteAll, deletedDocs, true, false).then(function() {
              delete self[key];
              resolve();
            }).error(reject);
          }))
        })(key);
      }
      else if ((deleteSelf === true) &#x26;&#x26; (deletedDocs.indexOf(self[key]) === -1)) {
        delete self[key][joins[key].rightKey];
        if (self[key].isSaved() === true) {
          promises.push(self[key].save({}, false, {}, true, false));
        }
      }
    }
    if ((joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; (self[key] instanceof Document)) {
      if ((self[key].isSaved() === true) &#x26;&#x26;
        ((key in docToDelete) || ((deleteAll === true) &#x26;&#x26; (deletedDocs.indexOf(self[key]) === -1)))) {

        (function(key) {
          promises.push(new Promise(function(resolve, reject) {
            self[key]._delete(docToDelete[key], deleteAll, deletedDocs, true, false).then(function() {
              delete self[key];
              resolve();
            }).error(reject);
          }));
        })(key);
      }
    }

    if ((joins[key].type === &#x27;hasMany&#x27;) &#x26;&#x26; (Array.isArray(self[key]))) {
      var manyPromises = [];
      for(var i=0; i&#x3c;self[key].length; i++) {
        if (((self[key][i] instanceof Document) &#x26;&#x26; (self[key][i].isSaved() === true))
          &#x26;&#x26; ((key in docToDelete) || ((deleteAll === true) &#x26;&#x26; (deletedDocs.indexOf(self[key][i]) === -1)))) {

          manyPromises.push(self[key][i]._delete(docToDelete[key], deleteAll, deletedDocs, true, false))
        }
        else if ((self[key][i] instanceof Document) &#x26;&#x26; (deletedDocs.indexOf(self[key][i]) === -1)) {
          delete self[key][i][joins[key].rightKey];
          if (self[key][i].isSaved() === true) {
            promises.push(self[key][i].save({}, false, {}, true, false))
          }
        }
      }
      (function(key) {
        promises.push(new Promise(function(resolve, reject) {
          Promise.all(manyPromises).then(function() {
            delete self[key];
            resolve()
          })
        }));
      })(key)
    }
    if ((joins[key].type === &#x27;hasAndBelongsToMany&#x27;) &#x26;&#x26; (Array.isArray(self[key]))) {
      // Delete links + docs
      var pks = []; // primary keys of the documents
      var linksPks = []; // primary keys of the links

      // Store the element we are going to delete.
      // If the user force the deletion of the same element multiple times, we can&#x27;t naively loop
      // over the elements in the array...
      var docsToDelete = [];


      for(var i=0; i&#x3c;self[key].length; i++) {
        if (((self[key][i] instanceof Document) &#x26;&#x26; (self[key][i].isSaved() === true))
          &#x26;&#x26; ((key in docToDelete) || ((deleteAll === true) &#x26;&#x26; (deletedDocs.indexOf(self[key][i]) === -1)))) {

          //pks.push(self[key][i][joins[key].model._getModel()._pk]);
          docsToDelete.push(self[key][i]);
          // We are going to do a range delete, but we still have to recurse
          promises.push(self[key][i]._delete(docToDelete[key], deleteAll, deletedDocs, true, false))

          if (self.getModel()._getModel()._pk === joins[key].leftKey) {
            // The table is created since we are deleting an element from it
            if (self._getModel()._name === joins[key].model._getModel()._name) {
              if (self[joins[key].leftKey] &#x3c; self[key][i][joins[key].rightKey]) {
                //TODO Add test for this
                linksPks.push(self[joins[key].leftKey]+&#x22;_&#x22;+s ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._emitRetrieve" id="apidoc.element.thinky.document.prototype._emitRetrieve">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_emitRetrieve
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_emitRetrieve = function () {
  var self = this;
  self.getModel().emit(&#x27;retrieved&#x27;, self);
  util.loopKeys(self._getModel()._joins, function(joins, key) {
    var join = joins[key];
    if ((joins[key].type === &#x27;hasOne&#x27;) || (joins[key].type === &#x27;belongsTo&#x27;)) {
      if ((self[key] != null) &#x26;&#x26; (typeof self[key]._emitRetrieve === &#x27;function&#x27;)) {
        self[key]._emitRetrieve();
      }
    }
    else if ((joins[key].type === &#x27;hasMany&#x27;) || (joins[key].type === &#x27;hasAndBelongsToMany&#x27;)) {
      if (Array.isArray(self[key])) {
        for(var i=0; i&#x3c;self[key].length; i++) {
          if (typeof self[key][i]._emitRetrieve === &#x27;function&#x27;) {
            self[key][i]._emitRetrieve();
          }
        }
      }
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Document.prototype._emitRetrieve = function() {
var self = this;
self.getModel().emit(&#x27;retrieved&#x27;, self);
util.loopKeys(self._getModel()._joins, function(joins, key) {
  var join = joins[key];
  if ((joins[key].type === &#x27;hasOne&#x27;) || (joins[key].type === &#x27;belongsTo&#x27;)) {
    if ((self[key] != null) &#x26;&#x26; (typeof self[key]._emitRetrieve === &#x27;function&#x27;)) {
      self[key].<span class="apidocCodeKeywordSpan">_emitRetrieve</span>();
    }
  }
  else if ((joins[key].type === &#x27;hasMany&#x27;) || (joins[key].type === &#x27;hasAndBelongsToMany&#x27;)) {
    if (Array.isArray(self[key])) {
      for(var i=0; i&#x3c;self[key].length; i++) {
        if (typeof self[key][i]._emitRetrieve === &#x27;function&#x27;) {
          self[key][i]._emitRetrieve();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._generateDefault" id="apidoc.element.thinky.document.prototype._generateDefault">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_generateDefault
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_generateDefault = function () {
  for(var i=0; i&#x3c;this._getModel().defaultFields.length; i++) {
    schemaUtil.generateDefault(this, this._getModel().defaultFields[i], this);
  }
  if (this._getModel().virtualFields.length &#x3e; 0) {
    this.generateVirtualValues();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Document.prototype._makeSavableCopy = function() {
  var model = this._getModel(); // instance of Model
  var schema = this._getModel()._schema;

  var r = this._getModel()._thinky.r;

  if (this._getModel().needToGenerateFields === true){
    this.<span class="apidocCodeKeywordSpan">_generateDefault</span>();
  }

  return this.__makeSavableCopy(this, schema, this._getOptions(), model, r)
}


/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._getModel" id="apidoc.element.thinky.document.prototype._getModel">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getModel
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getModel = function () {
  return this.__proto__._model;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {function} model The model of this document
 * @param {object=} options Options that can overwrite the ones of the model
 */
function Document(model, options) {
var self = this;  // Keep a reference to itself.

this.constructor = model;  // The constructor for this model
this._model = model.<span class="apidocCodeKeywordSpan">_getModel</span>(); // The instance of Model

// We don&#x27;t want to store options if they are different
// than the one provided by the model
if (util.isPlainObject(options)) {
  this._schemaOptions = {};
  this._schemaOptions.enforce_missing =
      (options.enforce_missing != null) ? options.enforce_missing : model.getOptions().enforce_missing;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._getOptions" id="apidoc.element.thinky.document.prototype._getOptions">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getOptions
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getOptions = function () {
  return this.__proto__._options;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

 var r = this._getModel()._thinky.r;

 if (this._getModel().needToGenerateFields === true){
   this._generateDefault();
 }

 return this.__makeSavableCopy(this, schema, this.<span class="apidocCodeKeywordSpan">_getOptions</span>(), model, r)
}


/**
* Internal helper for _makeSavableCopy.
* generating the dfault and virtual fields.
* @return {any} the copy of the field/object.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._getSchemaOptions" id="apidoc.element.thinky.document.prototype._getSchemaOptions">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getSchemaOptions
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getSchemaOptions = function () {
  return this.__proto__._schemaOptions;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @return {Promise=} return a promise if the validation is asynchrone, else undefined.
 */
Document.prototype._validateHook = function(options, modelToValidate, validateAll, validatedModel, prefix) {
var self = this;
var promises = [];
var error;

var schemaOptions = self.<span class="apidocCodeKeywordSpan">_getSchemaOptions</span>();
if (util.isPlainObject(schemaOptions)) {
  schemaOptions = util.mergeOptions(schemaOptions, options);
}
else {
  schemaOptions = options;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._getVirtual" id="apidoc.element.thinky.document.prototype._getVirtual">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_getVirtual
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getVirtual = function () {
  return this.__proto__.virtualValue;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Generate the virtual values for the document, or re-inject the ones
* previously saved.
* This should be called **after** `_generateDefault`.
*/
Document.prototype.generateVirtualValues = function() {
 for(var i=0; i&#x3c;this._getModel().virtualFields.length; i++) {
   schemaUtil.generateVirtual(this, this._getModel().virtualFields[i], this, this.<span class="apidocCodeKeywordSpan">_getVirtual
</span>());
 }
}


/**
* Generate the default values for the document, first the non virtual fields, and then
* the virtual fields.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._makeSavableCopy" id="apidoc.element.thinky.document.prototype._makeSavableCopy">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_makeSavableCopy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_makeSavableCopy = function () {
  var model = this._getModel(); // instance of Model
  var schema = this._getModel()._schema;

  var r = this._getModel()._thinky.r;

  if (this._getModel().needToGenerateFields === true){
    this._generateDefault();
  }

  return this.__makeSavableCopy(this, schema, this._getOptions(), model, r)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// - Save this
// - Save hasOne, hasMany and hasAndBelongsToMany docs
// - Save links

// We&#x27;ll use it to know which `belongsTo` docs were saved
var belongsToKeysSaved = {};

var copy = self.<span class="apidocCodeKeywordSpan">_makeSavableCopy</span>();
self._saveVirtual();

// Save the joined documents via belongsTo first
var promises = [];
util.loopKeys(model._joins, function(joins, key) {
  if ((docToSave.hasOwnProperty(key) || (saveAll === true)) &#x26;&#x26;
      (joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; ((saveAll === false) || (savedModel[joins[key].model.getTableName
()] !== true))) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._merge" id="apidoc.element.thinky.document.prototype._merge">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_merge
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_merge = function (obj) {
  var self = this;
  util.loopKeys(self, function(self, key) {
    if ((obj[key] === undefined) &#x26;&#x26; (self._getModel()._joins[key] === undefined)) {
      delete self[key];
    }
  });
  util.loopKeys(obj, function(obj, key) {
    self[key] = obj[key];
  });
  return self;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  if (result.first_error != null) {
return reject(Errors.create(result.first_error));
  }

  util.tryCatch(function() { // Validate the doc, replace it, and tag it as saved
if (Array.isArray(result.changes) &#x26;&#x26; result.changes.length &#x3e; 0) {
  self.<span class="apidocCodeKeywordSpan">_merge</span>(result.changes[0].new_val);
  self._setOldValue(util.deepCopy(result.changes[0].old_val));
}

if (self._getModel().needToGenerateFields === true) {
  self._generateDefault();
}
self.setSaved();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._onSaved" id="apidoc.element.thinky.document.prototype._onSaved">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_onSaved
        <span class="apidocSignatureSpan">(result, docToSave, saveAll, savedModel, resolve, reject)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onSaved = function (result, docToSave, saveAll, savedModel, resolve, reject) {
  // Keep in sync with Model.save
  var self = this;

  if (result.first_error != null) {
    return reject(Errors.create(result.first_error));
  }

  util.tryCatch(function() { // Validate the doc, replace it, and tag it as saved
    if (Array.isArray(result.changes) &#x26;&#x26; result.changes.length &#x3e; 0) {
      self._merge(result.changes[0].new_val);
      self._setOldValue(util.deepCopy(result.changes[0].old_val));
    }

    if (self._getModel().needToGenerateFields === true) {
      self._generateDefault();
    }
    self.setSaved();
    self.emit(&#x27;saved&#x27;, self);

    var promise = self.validate();
    if (promise instanceof Promise) {
      promise.then(function() {
        self._saveMany(docToSave, saveAll, savedModel, resolve, reject)
      }).error(reject);
    }
    else {
      self._saveMany(docToSave, saveAll, savedModel, resolve, reject)
    }
  }, reject);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    util.tryCatch(function() {
// Validate the document before saving it
var promise = self.validate();
if (promise instanceof Promise) {
  promise.then(function() {
    querySaveSelf = buildQuery();
    querySaveSelf.run().then(function(result) {
      self.<span class="apidocCodeKeywordSpan">_onSaved</span>(result, docToSave, saveAll, savedModel, resolve, reject)
    }).error(reject)
  }).error(reject);
}
else {
  querySaveSelf = buildQuery();
  querySaveSelf.run().then(function(result) {
    self._onSaved(result, docToSave, saveAll, savedModel, resolve, reject)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._onSavedBelongsTo" id="apidoc.element.thinky.document.prototype._onSavedBelongsTo">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_onSavedBelongsTo
        <span class="apidocSignatureSpan">( copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_onSavedBelongsTo = function ( copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject) {
  var self = this;
  var model = self._getModel();
  var constructor = self.__proto__.constructor;
  var r = this._getModel()._thinky.r;

  util.loopKeys(belongsToKeysSaved, function(joins, key) {
    var joins = model._joins;
    if (self[key] != null) {

      self.__proto__._belongsTo[key] = true;

      // Copy foreign key
      if (self[key][joins[key].rightKey] == null) {
        if (self.hasOwnProperty(joins[key].leftKey)) {
          delete self[joins[key][joins[key].leftKey]];
        }
        if (copy.hasOwnProperty(joins[key].leftKey)) {
          delete copy[joins[key][joins[key].leftKey]];
        }
      }
      else {
        self[joins[key].leftKey] = self[key][joins[key].rightKey];
        copy[joins[key].leftKey] = self[key][joins[key].rightKey]; // We need to put it in copy before saving it
      }

      // Save the document that belongs to self[key]
      if (self[key].__proto__._parents._belongsTo[constructor.getTableName()] == null) {
        self[key].__proto__._parents._belongsTo[constructor.getTableName()] = [];
      }
      self[key].__proto__._parents._belongsTo[constructor.getTableName()].push({
        doc: self,
        foreignKey: joins[key].leftKey,
        key: key // foreignDoc
      });
    }
  });
  self._saveSelf(copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
      }
    });

    //TODO Remove once
    self.getModel().ready().then(function() {
      Promise.all(promises).then(function() {
        self.<span class="apidocCodeKeywordSpan">_onSavedBelongsTo</span>(copy, docToSave, belongsToKeysSaved, saveAll, savedModel
, resolve, reject);
      }).error(reject);
    });
  });
  return p;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._save" id="apidoc.element.thinky.document.prototype._save">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_save
        <span class="apidocSignatureSpan">(docToSave, saveAll, savedModel, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_save = function (docToSave, saveAll, savedModel, callback) {
  //TOIMPROVE? How should we handle circular references outsides of joined fields? Now we throw with a maximum call stack size exceed
  var self = this;
  self.emit(&#x27;saving&#x27;, self);

  return util.hook({
    preHooks: self._getModel()._pre.save,
    postHooks: self._getModel()._post.save,
    doc: self,
    async: true,
    fn: self._saveHook,
    fnArgs: [docToSave, saveAll, savedModel]
  }).nodeify(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Save the document and execute the hooks. Return a promise if the callback
* is not provided.
* @param {function=} callback to execute
* @return {Promise=}
*/
Document.prototype.save = function(callback) {
 return this.<span class="apidocCodeKeywordSpan">_save</span>({}, false, {}, callback);
}


/**
* Save the document and its joined documents. It will also execute the hooks.
* Return a promise if the callback is not provided.
* It will save joined documents as long as a document of the same model has not
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._saveHook" id="apidoc.element.thinky.document.prototype._saveHook">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveHook
        <span class="apidocSignatureSpan">(docToSave, saveAll, savedModel)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_saveHook = function (docToSave, saveAll, savedModel) {
  var self = this;
  var model = self._getModel(); // instance of Model
  var constructor = self.getModel();
  var r = model._thinky.r;

  if (util.isPlainObject(docToSave) === false) {
    docToSave = {};
  }

  savedModel[constructor.getTableName()] = true;


  var p = new Promise(function(resolve, reject) {
    // Steps:
    // - Save belongsTo
    // - Save this
    // - Save hasOne, hasMany and hasAndBelongsToMany docs
    // - Save links

    // We&#x27;ll use it to know which `belongsTo` docs were saved
    var belongsToKeysSaved = {};

    var copy = self._makeSavableCopy();
    self._saveVirtual();

    // Save the joined documents via belongsTo first
    var promises = [];
    util.loopKeys(model._joins, function(joins, key) {
      if ((docToSave.hasOwnProperty(key) || (saveAll === true)) &#x26;&#x26;
          (joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; ((saveAll === false) || (savedModel[joins[key].model.getTableName()] !== true))) {

        belongsToKeysSaved[key] = true;
        if (self[key] != null) {
          savedModel[joins[key].model.getTableName()] = true;
          if (saveAll === true) {
            promises.push(self[key]._save({}, true, savedModel))
          }
          else {
            promises.push(self[key]._save(docToSave[joins[key].model.getTableName()], false, savedModel))
          }
        }
      }
    });

    //TODO Remove once
    self.getModel().ready().then(function() {
      Promise.all(promises).then(function() {
        self._onSavedBelongsTo(copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject);
      }).error(reject);
    });
  });
  return p;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._saveLinks" id="apidoc.element.thinky.document.prototype._saveLinks">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveLinks
        <span class="apidocSignatureSpan">(docToSave, saveAll, resolve, reject)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_saveLinks = function (docToSave, saveAll, resolve, reject) {
  var self = this;
  var model = self._getModel();
  var constructor = self.getModel();
  var r = model._thinky.r;

  var promisesLink = [];

  util.loopKeys(model._joins, function(joins, key) {
    // Write tests about that!
    if (((key in docToSave) || (saveAll === true)) &#x26;&#x26;
        (joins[key].type === &#x27;hasAndBelongsToMany&#x27;)) {

      if (Array.isArray(self[key])) {
        var newKeys = {}
        for(var i=0; i&#x3c;self[key].length; i++) {
          if (util.isPlainObject(self[key][i])) {
            if (self[key][i].isSaved() === true) {
              newKeys[self[key][i][joins[key].rightKey]] = true;
            }
          }
          else { // self[key][i] is just the key
            newKeys[self[key][i]] = true;
          }
        }

        if (self.__proto__._links[joins[key].link] === undefined) {
          self.__proto__._links[joins[key].link] = {}
        }
        var oldKeys = self.__proto__._links[joins[key].link];

        util.loopKeys(newKeys, function(newKeys, link) {
          if (oldKeys[link] !== true) {
            var newLink = {};

            if ((constructor.getTableName() === joins[key].model.getTableName())
              &#x26;&#x26; (joins[key].leftKey === joins[key].rightKey)) {

              // We link on the same model and same key
              // We don&#x27;t want to save redundant field
              if (link &#x3c; self[joins[key].leftKey]) {
                newLink.id = link+&#x22;_&#x22;+self[joins[key].leftKey];
              }
              else {
                newLink.id = self[joins[key].leftKey]+&#x22;_&#x22;+link;
              }
              newLink[joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey] = [link, self[joins[key].leftKey]];
            }
            else {
              newLink[constructor.getTableName()+&#x22;_&#x22;+joins[key].leftKey] = self[joins[key].leftKey];
              newLink[joins[key].model.getTableName()+&#x22;_&#x22;+joins[key].rightKey] = link;

              // Create the primary key
              if (constructor.getTableName() &#x3c; joins[key].model.getTableName()) {
                newLink.id = self[joins[key].leftKey]+&#x22;_&#x22;+link;
              }
              else if (constructor.getTableName() &#x3e; joins[key].model.getTableName()) {
                newLink.id = link+&#x22;_&#x22;+self[joins[key].leftKey];
              }
              else {
                if (link &#x3c; self[joins[key].leftKey]) {
                  newLink.id = link+&#x22;_&#x22;+self[joins[key].leftKey];
                }
                else {
                  newLink.id = self[joins[key].leftKey]+&#x22;_&#x22;+link;
                }
              }
            }

            (function(key, link) {
              promisesLink.push(new Promise(function(resolve, reject) {
                r.table(self._getModel()._joins[key].link).insert(newLink, {conflict: &#x22;replace&#x22;, returnChanges: &#x27;always&#x27;}).run().
then(function(result) {
                  if (Array.isArray(result.changes) &#x26;&#x26; result.changes.length &#x3e; 0) {
                    self.__proto__._links[joins[key].link][result.changes[0].new_val[joins[key].model.getTableName()+&#x22;_&#x22;+joins[key
].rightKey]] = true;
                  }
                  else {
                    self.__proto__._links[joins[key].link][newLink[joins[key].model.getTableName()+&#x22;_&#x22;+joins[key].rightKey]] = true
;
                  }
                  resolve();
                }).error(reject);
              }))
            })(key, link);
          }
        });

        var keysToDelete = []
        util.loopKeys(oldKeys, function(oldKeys, link) {
          if (newKeys[link] === undefined) {
            if (constructor.getTableName() &#x3c; joins[key].model.getTableName()) {
              keysToDelete.push(self[joins[key].leftKey]+&#x22;_&#x22;+link);
            }
            else {
              keysToDelete.push(link+&#x22;_&#x22;+self[joins[key].leftKey]);
            }
          }
        });
        if (keysToDelete.length &#x3e; 0) {
          var table = r.table(joins[key].link);
          promisesLink.push(table.getAll.apply(table, keysToDelete).delete().run().then(function() {
            for(var i=0; i&#x3c;keysToDelete.length; i++) ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }
      }
    }
  });

  if (promisesMany.length &#x3e; 0) {
    Promise.all(promisesMany).then(function() {
      self.<span class="apidocCodeKeywordSpan">_saveLinks</span>(docToSave, saveAll, resolve, reject)
    }).error(reject);
  }
  else {
    self._saveLinks(docToSave, saveAll, resolve, reject)
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._saveMany" id="apidoc.element.thinky.document.prototype._saveMany">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveMany
        <span class="apidocSignatureSpan">(docToSave, saveAll, savedModel, resolve, reject)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_saveMany = function (docToSave, saveAll, savedModel, resolve, reject) {
  var self = this;
  var model = self._getModel();

  var promisesMany = [];
  util.loopKeys(model._joins, function(joins, key) {
    if (((key in docToSave) || (saveAll === true)) &#x26;&#x26;
        (joins[key].type === &#x27;hasOne&#x27;) &#x26;&#x26; ((saveAll === false) || (savedModel[joins[key].model.getTableName()] !== true))) {
      savedModel[joins[key].model.getTableName()] = true;

      if (self[key] != null) {
        self[key][joins[key].rightKey] = self[joins[key].leftKey];
        (function(_key) {
          promisesMany.push(new Promise(function(resolve, reject) {
            self[_key]._save(docToSave[_key], saveAll, savedModel).then(function() {
              self.__proto__._hasOne[_key] = {
                doc: self[_key],
                foreignKey: self._getModel()._joins[_key].rightKey
              };
              if (self[_key].__proto__._parents._hasOne[self._getModel()._name] == null) {
                self[_key].__proto__._parents._hasOne[self._getModel()._name] = [];
              }
              self[_key].__proto__._parents._hasOne[self._getModel()._name].push({
                doc: self,
                key: key
              });
              resolve();
            }).error(reject);
          }))
        })(key)
      }
      else if ((self[key] == null) &#x26;&#x26; (self.__proto__._hasOne[key] != null)) {
        var doc = self.__proto__._hasOne[key].doc;
        delete doc[self.__proto__._hasOne[key].foreignKey];
        promisesMany.push(doc._save(docToSave[key], saveAll, savedModel))
        self.__proto__._hasOne[key] = null;
      }
    }
  });
  util.loopKeys(model._joins, function(joins, key) {
    if (((key in docToSave) || (saveAll === true)) &#x26;&#x26;
        (joins[key].type === &#x27;hasMany&#x27;) &#x26;&#x26; ((saveAll === false) || (savedModel[joins[key].model.getTableName()] !== true))
        &#x26;&#x26; (Array.isArray(self[key]))) {

      savedModel[joins[key].model.getTableName()] = true;

      //Go through _hasMany and find element that were removed
      var pkMap = {};
      if (Array.isArray(self[key])) {
        for(var i=0; i&#x3c;self[key].length; i++) {
          if (self[key][i][joins[key].model._pk] != null) {
            pkMap[self[key][i][joins[key].model._pk]] = true;
          }
        }
      }

      if (self.__proto__._hasMany[key] != null) {
        for(var i=0; i&#x3c;self.__proto__._hasMany[key].length; i++) {
          if (pkMap[self.__proto__._hasMany[key][i].doc[[joins[key].model._pk]]] == null) {
            delete self.__proto__._hasMany[key][i].doc[self.__proto__._hasMany[key][i].foreignKey];
            promisesMany.push(self.__proto__._hasMany[key][i].doc._save(docToSave[key], saveAll, savedModel));
          }
        }
      }
      self.__proto__._hasMany[key] = [];

      for(var i=0; i&#x3c;self[key].length; i++) {
        self[key][i][joins[key].rightKey] = self[joins[key].leftKey];
        (function(key, i) {
          promisesMany.push(new Promise(function(resolve, reject) {
            if (!(self[key][i] instanceof Document)) {
              self[key][i] = new joins[key].model(self[key][i]);
            }

            var callback = function() {
              self[key][i]._save(docToSave[key], saveAll, savedModel).then(function(doc) {
                if (!Array.isArray(self.__proto__._hasMany[key])) {
                  self.__proto__._hasMany[key] = [];
                }
                self.__proto__._hasMany[key].push({
                  doc: doc,
                  foreignKey: self._getModel()._joins[key].rightKey
                });

                if (self[key][i].__proto__._parents._hasMany[self._getModel()._name] == null) {
                  self[key][i].__proto__._parents._hasMany[self._getModel()._name] = [];
                }
                self[key][i].__proto__._parents._hasMany[self._getModel()._name].push({
                  doc: self,
                  key: key
                });

                resolve();
              }).error(reject);
            }

            if (self[key][i] instanceof Promise) {
              self[key][i].then(cal ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    self.setSaved();
    self.emit(&#x27;saved&#x27;, self);

    var promise = self.validate();
    if (promise instanceof Promise) {
      promise.then(function() {
        self.<span class="apidocCodeKeywordSpan">_saveMany</span>(docToSave, saveAll, savedModel, resolve, reject)
      }).error(reject);
    }
    else {
      self._saveMany(docToSave, saveAll, savedModel, resolve, reject)
    }
  }, reject);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._saveSelf" id="apidoc.element.thinky.document.prototype._saveSelf">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveSelf
        <span class="apidocSignatureSpan">( copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_saveSelf = function ( copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject) {
  var self = this;
  var model = self._getModel();
  var constructor = self.__proto__.constructor;
  var r = this._getModel()._thinky.r;

  // BelongsTo documents were saved before. We just need to copy the foreign
  // keys.
  util.loopKeys(model._joins, function(joins, key) {
    if ((joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; (belongsToKeysSaved[key] === true)) {
      if (self[key] != null) {
        self[joins[key].leftKey] = self[key][joins[key].rightKey]
      }
      else if (self.__proto__._belongsTo[key]) {
        delete self[joins[key].leftKey];
        delete copy[joins[key].leftKey];
      }
    }
  });

  var querySaveSelf; // The query to save the document on which `save`/`saveAll` was called.
  // We haven&#x27;t validated the document yet, so building the query with `copy`
  // may throw an error (for example if a Date has not a valid time).
  var buildQuery = function () {
    if (self.__proto__._saved === false) {
      return querySaveSelf = r.table(constructor.getTableName())
        .insert(copy, {returnChanges: &#x27;always&#x27;})
    }
    else {
      if (copy[model._pk] === undefined) {
        throw new Error(&#x22;The document was previously saved, but its primary key is undefined.&#x22;);
      }
      return querySaveSelf = r.table(constructor.getTableName())
        .get(copy[model._pk]).replace(copy, {returnChanges: &#x27;always&#x27;})
    }
  }

  self.getModel().ready().then(function() {
    util.tryCatch(function() {
      // Validate the document before saving it
      var promise = self.validate();
      if (promise instanceof Promise) {
        promise.then(function() {
          querySaveSelf = buildQuery();
          querySaveSelf.run().then(function(result) {
            self._onSaved(result, docToSave, saveAll, savedModel, resolve, reject)
          }).error(reject)
        }).error(reject);
      }
      else {
        querySaveSelf = buildQuery();
        querySaveSelf.run().then(function(result) {
          self._onSaved(result, docToSave, saveAll, savedModel, resolve, reject)
        }).error(reject)
      }
    }, reject);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     self[key].__proto__._parents._belongsTo[constructor.getTableName()].push({
       doc: self,
       foreignKey: joins[key].leftKey,
       key: key // foreignDoc
     });
   }
 });
 self.<span class="apidocCodeKeywordSpan">_saveSelf</span>(copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject
)
}


/**
* Save the document on which `save` was called.
* @param {!Object} copy The savable copy of the original documents.
* @param {Object=} docToSave Documents to save represented by an object field-&#x3e;true
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._saveVirtual" id="apidoc.element.thinky.document.prototype._saveVirtual">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_saveVirtual
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_saveVirtual = function () {
  var copy = {};
  var model = this._getModel(); // instance of Model

  // TODO We could do better and copy less things, but things get a bit tricky
  // when virtual fields are nested in arrays.
  // This implementation still allows no overhead if no virtual fields exist,
  // which should be the most common case
  for(var i=0; i&#x3c;this._getModel().virtualFields.length; i++) {
    var key = this._getModel().virtualFields[i].path[0];
    copy[key] = this[key];
  }
  this.__proto__.virtualValue = util.deepCopy(copy);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// - Save hasOne, hasMany and hasAndBelongsToMany docs
// - Save links

// We&#x27;ll use it to know which `belongsTo` docs were saved
var belongsToKeysSaved = {};

var copy = self._makeSavableCopy();
self.<span class="apidocCodeKeywordSpan">_saveVirtual</span>();

// Save the joined documents via belongsTo first
var promises = [];
util.loopKeys(model._joins, function(joins, key) {
  if ((docToSave.hasOwnProperty(key) || (saveAll === true)) &#x26;&#x26;
      (joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; ((saveAll === false) || (savedModel[joins[key].model.getTableName
()] !== true))) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._setFeed" id="apidoc.element.thinky.document.prototype._setFeed">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_setFeed
        <span class="apidocSignatureSpan">(feed)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_setFeed = function (feed) {
  var self = this;

  self.__proto__._feed = feed;
  self.__proto__._active = true;
  feed.each(function(err, change) {
    if (err) {
      self.__proto__._active = false;
      self.emit(&#x27;error&#x27;, err);
    }
    else {
      if (change.new_val === null) {
        // Delete all the fields
        self._merge({});
        self._setOldValue(change.old_val);
        self._setUnSaved();
        self.emit(&#x27;change&#x27;, self);
      }
      else {
        self._merge(change.new_val);
        self._setOldValue(change.old_val);
        self.setSaved();
        self.emit(&#x27;change&#x27;, self);
      }
    }

  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return feed;
  }

  if (resultType === &#x27;AtomFeed&#x27;) {
    return result.next().then(function(initial) {
      var value = initial.new_val || {};
      return self._model._parse(value).then(function(doc) {
        doc.<span class="apidocCodeKeywordSpan">_setFeed</span>(result);
        return doc;
      });
    });
  }
}

if (parse === true) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._setOldValue" id="apidoc.element.thinky.document.prototype._setOldValue">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_setOldValue
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_setOldValue = function (value) {
  return this.__proto__.oldValue = value;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (result.first_error != null) {
return reject(Errors.create(result.first_error));
  }

  util.tryCatch(function() { // Validate the doc, replace it, and tag it as saved
if (Array.isArray(result.changes) &#x26;&#x26; result.changes.length &#x3e; 0) {
  self._merge(result.changes[0].new_val);
  self.<span class="apidocCodeKeywordSpan">_setOldValue</span>(util.deepCopy(result.changes[0].old_val));
}

if (self._getModel().needToGenerateFields === true) {
  self._generateDefault();
}
self.setSaved();
self.emit(&#x27;saved&#x27;, self);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._setUnSaved" id="apidoc.element.thinky.document.prototype._setUnSaved">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_setUnSaved
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_setUnSaved = function () {
  this.__proto__._saved = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  });
}

if (deleteSelf !== false) {
  if (self.isSaved() === true) {
    promises.push(new Promise(function(resolve, reject) {
      r.table(model._name).get(self[model._pk]).delete().run().then(function(result) {
        self.<span class="apidocCodeKeywordSpan">_setUnSaved</span>();
        self.emit(&#x27;deleted&#x27;, self);
        resolve(self);
      }).error(reject);
    }))
  }
  // else we don&#x27;t throw an error, should we?
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._validateHook" id="apidoc.element.thinky.document.prototype._validateHook">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_validateHook
        <span class="apidocSignatureSpan">(options, modelToValidate, validateAll, validatedModel, prefix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_validateHook = function (options, modelToValidate, validateAll, validatedModel, prefix) {
  var self = this;
  var promises = [];
  var error;

  var schemaOptions = self._getSchemaOptions();
  if (util.isPlainObject(schemaOptions)) {
    schemaOptions = util.mergeOptions(schemaOptions, options);
  }
  else {
    schemaOptions = options;
  }


  if (typeof self._getModel()._validator === &#x27;function&#x27;) {
    if (self._getModel()._validator.call(self, self) === false) {
      throw new Errors.ValidationError(&#x22;Document&#x27;s validator returned `false`.&#x22;);
    }
  }

  // Validate this document
  self._getModel()._schema.validate(self, prefix, schemaOptions)

  if (util.isPlainObject(modelToValidate) === false) {
    modelToValidate = {};
  }

  var constructor = self.__proto__.constructor;
  validatedModel[constructor.getTableName()] = true;

  // Validate joined documents
  util.loopKeys(self._getModel()._joins, function(joins, key) {
    if (util.recurse(key, joins, modelToValidate, validateAll, validatedModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          if (util.isPlainObject(self[key])) {
            if (self[key] instanceof Document === false) {
              self[key] = new self._getModel()._joins[key].model(self[key]);
            }
            // We do not propagate the options of this document, but only those given to validate
            var promise = self[key].validate(options, modelToValidate[key], validateAll, validatedModel, prefix+&#x27;[&#x27;+key+&#x27;]&#x27;);
            if (promise instanceof Promise) {
              promises.push(promise);
              promise = null;
            }
          }
          else if (self[key] != null) {
            throw new Errors.ValidationError(&#x22;Joined field &#x22;+prefix+&#x22;[&#x22;+key+&#x22;] should be `undefined`, `null` or an `Object`&#x22;)
          }
          break;

        case &#x27;hasMany&#x27;:
        case &#x27;hasAndBelongsToMany&#x27;:
          if (Array.isArray(self[key])) {
            for(var i=0; i&#x3c;self[key].length; i++) {
              if (util.isPlainObject(self[key][i])) {
                if (self[key][i] instanceof Document === false) {
                  self[key][i] = new self._getModel()._joins[key].model(self[key][i]);
                }
                promise = self[key][i].validate(options, modelToValidate[key], validateAll, validatedModel, prefix+&#x27;[&#x27;+key+&#x27;][&#x27;+
i+&#x27;]&#x27;);
                if (promise instanceof Promise) {
                  promises.push(promise);
                  promise = null;
                }
              }
              else {
                throw new Errors.ValidationError(&#x22;Joined field &#x22;+prefix+&#x22;[&#x22;+key+&#x22;][&#x22;+i+&#x22;] should be `undefined`, `null` or an `Array
`&#x22;)
              }
            }
          }
          else if (self[key] != null) {
            throw new Errors.ValidationError(&#x22;Joined field &#x22;+prefix+&#x22;[&#x22;+key+&#x22;] should be `undefined`, `null` or an `Array`&#x22;)
          }
          break;
      }
    }
  });
  if (promises.length &#x3e; 0) {
    return Promise.all(promises);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype._validateIsAsync" id="apidoc.element.thinky.document.prototype._validateIsAsync">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>_validateIsAsync
        <span class="apidocSignatureSpan">(modelToValidate, validateAll, validatedModel)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_validateIsAsync = function (modelToValidate, validateAll, validatedModel) {
  var self = this;

  if (self._getModel()._async.validate) {
    return true;
  }
  var async = false;
  util.loopKeys(self._getModel()._joins, function(joins, key) {
    if (util.recurse(key, joins, modelToValidate, validateAll, validatedModel)) {
      if (((joins[key].type === &#x27;hasOne&#x27;) || (joins[key].type === &#x27;belongsTo&#x27;))) {
        if (util.isPlainObject(self[key])) {
          if (self[key] instanceof Document === false) {
            self[key] = new self._getModel()._joins[key].model(self[key]);
          }
          // We do not propagate the options of this document, but only those given to validate
          if (self[key]._getModel()._async.validate || self[key]._validateIsAsync(modelToValidate, validateAll, validatedModel)) {
            async = true;
            return false;
          }
        }
      }
      else  if (((joins[key].type === &#x27;hasMany&#x27;) || (joins[key].type === &#x27;hasAndBelongsToMany&#x27;))) {
        if (Array.isArray(self[key])) {
          for(var i=0; i&#x3c;self[key].length; i++) {
            if (util.isPlainObject(self[key][i])) {
              if (self[key][i] instanceof Document === false) {
                self[key][i] = new self._getModel()._joins[key].model(self[key][i]);
              }
              if (self[key][i]._getModel()._async.validate || self[key][i]._validateIsAsync(modelToValidate, validateAll, validatedModel
)) {
                async = true;
                return false;
              }
            }
          }
        }
      }
    }
    return false;
  });
  return async;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
validatedModel = validatedModel || {};
prefix = prefix || &#x27;&#x27;;

var self = this;
var validatedModelCopy = util.deepCopy(validatedModel);

//TODO: Can we not always call this?
var async = self.<span class="apidocCodeKeywordSpan">_validateIsAsync</span>(modelToValidate, validateAll, validatedModelCopy);

return util.hook({
  preHooks: self._getModel()._pre.validate,
  postHooks: self._getModel()._post.validate,
  doc: self,
  async: async,
  fn: self._validateHook,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.addRelation" id="apidoc.element.thinky.document.prototype.addRelation">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>addRelation
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addRelation = function () {
  var self = this;
  var pk = self._getModel()._pk;

  var query = self.getModel().get(this[pk])
  return query.addRelation.apply(query, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Add a relation
* @param {string} field The field of the joined document(s)
* @param {Object} joinedDocument An object with the primary key defined or the related key
* @return {Promise}
*
* hasOne, primary key required
* User.get(1).<span class="apidocCodeKeywordSpan">addRelation</span>(&#x22;account&#x22;, {id: 2, sold: 2132})
* The promise resolved the document on which addRelation is called
*
* hasMany, primary key required
* User.get(1).addRelation(&#x22;accounts&#x22;, {id: 2, sold: 2132})
* The promise resolved the updated joined document
*
* belongsTo, right joined key OR primary key required
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.closeFeed" id="apidoc.element.thinky.document.prototype.closeFeed">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>closeFeed
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">closeFeed = function () {
  return this.__proto__._feed.close();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.delete" id="apidoc.element.thinky.document.prototype.delete">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>delete
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function (callback) {
  return this._delete({}, false, [], true, true, callback)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._belongsTo = {};
this._hasOne = {};
this._hasMany = {};
// Example: { &#x3c;linkTableName&#x3e;: { &#x3c;valueOfRightKey&#x3e;: true, ... }, ... }
this._links = {}

// Keep reference of any doc having a link pointing to this
// So we can clean when users do doc.belongsToDoc.<span class="apidocCodeKeywordSpan">delete</span>()
this._parents = {
  _hasOne: {},      // &#x3c;tableName&#x3e;: [{doc, key}]
  _hasMany: {},     // &#x3c;tableName&#x3e;: [{doc, key}]
  _belongsTo: {},   // &#x3c;tableName&#x3e;: [{doc, key, foreignKey}]
  _belongsLinks: {} // &#x3c;tableName&#x3e;: [{doc, key}]
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.deleteAll" id="apidoc.element.thinky.document.prototype.deleteAll">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>deleteAll
        <span class="apidocSignatureSpan">(docToDelete, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deleteAll = function (docToDelete, callback) {
  var deleteAll;
  if (typeof docToDelete === &#x27;function&#x27;) {
    callback = docToDelete;
    deleteAll = true;
    docToDelete = {};
  }
  else {
    deleteAll = docToDelete === undefined;
    docToDelete = docToDelete || {};
  }
  return this._delete(docToDelete, deleteAll, [], true, true, callback)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.generateVirtualValues" id="apidoc.element.thinky.document.prototype.generateVirtualValues">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>generateVirtualValues
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">generateVirtualValues = function () {
  for(var i=0; i&#x3c;this._getModel().virtualFields.length; i++) {
    schemaUtil.generateVirtual(this, this._getModel().virtualFields[i], this, this._getVirtual());
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* the virtual fields.
*/
Document.prototype._generateDefault = function() {
 for(var i=0; i&#x3c;this._getModel().defaultFields.length; i++) {
   schemaUtil.generateDefault(this, this._getModel().defaultFields[i], this);
 }
 if (this._getModel().virtualFields.length &#x3e; 0) {
   this.<span class="apidocCodeKeywordSpan">generateVirtualValues</span>();
 }
}


/*
* Validate this document against the schema of its model and triggers all the hooks.
* @param {Object=} options Options to overwrite the ones of the document.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.getFeed" id="apidoc.element.thinky.document.prototype.getFeed">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>getFeed
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getFeed = function () {
  return this.__proto__._feed;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.getModel" id="apidoc.element.thinky.document.prototype.getModel">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>getModel
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getModel = function () {
  return this.__proto__.constructor;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Function} executeInsert the method that will execute the batch insert
 * @return {Promise}
 */
Document.prototype._batchSaveSelf = function(executeInsert) {
  var self = this;

  return new Promise(function(resolve, reject) {
    self.<span class="apidocCodeKeywordSpan">getModel</span>().ready().then(function() {
      executeInsert(resolve, reject)
    });
  })
}


/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.getOldValue" id="apidoc.element.thinky.document.prototype.getOldValue">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>getOldValue
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getOldValue = function () {
  return this.__proto__.oldValue;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.isSaved" id="apidoc.element.thinky.document.prototype.isSaved">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>isSaved
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isSaved = function () {
  return this.__proto__._saved;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (((key in docToSave) || (saveAll === true)) &#x26;&#x26;
  (joins[key].type === &#x27;hasAndBelongsToMany&#x27;)) {

if (Array.isArray(self[key])) {
  var newKeys = {}
  for(var i=0; i&#x3c;self[key].length; i++) {
    if (util.isPlainObject(self[key][i])) {
      if (self[key][i].<span class="apidocCodeKeywordSpan">isSaved</span>() === true) {
        newKeys[self[key][i][joins[key].rightKey]] = true;
      }
    }
    else { // self[key][i] is just the key
      newKeys[self[key][i]] = true;
    }
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.merge" id="apidoc.element.thinky.document.prototype.merge">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>merge
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merge = function (obj) {
  var self = this;
  util.loopKeys(obj, function(obj, key) {
    // Recursively merge only if both fields are objects, else we&#x27;ll overwrite the field
    if (util.isPlainObject(obj[key]) &#x26;&#x26; util.isPlainObject(self[key])) {
      Document.prototype.merge.call(self[key], obj[key])
    }
    else {
      self[key] = obj[key];
    }
  });
  return self;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  gotModel[model.getTableName()] = true;

  util.loopKeys(joins, function(joins, key) {
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.<span class="apidocCodeKeywordSpan">merge</span>(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#
x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.purge" id="apidoc.element.thinky.document.prototype.purge">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>purge
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">purge = function (callback) {
  var self = this;

  var model = self._getModel(); // instance of Model
  var r = model._thinky.r;

  // Clean parent for hasOne
  // doc.otherDoc.delete()
  util.loopKeys(self.__proto__._parents._hasOne, function(hasOne, key) {
    for(var i=0; i&#x3c;hasOne[key].length; i++) {
      var parentDoc = hasOne[key][i].doc; // A doc that belongs to otherDoc (aka this)
      delete parentDoc[hasOne[key][i].key] // Delete reference to otherDoc (aka this)
    }
  });

  // Clean parent for belongsTo
  // doc.otherDoc.delete()
  util.loopKeys(self.__proto__._parents._belongsTo, function(belongsTo, key) {
    for(var i=0; i&#x3c;belongsTo[key].length; i++) {
      var parentDoc = belongsTo[key][i].doc;
      delete parentDoc[belongsTo[key][i].key];
      delete parentDoc[belongsTo[key][i].foreignKey];
    }
  });

  // Clean parent for hasMany
  util.loopKeys(self.__proto__._parents._hasMany, function(hasMany, key) {
    for(var i=0; i&#x3c;hasMany[key].length; i++) {
      var parentDoc = hasMany[key][i].doc;
      var field = hasMany[key][i].key;
      for(var j=0; j&#x3c;parentDoc[field].length; j++) {
        if (parentDoc[field][j] === this) {
          parentDoc[field].splice(j, 1);
          break;
        }
      }
    }
  });


  // Clean parent for hasAndBelongsToMany
  util.loopKeys(self.__proto__._parents._belongsLinks, function(belongsLinks, key) {
    for(var i=0; i&#x3c;belongsLinks[key].length; i++) {
      var parentDoc = belongsLinks[key][i].doc;
      var field = belongsLinks[key][i].key;
      for(var j=0; j&#x3c;parentDoc[field].length; j++) {
        if (parentDoc[field][j] === this) {
          parentDoc[field].splice(j, 1);
          break;
        }
      }
    }
  });

  // Purge the database
  var promises = [];
  util.loopKeys(self._getModel()._joins, function(joins, field) {
    var join = joins[field];
    var joinedModel = join.model;

    if ((join.type === &#x27;hasOne&#x27;) || (join.type === &#x27;hasMany&#x27;)) {
      promises.push(r.table(joinedModel.getTableName()).getAll(self[join.leftKey], {index: join.rightKey}).replace(function(doc) {
        return doc.without(join.rightKey)
      }).run())
    }
    // nothing to do for &#x22;belongsTo&#x22;
    else if (join.type === &#x27;hasAndBelongsToMany&#x27;) {
      if (self.getModel()._getModel()._pk === join.leftKey) {
        // [1]
        promises.push(r.table(join.link).getAll(self[join.leftKey], {index: self.getModel().getTableName()+&#x22;_&#x22;+join.leftKey}).delete
().run())
      }
    }
  });

  util.loopKeys(self._getModel()._reverseJoins, function(reverseJoins, field) {
    var join = reverseJoins[field];
    var joinedModel = join.model; // model where belongsTo/hasAndBelongsToMany was called

    if (join.type === &#x27;belongsTo&#x27;) {
      // What was called is joinedModel.belongsTo(self, fieldDoc, leftKey, rightKey)
      promises.push(r.table(joinedModel.getTableName()).getAll(self[join.rightKey], {index: join.leftKey}).replace(function(doc) {
        return doc.without(join.leftKey)
      }).run())
    }
    // nothing to do for &#x22;belongsTo&#x22;
    else if (join.type === &#x27;hasAndBelongsToMany&#x27;) {
      // Purge only if the key is a primary key
      // What was called is joinedModel.hasAndBelongsToMany(self, fieldDoc, leftKey, rightKey)
      if (self.getModel()._getModel()._pk === join.leftKey) {
        promises.push(r.table(join.link).getAll(self[join.rightKey], {index: self.getModel().getTableName()+&#x22;_&#x22;+join.rightKey}).
delete().run())
      }
    }
  });

  // Delete itself
  promises.push(self.delete())

  return new Promise(function(resolve, reject) {
    Promise.all(promises).then(function() {
      resolve(self);
    }).error(reject);
  }).nodeify(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.removeRelation" id="apidoc.element.thinky.document.prototype.removeRelation">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>removeRelation
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeRelation = function () {
  var self = this;
  var pk = self._getModel()._pk;

  var query = self.getModel().get(this[pk])
  return query.removeRelation.apply(query, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.save" id="apidoc.element.thinky.document.prototype.save">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>save
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function (callback) {
  return this._save({}, false, {}, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }).error(reject);
      }))
    })(key);
  }
  else if ((deleteSelf === true) &#x26;&#x26; (deletedDocs.indexOf(self[key]) === -1)) {
    delete self[key][joins[key].rightKey];
    if (self[key].isSaved() === true) {
      promises.push(self[key].<span class="apidocCodeKeywordSpan">save</span>({}, false, {}, true, false));
    }
  }
}
if ((joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; (self[key] instanceof Document)) {
  if ((self[key].isSaved() === true) &#x26;&#x26;
    ((key in docToDelete) || ((deleteAll === true) &#x26;&#x26; (deletedDocs.indexOf(self[key]) === -1)))) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.saveAll" id="apidoc.element.thinky.document.prototype.saveAll">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>saveAll
        <span class="apidocSignatureSpan">(docToSave, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">saveAll = function (docToSave, callback) {
  var saveAll;
  if (typeof docToSave === &#x27;function&#x27;) {
    callback = docToSave;
    saveAll = true;
    docToSave = {};
  }
  else {
    saveAll = docToSave === undefined;
    docToSave = docToSave || {};
  }

  return this._save(docToSave, saveAll,{}, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
email: &#x22;orphee@gmail.com&#x22;
});

// Join the documents
post.author = author;


post.<span class="apidocCodeKeywordSpan">saveAll</span>().then(function(result) {
/*
post = result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.setSaved" id="apidoc.element.thinky.document.prototype.setSaved">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>setSaved
        <span class="apidocSignatureSpan">(all)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setSaved = function (all) {
  var self = this;
  self.__proto__._saved = true;
  if (all !== true) return;
    util.loopKeys(self._getModel()._joins, function(joins, key) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
          if (self[key] instanceof Document) {
            self[key].setSaved(true);
          }
          break;

        case &#x27;belongsTo&#x27;:
          if (self[key] instanceof Document) {
            self[key].setSaved(true);
          }
          break;

        case &#x27;hasMany&#x27;:
          if (Array.isArray(self[key])) {
            for(var i=0; i&#x3c;self[key].length; i++) {
              if (self[key][i] instanceof Document) {
                self[key][i].setSaved(true);
              }
            }
          }
          break;

        case &#x27;hasAndBelongsToMany&#x27;:
          if (Array.isArray(self[key])) {
            for(var i=0; i&#x3c;self[key].length; i++) {
              if (self[key][i] instanceof Document) {
                self[key][i].setSaved(true);
              }
            }
          }
          break;
      }
    });

    // Make joins, we should keep references only of the saved documents
    util.loopKeys(self._getModel()._joins, function(joins, key) {
      if (self[key] == null) return;
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
          if (self[key].isSaved()) {
            self.__proto__._hasOne[key] = {
              doc: self[key],
              foreignKey: self._getModel()._joins[key].rightKey
            }
          }

          if (self[key].__proto__._parents._hasOne[self._getModel()._name] == null) {
            self[key].__proto__._parents._hasOne[self._getModel()._name] = [];
          }
          self[key].__proto__._parents._hasOne[self._getModel()._name].push({
            doc: self,
            key: key
          });
          break;

        case &#x27;belongsTo&#x27;:
          if (self[key].__proto__._parents._belongsTo[self._getModel()._name] == null) {
            self[key].__proto__._parents._belongsTo[self._getModel()._name] = [];
          }
          self[key].__proto__._parents._belongsTo[self._getModel()._name].push({
            doc: self,
            foreignKey: self._getModel()._joins[key].leftKey,
            key: key
          });
          self.__proto__._belongsTo[key] = true;
          break;

        case &#x27;hasMany&#x27;:
          self.__proto__._hasMany[key] = []

          for(var i=0; i&#x3c;self[key].length; i++) {
            if (self[key][i].isSaved()) {
              self.__proto__._hasMany[key].push({
                doc: self[key][i],
                foreignKey: self._getModel()._joins[key].rightKey
              })
            }

            if (self[key][i].__proto__._parents._hasMany[self._getModel()._name] == null) {
              self[key][i].__proto__._parents._hasMany[self._getModel()._name] = [];
            }
            self[key][i].__proto__._parents._hasMany[self._getModel()._name].push({
              doc: self,
              key: key
            });

          }
          break;

        case &#x27;hasAndBelongsToMany&#x27;:
          if (self.__proto__._links[self._getModel()._joins[key].link] === undefined) {
            self.__proto__._links[self._getModel()._joins[key].link] = {}
          }

          for(var i=0; i&#x3c;self[key].length; i++) {
            if (self[key][i].isSaved()) {
              self.__proto__._links[self._getModel()._joins[key].link][self[key][i][self._getModel()._joins[key].rightKey]] = true
;
            }

            if (self[key][i].__proto__._parents._belongsLinks[self._getModel()._name] == null) {
              self[key][i].__proto__._parents._belongsLinks[self._getModel()._name] = [];
            }
            self[key][i].__proto__._parents._belongsLinks[self._getModel()._name].push({
              doc: self,
              key: key
            });

          }
          break;
      }
    });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  self._merge(result.changes[0].new_val);
  self._setOldValue(util.deepCopy(result.changes[0].old_val));
}

if (self._getModel().needToGenerateFields === true) {
  self._generateDefault();
}
self.<span class="apidocCodeKeywordSpan">setSaved</span>();
self.emit(&#x27;saved&#x27;, self);

var promise = self.validate();
if (promise instanceof Promise) {
  promise.then(function() {
    self._saveMany(docToSave, saveAll, savedModel, resolve, reject)
  }).error(reject);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.validate" id="apidoc.element.thinky.document.prototype.validate">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>validate
        <span class="apidocSignatureSpan">(options, modelToValidate, validateAll, validatedModel, prefix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validate = function (options, modelToValidate, validateAll, validatedModel, prefix) {
  modelToValidate = modelToValidate || {};
  validateAll = validateAll || false;
  validatedModel = validatedModel || {};
  prefix = prefix || &#x27;&#x27;;

  var self = this;
  var validatedModelCopy = util.deepCopy(validatedModel);

  //TODO: Can we not always call this?
  var async = self._validateIsAsync(modelToValidate, validateAll, validatedModelCopy);

  return util.hook({
    preHooks: self._getModel()._pre.validate,
    postHooks: self._getModel()._post.validate,
    doc: self,
    async: async,
    fn: self._validateHook,
    fnArgs: [options, modelToValidate, validateAll, validatedModel, prefix]
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {Object=} modelToValidate Internal parameter, model to validate
* @return {Promise=} return a promise if the validation is asynchrone, else undefined.
*/
Document.prototype.validateAll = function(options, modelToValidate) {
 var validateAll = modelToValidate === undefined;
 modelToValidate = modelToValidate || {};

 return this.<span class="apidocCodeKeywordSpan">validate</span>(options, modelToValidate, validateAll, {}, &#x27;&#x27;, true);
}


/*
* Internal methods that will validate the document (but that will not execute the hooks).
* @param {Object=} options Options to overwrite the ones of the document.
* @param {Object=} modelToValidate Internal parameter, model to validate
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.document.prototype.validateAll" id="apidoc.element.thinky.document.prototype.validateAll">
        function <span class="apidocSignatureSpan">thinky.document.prototype.</span>validateAll
        <span class="apidocSignatureSpan">(options, modelToValidate)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">validateAll = function (options, modelToValidate) {
  var validateAll = modelToValidate === undefined;
  modelToValidate = modelToValidate || {};

  return this.validate(options, modelToValidate, validateAll, {}, &#x27;&#x27;, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.errors" id="apidoc.module.thinky.errors">module thinky.errors</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.errors.DocumentNotFound" id="apidoc.element.thinky.errors.DocumentNotFound">
        function <span class="apidocSignatureSpan">thinky.errors.</span>DocumentNotFound
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">DocumentNotFound = function (message) {
  var errorMessage = message || &#x22;The query did not find a document and returned null.&#x22;;
  errors.ThinkyError.call(this, errorMessage);
  this.name = &#x27;DocumentNotFoundError&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
 * Creates an appropriate error given either an instance of Error or a message
 * from the RethinkDB driver
 */
errors.create = function(errorOrMessage) {
var message = (errorOrMessage instanceof Error) ? errorOrMessage.message : errorOrMessage;
if (message.match(errors.DOCUMENT_NOT_FOUND_REGEX)) {
  return new errors.<span class="apidocCodeKeywordSpan">DocumentNotFound</span>(message);
} else if (message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)) {
  var primaryKey = message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)[1];
  return new errors.DuplicatePrimaryKey(message, primaryKey);
} else if (errorOrMessage instanceof Error) {
  return errorOrMessage;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.errors.DuplicatePrimaryKey" id="apidoc.element.thinky.errors.DuplicatePrimaryKey">
        function <span class="apidocSignatureSpan">thinky.errors.</span>DuplicatePrimaryKey
        <span class="apidocSignatureSpan">(message, primaryKey)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">DuplicatePrimaryKey = function (message, primaryKey) {
  errors.ThinkyError.call(this, message);
  this.name = &#x27;DuplicatePrimaryKeyError&#x27;;
  if (primaryKey !== undefined) {
    this.primaryKey = primaryKey;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 */
errors.create = function(errorOrMessage) {
  var message = (errorOrMessage instanceof Error) ? errorOrMessage.message : errorOrMessage;
  if (message.match(errors.DOCUMENT_NOT_FOUND_REGEX)) {
    return new errors.DocumentNotFound(message);
  } else if (message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)) {
    var primaryKey = message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)[1];
    return new errors.<span class="apidocCodeKeywordSpan">DuplicatePrimaryKey</span>(message, primaryKey);
  } else if (errorOrMessage instanceof Error) {
    return errorOrMessage;
  }

  return new errors.ThinkyError(errorOrMessage);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.errors.InvalidWrite" id="apidoc.element.thinky.errors.InvalidWrite">
        function <span class="apidocSignatureSpan">thinky.errors.</span>InvalidWrite
        <span class="apidocSignatureSpan">(message, raw)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">InvalidWrite = function (message, raw) {
  errors.ThinkyError.call(this, message);
  this.name = &#x27;InvalidWriteError&#x27;;
  this.raw = raw;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Query.prototype._validateUngroupResult = function(result) {
}

Query.prototype._validateQueryResult = function(result) {
var self = this;
if (result.errors &#x3e; 0) {
  console.log(result);
  return Promise.reject(new Errors.<span class="apidocCodeKeywordSpan">InvalidWrite</span>(&#x22;An error occured during the write
&#x22;, result));
}
if (!Array.isArray(result.changes)) {
  if (self._isPointWrite()) {
    return Promise.resolve();
  }
  return Promise.resolve([]);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.errors.ThinkyError" id="apidoc.element.thinky.errors.ThinkyError">
        function <span class="apidocSignatureSpan">thinky.errors.</span>ThinkyError
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ThinkyError = function () {
  var tmp = Error.apply(this, arguments);
  tmp.name = this.name = &#x27;ThinkyError&#x27;;

  this.message = tmp.message;
  if (Error.captureStackTrace)
    Error.captureStackTrace(this, this.constructor);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  } else if (message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)) {
    var primaryKey = message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)[1];
    return new errors.DuplicatePrimaryKey(message, primaryKey);
  } else if (errorOrMessage instanceof Error) {
    return errorOrMessage;
  }

  return new errors.<span class="apidocCodeKeywordSpan">ThinkyError</span>(errorOrMessage);
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.errors.ValidationError" id="apidoc.element.thinky.errors.ValidationError">
        function <span class="apidocSignatureSpan">thinky.errors.</span>ValidationError
        <span class="apidocSignatureSpan">(message)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ValidationError = function (message) {
  errors.ThinkyError.call(this, message);
  this.name = &#x27;ValidationError&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
else {
  schemaOptions = options;
}


if (typeof self._getModel()._validator === &#x27;function&#x27;) {
  if (self._getModel()._validator.call(self, self) === false) {
    throw new Errors.<span class="apidocCodeKeywordSpan">ValidationError</span>(&#x22;Document&#x27;s validator returned `false`.&#
x22;);
  }
}

// Validate this document
self._getModel()._schema.validate(self, prefix, schemaOptions)

if (util.isPlainObject(modelToValidate) === false) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.errors.create" id="apidoc.element.thinky.errors.create">
        function <span class="apidocSignatureSpan">thinky.errors.</span>create
        <span class="apidocSignatureSpan">(errorOrMessage)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">create = function (errorOrMessage) {
  var message = (errorOrMessage instanceof Error) ? errorOrMessage.message : errorOrMessage;
  if (message.match(errors.DOCUMENT_NOT_FOUND_REGEX)) {
    return new errors.DocumentNotFound(message);
  } else if (message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)) {
    var primaryKey = message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)[1];
    return new errors.DuplicatePrimaryKey(message, primaryKey);
  } else if (errorOrMessage instanceof Error) {
    return errorOrMessage;
  }

  return new errors.ThinkyError(errorOrMessage);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Function} reject The function to call if an error happened
 */
Document.prototype._onSaved = function(result, docToSave, saveAll, savedModel, resolve, reject) {
// Keep in sync with Model.save
var self = this;

if (result.first_error != null) {
  return reject(Errors.<span class="apidocCodeKeywordSpan">create</span>(result.first_error));
}

util.tryCatch(function() { // Validate the doc, replace it, and tag it as saved
  if (Array.isArray(result.changes) &#x26;&#x26; result.changes.length &#x3e; 0) {
    self._merge(result.changes[0].new_val);
    self._setOldValue(util.deepCopy(result.changes[0].old_val));
  }
...</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.feed" id="apidoc.module.thinky.feed">module thinky.feed</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.feed.feed" id="apidoc.element.thinky.feed.feed">
        function <span class="apidocSignatureSpan">thinky.</span>feed
        <span class="apidocSignatureSpan">(feed, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Feed(feed, model) {
  this.feed = feed;
  this.model = model;
  this._closed = false;

  this.each = this._each;
  this.next = this._next;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.feed.prototype" id="apidoc.module.thinky.feed.prototype">module thinky.feed.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.feed.prototype._each" id="apidoc.element.thinky.feed.prototype._each">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_each
        <span class="apidocSignatureSpan">(callback, onFinish)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_each = function (callback, onFinish) {
  var self = this;
  self.feed.each(function(err, data) {
    if (err) {
      if (self._closed === true) {
        return;
      }
      return callback(err);
    }
    util.tryCatch(function() {
      if (data.new_val != null) {
        self.model._parse(data.new_val).then(function(doc) {
          doc._setOldValue(data.old_val);
          callback(null, doc);
        }).error(function(err) {
          callback(err);
        });
      }
      else if (data.old_val != null) { // new_val is null
        self.model._parse(data.old_val).then(function(doc) {
          doc._setUnSaved();
          callback(null, doc);
        }).error(function(err) {
          callback(err);
        });
      }
      //else we just drop the change as it&#x27;s a state/initializing object
    }, function(err) {
      callback(err);
    })
  }, onFinish);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
(function(n) {
  var method = methods[n];
  Feed.prototype[method] = function() {
    var self = this;
    if (self._eventEmitter == null) {
      self._makeEmitter();
      setImmediate(function() {
        self.feed.<span class="apidocCodeKeywordSpan">_each</span>(self._eachCb.bind(self), function() {
          self._eventEmitter.emit(&#x27;end&#x27;);
        });
      });
    }
    self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
  };
})(i);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype._eachCb" id="apidoc.element.thinky.feed.prototype._eachCb">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_eachCb
        <span class="apidocSignatureSpan">(err, data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_eachCb = function (err, data) {
  var self = this;
  if (err != null) {
    if ((this._closed !== false) || (err.message !== &#x22;You cannot retrieve data from a cursor that is closed&#x22;)) {
      self._eventEmitter.emit(&#x27;error&#x27;, err);
    }
    return;
  }

  util.tryCatch(function() {
    if (data.new_val !== null) {
      self.model._parse(data.new_val).then(function(doc) {
        doc._setOldValue(data.old_val);
        self._eventEmitter.emit(&#x27;data&#x27;, doc);
      }).error(function(err) {
        self._eventEmitter.emit(&#x27;error&#x27;, err);
      });
    }
    else if (data.old_val !== null) { // new_val is null
      self.model._parse(data.old_val).then(function(doc) {
        doc._setUnSaved();
        self._eventEmitter.emit(&#x27;data&#x27;, doc);
      }).error(function(err) {
        self._eventEmitter.emit(&#x27;error&#x27;, err);
      });
    }
  }, function(err) {
    self._eventEmitter.emit(&#x27;error&#x27;, err);
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype._makeEmitter" id="apidoc.element.thinky.feed.prototype._makeEmitter">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_makeEmitter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_makeEmitter = function () {
  this.next = function() {
    throw new Error(&#x22;You cannot called `next` once you have bound listeners on the feed&#x22;)
  }
  this.each = function() {
    throw new Error(&#x22;You cannot called `each` once you have bound listeners on the feed&#x22;)
  }
  this.toArray = function() {
    throw new Error(&#x22;You cannot called `toArray` once you have bound listeners on the feed&#x22;)
  }
  this._eventEmitter = new EventEmitter();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

for(var i=0; i&#x3c;methods.length; i++) {
(function(n) {
  var method = methods[n];
  Feed.prototype[method] = function() {
    var self = this;
    if (self._eventEmitter == null) {
      self.<span class="apidocCodeKeywordSpan">_makeEmitter</span>();
      setImmediate(function() {
        self.feed._each(self._eachCb.bind(self), function() {
          self._eventEmitter.emit(&#x27;end&#x27;);
        });
      });
    }
    self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype._next" id="apidoc.element.thinky.feed.prototype._next">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>_next
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_next = function () {
  var self = this;
  return new Promise(function(resolve, reject) {
    self.feed.next().then(function(data) {
      util.tryCatch(function() {
        if (data.new_val != null) {
          self.model._parse(data.new_val).then(function(doc) {
            doc._setOldValue(data.old_val);
            resolve(doc);
          }).error(reject);
        }
        else if (data.old_val != null) { // new_val is null
          self.model._parse(data.old_val).then(function(doc) {
            doc._setUnSaved();
            resolve(doc);
          }).error(reject);
        }
        //else we just drop the change as it&#x27;s a state/initializing object
      }, function(err) {
        reject(err);
      })
    }).error(reject);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.addListener" id="apidoc.element.thinky.feed.prototype.addListener">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>addListener
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addListener = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  _belongsLinks: {} // &#x3c;tableName&#x3e;: [{doc, key}]
}

// Bind listeners of the model to this documents.
util.loopKeys(model._listeners, function(listeners, eventKey) {
  for(var j=0; j&#x3c;listeners[eventKey].length; j++) {
    if (listeners[eventKey][j].once === false) {
      self.<span class="apidocCodeKeywordSpan">addListener</span>(eventKey, listeners[eventKey][j].listener);
    }
    else if (listeners[eventKey][j].once === true) {
      self.once(eventKey, listeners[eventKey][j].listener);
    }
  }
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.close" id="apidoc.element.thinky.feed.prototype.close">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>close
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function (callback) {
  this._closed = true;
  return this.feed.close(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
};

Document.prototype.getFeed = function() {
  return this.__proto__._feed;
}

Document.prototype.closeFeed = function() {
  return this.__proto__._feed.<span class="apidocCodeKeywordSpan">close</span>();
}

/**
 * Have the model emit &#x27;retrieved&#x27; with the current document and
 * recurse to have all joined models do the same.
 */
Document.prototype._emitRetrieve = function() {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.emit" id="apidoc.element.thinky.feed.prototype.emit">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>emit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">emit = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Object=} savedModel Models saved in this call
 * @param {Object=} callback to execute
 * @return {Promise=}
 */
Document.prototype._save = function(docToSave, saveAll, savedModel, callback) {
//TOIMPROVE? How should we handle circular references outsides of joined fields? Now we throw with a maximum call stack size exceed
var self = this;
self.<span class="apidocCodeKeywordSpan">emit</span>(&#x27;saving&#x27;, self);

return util.hook({
  preHooks: self._getModel()._pre.save,
  postHooks: self._getModel()._post.save,
  doc: self,
  async: true,
  fn: self._saveHook,
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.listeners" id="apidoc.element.thinky.feed.prototype.listeners">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>listeners
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">listeners = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.on" id="apidoc.element.thinky.feed.prototype.on">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>on
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">on = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.once" id="apidoc.element.thinky.feed.prototype.once">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>once
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">once = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Bind listeners of the model to this documents.
util.loopKeys(model._listeners, function(listeners, eventKey) {
  for(var j=0; j&#x3c;listeners[eventKey].length; j++) {
    if (listeners[eventKey][j].once === false) {
      self.addListener(eventKey, listeners[eventKey][j].listener);
    }
    else if (listeners[eventKey][j].once === true) {
      self.<span class="apidocCodeKeywordSpan">once</span>(eventKey, listeners[eventKey][j].listener);
    }
  }
});


// Atom feed
this._active = false;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.removeAllListeners" id="apidoc.element.thinky.feed.prototype.removeAllListeners">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>removeAllListeners
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeAllListeners = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.removeListener" id="apidoc.element.thinky.feed.prototype.removeListener">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>removeListener
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeListener = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.setMaxListeners" id="apidoc.element.thinky.feed.prototype.setMaxListeners">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>setMaxListeners
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setMaxListeners = function () {
  var self = this;
  if (self._eventEmitter == null) {
    self._makeEmitter();
    setImmediate(function() {
      self.feed._each(self._eachCb.bind(self), function() {
        self._eventEmitter.emit(&#x27;end&#x27;);
      });
    });
  }
  self._eventEmitter[method].apply(self._eventEmitter, util.toArray(arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.toArray" id="apidoc.element.thinky.feed.prototype.toArray">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>toArray
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toArray = function () {
  throw new Error(&#x22;The `toArray` method is not available on feeds.&#x22;);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        self._makeEmitter();
        setImmediate(function() {
          self.feed._each(self._eachCb.bind(self), function() {
            self._eventEmitter.emit(&#x27;end&#x27;);
          });
        });
      }
      self._eventEmitter[method].apply(self._eventEmitter, util.<span class="apidocCodeKeywordSpan">toArray</span>(arguments));
    };
  })(i);
}

module.exports = Feed;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.feed.prototype.toString" id="apidoc.element.thinky.feed.prototype.toString">
        function <span class="apidocSignatureSpan">thinky.feed.prototype.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
  return &#x27;[object Feed]&#x27;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * Convert the query to its string representation.
 * @return {string}
 */
Query.prototype.toString = function() {
  return this._query.<span class="apidocCodeKeywordSpan">toString</span>();
}

module.exports = Query;
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.model" id="apidoc.module.thinky.model">module thinky.model</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.model.model" id="apidoc.element.thinky.model.model">
        function <span class="apidocSignatureSpan">thinky.</span>model
        <span class="apidocSignatureSpan">(name, schema, options, thinky)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Model(name, schema, options, thinky) {
<span class="apidocCodeCommentSpan">  /**
   * Name of the table used
   * @type {string}
   */
</span>  this._name = name;

  // We want a deep copy
  options = options || {};
  this._options = {};
  this._options.enforce_missing = (options.enforce_missing != null) ? options.enforce_missing : thinky._options.enforce_missing;
  this._options.enforce_extra = (options.enforce_extra != null) ? options.enforce_extra : thinky._options.enforce_extra;
  this._options.enforce_type = (options.enforce_type != null) ? options.enforce_type : thinky._options.enforce_type;
  this._options.timeFormat = (options.timeFormat != null) ? options.timeFormat : thinky._options.timeFormat;
  this._options.validate = (options.validate != null) ? options.validate : thinky._options.validate;

  this._schema = schemaUtil.parse(schema, &#x27;&#x27;, this._options, this);
  //console.log(JSON.stringify(this._schema, null, 2));

  this.virtualFields = [];
  this.defaultFields = [];
  this._schema._getDefaultFields([], this.defaultFields, this.virtualFields)

  this.needToGenerateFields = (this.defaultFields.length+this.virtualFields.length) !== 0;

  this._pk = (options.pk != null) ? options.pk : &#x27;id&#x27;;

  this._table = (options.table != null) ? options.table : {};
  this._table.primaryKey = this._pk;

  this._thinky = thinky;

  this._validator = options.validator;

  this._indexes = {}; // indexName -&#x3e; true
  this._pendingPromises = [];

  this._error = null; // If an error occured, we won&#x27;t let people save things

  this._listeners = {};
  this._maxListeners = 10;
  this._joins = {};
  this._localKeys = {}; // key used as a foreign key by another model

  // This is to track joins that were not directly called by this model but that we still need
  // to purge the database
  this._reverseJoins = {};

  this._methods = {};
  this._staticMethods = {};
  this._async = {
    init: false,
    retrieve: false,
    save: false,
    validate: false
  };

  this._pre = {
    save: [],
    delete: [],
    validate: []
  };
  this._post = {
    init: [],
    retrieve: [],
    save: [],
    delete: [],
    validate: []
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  util.loopKeys(self._getModel()._joins, function(joins, key) {
if (util.recurse(key, joins, modelToValidate, validateAll, validatedModel)) {
  switch (joins[key].type) {
    case &#x27;hasOne&#x27;:
    case &#x27;belongsTo&#x27;:
      if (util.isPlainObject(self[key])) {
        if (self[key] instanceof Document === false) {
          self[key] = new self._getModel()._joins[key].<span class="apidocCodeKeywordSpan">model</span>(self[key]);
        }
        // We do not propagate the options of this document, but only those given to validate
        var promise = self[key].validate(options, modelToValidate[key], validateAll, validatedModel, prefix+&#x27;[&#x27;+key+&#
x27;]&#x27;);
        if (promise instanceof Promise) {
          promises.push(promise);
          promise = null;
        }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.new" id="apidoc.element.thinky.model.new">
        function <span class="apidocSignatureSpan">thinky.model.</span>new
        <span class="apidocSignatureSpan">(name, schema, options, thinky)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">new = function (name, schema, options, thinky) {

  var proto = new Model(name, schema, options, thinky);
  proto._initModel = options.init  !== undefined ? !!options.init : true;

  var model = function model(doc, options) {
    if (!util.isPlainObject(doc)) {
      throw new Error(&#x22;Cannot build a new instance of `&#x22;+proto._name+&#x22;` without an object&#x22;)
    }
    // We create a deepcopy only if doc was already used to create a document
    if (doc instanceof Document) {
      doc = util.deepCopy(doc);
    }

    util.changeProto(doc, new Document(model, options));

    // Create joins document. We do it here because `options` are easily available
    util.loopKeys(proto._joins, function(joins, key) {
      if (doc[key] != null) {
        if ((joins[key].type === &#x27;hasOne&#x27;) &#x26;&#x26; (doc[key] instanceof Document === false)) {
          doc[key] = new joins[key].model(doc[key], options);
        }
        else if ((joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; (doc[key] instanceof Document === false)) {
          doc[key] = new joins[key].model(doc[key], options);
        }
        else if (joins[key].type === &#x27;hasMany&#x27;) {
          doc.__proto__._hasMany[key] = []

          for(var i=0; i&#x3c;doc[key].length; i++) {
            if (doc[key][i] instanceof Document === false) {
              doc[key][i] = new joins[key].model(doc[key][i], options);
            }
          }
        }
        else if (joins[key].type === &#x27;hasAndBelongsToMany&#x27;) {
          for(var i=0; i&#x3c;doc[key].length; i++) {
            if (doc[key][i] instanceof Document === false) {
              doc[key][i] = new joins[key].model(doc[key][i], options);
            }
          }
        }
      }
    });
    doc._getModel()._schema._setModel(doc._getModel());
    if (proto.needToGenerateFields === true) {
      doc._generateDefault();
    }

    var promises = [];
    var promise;
    if (proto._options.validate === &#x27;oncreate&#x27;) {
      promise = doc.validate(options);
      if (promise instanceof Promise) promises.push(promise);
    }

    if (proto._post.init.length &#x3e; 0) {
      promise = util.hook({
        postHooks: doc._getModel()._post.init,
        doc: doc,
        async: doc._getModel()._async.init,
        fn: function() {
          return doc;
        }
      })
      if (promise instanceof Promise) promises.push(promise);
    }

    if (promises.length &#x3e; 0) {
      return Promise.all(promises).then(function(docs) {
        return docs[0];
      });
    }
    return doc;
  }

  model.__proto__ = proto;

  if (options.init !== false) {
    // Setup the model&#x27;s table.
    model.tableReady().then();
  }
  else {
    // We do not initialize the table and suppose that it already exists and
    // is ready.
    model.emit(&#x27;created&#x27;);
    model.emit(&#x27;ready&#x27;);
  }

  // So people can directly call the EventEmitter from the constructor
  // TOIMPROVE: We should emit everything from the constructor instead of emitting things from
  // the constructor and the instance of Model
  util.loopKeys(EventEmitter.prototype, function(emitter, key) {
    (function(_key) {
      model[_key] = function() {
        model._getModel()[_key].apply(model._getModel(), arguments);
      }
    })(key)
  });


  return model
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.super_" id="apidoc.element.thinky.model.super_">
        function <span class="apidocSignatureSpan">thinky.model.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.model.prototype" id="apidoc.module.thinky.model.prototype">module thinky.model.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.model.prototype.ISO8601" id="apidoc.element.thinky.model.prototype.ISO8601">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ISO8601
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ISO8601 = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype._createIndex" id="apidoc.element.thinky.model.prototype._createIndex">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_createIndex
        <span class="apidocSignatureSpan">(name, fn, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_createIndex = function (name, fn, opts) {
  var model = this._getModel();
  var tableName = this.getTableName();
  var r = model._thinky.r;

  if (opts === undefined &#x26;&#x26; util.isPlainObject(fn)) {
    opts = fn;
    fn = undefined;
  }

  var promise = this.tableReady().then(function() {
    return new Promise(function(resolve, reject) {
      return r.branch(
        r.table(tableName).indexList().contains(name),
        r.table(tableName).indexWait(name),
        r.branch(
          r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
          r.table(tableName).indexWait(name),
          r.table(tableName).indexCreate(name, fn, opts).do(function() {
            return r.table(tableName).indexWait(name);
          })
        )
      )
      .run()
      .then(resolve)
      .error(function(error) {
        if (error.message.match(/^Index/)) {
          // TODO: This regex seems a bit too generous since messages such
          // as &#x22;Index `id` was not found on table...&#x22; will be accepted.
          // Figure out if this is OK or not.
          return resolve();
        }
        reject(error);
      });
    });
  })
  .then(function() {
    model._indexes[name] = true;
  });

  this._waitFor(promise);
  return promise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var self = this;

  if ((opts === undefined) &#x26;&#x26; (util.isPlainObject(fn))) {
    opts = fn;
    fn = undefined;
  }

  return self.<span class="apidocCodeKeywordSpan">_createIndex</span>(name, fn, opts)
  .catch(function(error) {
    self._getModel()._setError(error);
    throw error;
  });
}

Model.prototype._createIndex = function(name, fn, opts) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype._get" id="apidoc.element.thinky.model.prototype._get">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_get
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_get = function () {
  var query = new Query(this);
  query = query[&#x27;_get&#x27;].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype._getModel" id="apidoc.element.thinky.model.prototype._getModel">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_getModel
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getModel = function () {
  return this.__proto__;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {function} model The model of this document
 * @param {object=} options Options that can overwrite the ones of the model
 */
function Document(model, options) {
var self = this;  // Keep a reference to itself.

this.constructor = model;  // The constructor for this model
this._model = model.<span class="apidocCodeKeywordSpan">_getModel</span>(); // The instance of Model

// We don&#x27;t want to store options if they are different
// than the one provided by the model
if (util.isPlainObject(options)) {
  this._schemaOptions = {};
  this._schemaOptions.enforce_missing =
      (options.enforce_missing != null) ? options.enforce_missing : model.getOptions().enforce_missing;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype._parse" id="apidoc.element.thinky.model.prototype._parse">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_parse
        <span class="apidocSignatureSpan">(data, ungroup)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_parse = function (data, ungroup) {
  var self = this;
  var promises = [];
  var promise;

  var p = new Promise(function(resolve, reject) {
    if (ungroup) {
      for(var i=0; i&#x3c;data.length; i++) {
        for(var j=0; j&#x3c;data[i].reduction.length; j++) {
          util.tryCatch(function() {
            var newDoc = new self(data[i].reduction[j]);
            newDoc.setSaved(true);
            newDoc._emitRetrieve();
            data[i].reduction[j] = newDoc;
          }, reject)
        }
      }
      return resolve(data);
    }
    else if (Array.isArray(data)) {
      util.tryCatch(function() {
        for(var i=0; i&#x3c;data.length; i++) {
          data[i] = new self(data[i])
          data[i].setSaved(true);

          self.emit(&#x27;retrieved&#x27;, data[i]);

          (function(i) {
            // Order matters here, we want the hooks to be executed *before* calling validate
            promise = util.hook({
              postHooks: data[i]._getModel()._post.retrieve,
              doc: data[i],
              async: data[i]._getModel()._async.retrieve,
              fn: function() {}
            })
            if (promise instanceof Promise) {
              promise.then(function() {
                var promise = data[i].validate();
                if (promise instanceof Promise) {
                  promise.then(function() {
                    resolve(data)
                  }).error(reject);
                }
                else {
                  resolve(data);
                }
              }).error(reject);
              promises.push(promise);
            }
            else {
              promise = data[i].validate();
              if (promise instanceof Promise) promises.push(promise);
            }
          })(i);
        }
      }, function(error) {
        var newError = new Error(&#x22;The results could not be converted to instances of `&#x22;+self.getTableName()+&#x22;`\nDetailed error: &#x22;+
error.message);

        return reject(newError);
      });

      if (promises.length &#x3e; 0) {
        Promise.all(promises).then(function() {
          resolve(data);
        }).error(reject);
      }
      else {
        resolve(data);
      }
    }
    else {
      // If we get a GROUPED_DATA, we convert documents in each group
      if (util.isPlainObject(data) &#x26;&#x26; (data.$reql_type$ === &#x22;GROUPED_DATA&#x22;)) {
        var result = [];
        util.tryCatch(function() {
          var reduction, newDoc;
          for(var i=0; i&#x3c;data.data.length; i++) {
            (function(i) {
              reduction = [];
              if (Array.isArray(data.data[i][1])) {
                for(var j=0; j&#x3c;data.data[i][1].length; j++) {
                  (function(j) {
                    newDoc = new self(data.data[i][1][j]);
                    newDoc.setSaved(true);

                    newDoc._emitRetrieve();

                    promise = util.hook({
                      postHooks: newDoc._getModel()._post.retrieve,
                      doc: newDoc,
                      async: newDoc._getModel()._async.retrieve,
                      fn: function() {}
                    })
                    if (promise instanceof Promise) {
                      promise.then(function() {
                        var promise = newDoc.validate();
                        if (promise instanceof Promise) {
                          promise.then(function() {
                            resolve(data)
                          }).error(reject);
                        }
                        else {
                          resolve(data);
                        }
                      }).error(reject);
                      promises.push(promise);
                    }
                    else {
                      promise = newDoc.validate();
                      if (promise instanceof Promise) promises.push(promise);
                    }

                    reduction.push(newDoc)
                  })(j);
                }
                result.push({
                  group: data.data[i][0],
                  reduction: reduction
                })
              } ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Feed.prototype._next = function() {
var self = this;
return new Promise(function(resolve, reject) {
  self.feed.next().then(function(data) {
    util.tryCatch(function() {
      if (data.new_val != null) {
        self.model.<span class="apidocCodeKeywordSpan">_parse</span>(data.new_val).then(function(doc) {
          doc._setOldValue(data.old_val);
          resolve(doc);
        }).error(reject);
      }
      else if (data.old_val != null) { // new_val is null
        self.model._parse(data.old_val).then(function(doc) {
          doc._setUnSaved();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype._promisesReady" id="apidoc.element.thinky.model.prototype._promisesReady">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_promisesReady
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_promisesReady = function () {
  var self = this;
  if (this._promisesReadyPromise) return this._promisesReadyPromise;

  var verifyAll = function() {
    return Promise.all(self._pendingPromises)
    .then(function() {
      var i, allFullfilled = true;
      for (i=0; i&#x3c;self._pendingPromises.length; i++) {
         if (!self._pendingPromises[i].isFulfilled()) {
          allFullfilled = false;
          break;
         }
      }
      return allFullfilled ? Promise.resolve() : verifyAll();
    });
  };

  this._promisesReadyPromise = verifyAll();
  return this._promisesReadyPromise;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Model.prototype.ready = function() {
var requirements = [];

// Ensure the Model&#x27;s table is ready
requirements.push(this.tableReady());

// Ensure all other pending promises have been resolved
requirements.push(this.<span class="apidocCodeKeywordSpan">_promisesReady</span>());

return Promise.all(requirements);
};

Model.prototype._promisesReady = function() {
var self = this;
if (this._promisesReadyPromise) return this._promisesReadyPromise;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype._setError" id="apidoc.element.thinky.model.prototype._setError">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_setError
        <span class="apidocSignatureSpan">(error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_setError = function (error) {
  this._getModel()._error = error;
  this.emit(&#x27;error&#x27;, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if ((opts === undefined) &#x26;&#x26; (util.isPlainObject(fn))) {
  opts = fn;
  fn = undefined;
}

return self._createIndex(name, fn, opts)
.catch(function(error) {
  self._getModel().<span class="apidocCodeKeywordSpan">_setError</span>(error);
  throw error;
});
}

Model.prototype._createIndex = function(name, fn, opts) {
var model = this._getModel();
var tableName = this.getTableName();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype._waitFor" id="apidoc.element.thinky.model.prototype._waitFor">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>_waitFor
        <span class="apidocSignatureSpan">(promise)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_waitFor = function (promise) {
  var self = this;
  this._pendingPromises.push(promise);

  // Emit &#x27;ready&#x27; when all pending promises have resolved
  if (!this._pendingReady) {
    this._pendingReady = this._promisesReady().then(function() {
      delete self._pendingReady;
      self.emit(&#x27;ready&#x27;, self);
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     });
   });
 })
 .then(function() {
   model._indexes[name] = true;
 });

 this.<span class="apidocCodeKeywordSpan">_waitFor</span>(promise);
 return promise;
};

/*
* joinedModel: the joined model
* fieldDoc: the field where the joined document will be kept
* leftKey: the key in the model used for the join
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.add" id="apidoc.element.thinky.model.prototype.add">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>add
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
      return r.branch(
        result.count().eq(1),
        r.object(key, innerQuery),
        r.branch(
          result.count().eq(0),
          {},
          r.error(r.expr(&#x22;More than one element found for &#x22;).<span class="apidocCodeKeywordSpan">add</span>(doc.coerceTo
(&#x22;STRING&#x22;)).add(r.expr(&#x22;for the field &#x22;).add(key)))
        )
      )
    }),
    {}
  )
});
break;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.and" id="apidoc.element.thinky.model.prototype.and">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>and
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">and = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.append" id="apidoc.element.thinky.model.prototype.append">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>append
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">append = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.april" id="apidoc.element.thinky.model.prototype.april">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>april
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">april = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.args" id="apidoc.element.thinky.model.prototype.args">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>args
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">args = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
}

// Replace all documents with string-type primary keys
// in a single replace() operation.
if (primaryKeys.length) {
  revertPromises.push(
    r.table(self._model.getTableName()).getAll(r.<span class="apidocCodeKeywordSpan">args</span>(primaryKeys)).replace(function(
doc) {
      return r.expr(keysToValues)(doc(self._model._pk));
    }).run()
  );
}

return Promise.all(revertPromises).then(function(result) {
  throw new Error(&#x22;The write failed, and the changes were reverted.&#x22;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.asc" id="apidoc.element.thinky.model.prototype.asc">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>asc
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">asc = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.august" id="apidoc.element.thinky.model.prototype.august">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>august
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">august = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.avg" id="apidoc.element.thinky.model.prototype.avg">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>avg
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">avg = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.belongsTo" id="apidoc.element.thinky.model.prototype.belongsTo">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>belongsTo
        <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">belongsTo = function (joinedModel, fieldDoc, leftKey, rightKey, options) {
  var self  = this;

  if ((joinedModel instanceof Model) === false) {
    throw new Error(&#x22;First argument of `belongsTo` must be a Model&#x22;)
  }
  if (fieldDoc in self._getModel()._joins) {
    throw new Error(&#x22;The field `&#x22;+fieldDoc+&#x22;` is already used by another relation.&#x22;);
  }
  if (fieldDoc === &#x22;_apply&#x22;) {
    throw new Error(&#x22;The field `_apply` is reserved by thinky. Please use another one.&#x22;);
  }

  self._getModel()._joins[fieldDoc] = {
    model: joinedModel,
    leftKey: leftKey,
    rightKey: rightKey,
    type: &#x27;belongsTo&#x27;
  };
  self._getModel()._localKeys[leftKey] = true;

  joinedModel._getModel()._reverseJoins[fieldDoc] = {
    model: self,
    leftKey: leftKey,
    rightKey: rightKey,
    type: &#x27;belongsTo&#x27;,
  }

  options = options || {};
  if (options.init !== false) {
<span class="apidocCodeCommentSpan">    /*
    var newIndex = self._createIndex(leftKey)
    .catch(function(error) {
      joinedModel._getModel()._setError(error);
      self._getModel()._setError(error);
    });
    joinedModel._waitFor(newIndex);
    */
</span>    var newIndex = joinedModel._createIndex(rightKey)
    .catch(function(error) {
      joinedModel._getModel()._setError(error);
      self._getModel()._setError(error);
    });
    self._waitFor(newIndex);

  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var Author = thinky.createModel(&#x22;Author&#x22;, {
  id: type.string(),      // a normal string
  name: type.string().min(2),  // a string of at least two characters
  email: type.string().email()  // a string that is a valid email
});

// Join the models
Post.<span class="apidocCodeKeywordSpan">belongsTo</span>(Author, &#x22;author&#x22;, &#x22;idAuthor&#x22;, &#x22;id&#x22;);
```

Save a new post with its author.

```js
// Create a new post
var post = new Post({
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.between" id="apidoc.element.thinky.model.prototype.between">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>between
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">between = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.binary" id="apidoc.element.thinky.model.prototype.binary">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>binary
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">binary = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.bracket" id="apidoc.element.thinky.model.prototype.bracket">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>bracket
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bracket = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var updateValue = {};
  if (joinedDocument[joins[field].rightKey] === undefined) {
    if (joinedDocument[joinedModel._pk] === undefined) {
      return new Query(model, self, {},
          new Error(&#x27;The primary key or the joined key must be defined in the joined document for a `belongsTo` relation.&#
x27;)
      );
    }
    updateValue[joins[field].leftKey] = joinedModel.get(joinedDocument[joinedModel._pk]).<span class="apidocCodeKeywordSpan">bracket
</span>(joins[field].rightKey)._query;
  }
  else {
    updateValue[joins[field].leftKey] = joinedDocument[joins[field].rightKey];
  }
  return self.update(updateValue, {nonAtomic: true}).run();
case &#x27;hasAndBelongsToMany&#x27;:
  var linkModel = joins[field].linkModel;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.branch" id="apidoc.element.thinky.model.prototype.branch">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>branch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">branch = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (opts === undefined &#x26;&#x26; util.isPlainObject(fn)) {
  opts = fn;
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.<span class="apidocCodeKeywordSpan">branch</span>(
      r.table(tableName).indexList().contains(name),
      r.table(tableName).indexWait(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.catch" id="apidoc.element.thinky.model.prototype.catch">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>catch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catch = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if ((opts === undefined) &#x26;&#x26; (util.isPlainObject(fn))) {
  opts = fn;
  fn = undefined;
}

return self._createIndex(name, fn, opts)
.<span class="apidocCodeKeywordSpan">catch</span>(function(error) {
  self._getModel()._setError(error);
  throw error;
});
}

Model.prototype._createIndex = function(name, fn, opts) {
var model = this._getModel();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.ceil" id="apidoc.element.thinky.model.prototype.ceil">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ceil
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ceil = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.changeAt" id="apidoc.element.thinky.model.prototype.changeAt">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>changeAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">changeAt = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.changes" id="apidoc.element.thinky.model.prototype.changes">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>changes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">changes = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
  })(key);
  break;

case &#x27;changes&#x27;:
  (function(key) {
    Query.prototype[key] = function() {
      // In case of `get().<span class="apidocCodeKeywordSpan">changes</span>()` we want to remove the default(r.errror(...))
      // TODO: Do not hardcode this?
      if ((typeof this._query === &#x27;function&#x27;) &#x26;&#x26; (this._query._query[0] === 92)) {
        this._query._query = this._query._query[1][0];
      }
      return new Query(this._model, this._query[key].apply(this._query, arguments));
    }
  })(key);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.circle" id="apidoc.element.thinky.model.prototype.circle">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>circle
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">circle = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.coerceTo" id="apidoc.element.thinky.model.prototype.coerceTo">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>coerceTo
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">coerceTo = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.merge(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).<span class
="apidocCodeKeywordSpan">coerceTo</span>(&#x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
return r.branch(
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.concatMap" id="apidoc.element.thinky.model.prototype.concatMap">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>concatMap
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">concatMap = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
          break;

        case &#x27;hasAndBelongsToMany&#x27;:
          self._query = self._query.merge(function(doc) {
            if ((model.getTableName() === joins[key].model.getTableName()) &#x26;&#x26; (joins[key].leftKey === joins[key].rightKey
)) {
// In case the model is linked with itself on the same key

innerQuery = r.table(joins[key].link).getAll(doc(joins[key].leftKey), {index: joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey
}).<span class="apidocCodeKeywordSpan">concatMap</span>(function(link) {
  return r.table(joins[key].model.getTableName()).getAll(
    r.branch(
      doc(joins[key].leftKey).eq(link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(0)),
      link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(1),
      link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(0)
    )
  , {index: joins[key].rightKey})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.config" id="apidoc.element.thinky.model.prototype.config">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>config
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">config = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.contains" id="apidoc.element.thinky.model.prototype.contains">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>contains
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">contains = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  opts = fn;
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.branch(
      r.table(tableName).indexList().<span class="apidocCodeKeywordSpan">contains</span>(name),
      r.table(tableName).indexWait(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
        })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.count" id="apidoc.element.thinky.model.prototype.count">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>count
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">count = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
return r.branch(
  result.<span class="apidocCodeKeywordSpan">count</span>().eq(1),
  r.object(key, innerQuery),
  r.branch(
    result.count().eq(0),
    {},
    r.error(r.expr(&#x22;More than one element found for &#x22;).add(doc.coerceTo(&#x22;STRING&#x22;)).add(r.expr(&#x22;for the
field &#x22;).add(key)))
  )
)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.date" id="apidoc.element.thinky.model.prototype.date">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>date
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">date = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (schema.integer === true) { result.integer(); }
  return result;
case Boolean:
  result = type.boolean().options(options).validator(schema.validator);
  if (schema.default !== undefined) { result.default(schema.default); }
  return result;
case Date:
  var result = type.<span class="apidocCodeKeywordSpan">date</span>().options(options).validator(schema.validator);
  if (schema.default !== undefined) { result.default(schema.default); }
  if (schema.min instanceof Date) { result.min(schema.min); }
  if (schema.max instanceof Date) { result.max(schema.max); }
  return result;
case Buffer:
  result = type.buffer().options(options).validator(schema.validator);
  if (schema.default !== undefined) { result.default(schema.default); }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.day" id="apidoc.element.thinky.model.prototype.day">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>day
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">day = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.dayOfWeek" id="apidoc.element.thinky.model.prototype.dayOfWeek">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dayOfWeek
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dayOfWeek = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.dayOfYear" id="apidoc.element.thinky.model.prototype.dayOfYear">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dayOfYear
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dayOfYear = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.db" id="apidoc.element.thinky.model.prototype.db">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>db
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">db = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.dbCreate" id="apidoc.element.thinky.model.prototype.dbCreate">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dbCreate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbCreate = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.dbDrop" id="apidoc.element.thinky.model.prototype.dbDrop">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dbDrop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbDrop = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.dbList" id="apidoc.element.thinky.model.prototype.dbList">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>dbList
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbList = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.december" id="apidoc.element.thinky.model.prototype.december">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>december
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">december = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.default" id="apidoc.element.thinky.model.prototype.default">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>default
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">default = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Note: We suppose that no method has an empty name
switch (key) {
  case &#x27;get&#x27;:
    // `get` in thinky returns an error if the document is not found.
    // The driver currently just returns `null`.
    (function(key) {
      Query.prototype[key] = function() {
        return new Query(this._model, this._query[key].apply(this._query, arguments)).<span class="apidocCodeKeywordSpan">default
</span>(this._r.error(new Errors.DocumentNotFound().message));
      }
    })(key);
    // Copy it in `_get` without `default`.
    (function(key) {
      Query.prototype[&#x27;_get&#x27;] = function() {
        // Create a new query to let people fork it
        return new Query(this._model, this._query[key].apply(this._query, arguments));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.define" id="apidoc.element.thinky.model.prototype.define">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>define
        <span class="apidocSignatureSpan">(key, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">define = function (key, fn) {
  this._methods[key] = fn;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.defineStatic" id="apidoc.element.thinky.model.prototype.defineStatic">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>defineStatic
        <span class="apidocSignatureSpan">(key, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">defineStatic = function (key, fn) {
  this._staticMethods[key] = fn;

  this[key] = function() {
    return fn.apply(this, arguments);
  };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.delay" id="apidoc.element.thinky.model.prototype.delay">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>delay
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delay = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.delete" id="apidoc.element.thinky.model.prototype.delete">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>delete
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._belongsTo = {};
this._hasOne = {};
this._hasMany = {};
// Example: { &#x3c;linkTableName&#x3e;: { &#x3c;valueOfRightKey&#x3e;: true, ... }, ... }
this._links = {}

// Keep reference of any doc having a link pointing to this
// So we can clean when users do doc.belongsToDoc.<span class="apidocCodeKeywordSpan">delete</span>()
this._parents = {
  _hasOne: {},      // &#x3c;tableName&#x3e;: [{doc, key}]
  _hasMany: {},     // &#x3c;tableName&#x3e;: [{doc, key}]
  _belongsTo: {},   // &#x3c;tableName&#x3e;: [{doc, key, foreignKey}]
  _belongsLinks: {} // &#x3c;tableName&#x3e;: [{doc, key}]
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.deleteAt" id="apidoc.element.thinky.model.prototype.deleteAt">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>deleteAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deleteAt = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.desc" id="apidoc.element.thinky.model.prototype.desc">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>desc
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">desc = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.difference" id="apidoc.element.thinky.model.prototype.difference">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>difference
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">difference = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.distance" id="apidoc.element.thinky.model.prototype.distance">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>distance
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">distance = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.distinct" id="apidoc.element.thinky.model.prototype.distinct">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>distinct
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">distinct = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.div" id="apidoc.element.thinky.model.prototype.div">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>div
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">div = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.do" id="apidoc.element.thinky.model.prototype.do">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>do
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">do = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return new Promise(function(resolve, reject) {
return r.branch(
  r.table(tableName).indexList().contains(name),
  r.table(tableName).indexWait(name),
  r.branch(
    r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
    r.table(tableName).indexWait(name),
    r.table(tableName).indexCreate(name, fn, opts).<span class="apidocCodeKeywordSpan">do</span>(function() {
      return r.table(tableName).indexWait(name);
    })
  )
)
.run()
.then(resolve)
.error(function(error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.docAddListener" id="apidoc.element.thinky.model.prototype.docAddListener">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docAddListener
        <span class="apidocSignatureSpan">(eventKey, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">docAddListener = function (eventKey, listener) {
  var listeners = this._getModel()._listeners;
  if (listeners[eventKey] == null) {
    listeners[eventKey] = [];
  }
  listeners[eventKey].push({
    once: false,
    listener: listener
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.docListeners" id="apidoc.element.thinky.model.prototype.docListeners">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docListeners
        <span class="apidocSignatureSpan">(eventKey, raw)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">docListeners = function (eventKey, raw) {
  if (eventKey == null) {
    return this._getModel()._listeners
  }

  raw = raw || true;
  if (raw === true) {
    return this._getModel()._listeners[eventKey];
  }
  else {
    return this._getModel()._listeners[eventKey].map(function(fn) {
      return fn.listener;
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.docOn" id="apidoc.element.thinky.model.prototype.docOn">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docOn
        <span class="apidocSignatureSpan">(eventKey, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">docOn = function (eventKey, listener) {
  var listeners = this._getModel()._listeners;
  if (listeners[eventKey] == null) {
    listeners[eventKey] = [];
  }
  listeners[eventKey].push({
    once: false,
    listener: listener
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.docOnce" id="apidoc.element.thinky.model.prototype.docOnce">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docOnce
        <span class="apidocSignatureSpan">(eventKey, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">docOnce = function (eventKey, listener) {
  var listeners = this._getModel()._listeners;
  if (listeners[eventKey] == null) {
    listeners[eventKey] = [];
  }
  listeners[eventKey].push({
    once: true,
    listener: listener
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.docRemoveAllListeners" id="apidoc.element.thinky.model.prototype.docRemoveAllListeners">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docRemoveAllListeners
        <span class="apidocSignatureSpan">(ev)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">docRemoveAllListeners = function (ev) {
  if (ev === undefined) {
    delete this._getModel()._listeners[ev]
  }
  else {
    this._getModel()._listeners = {};
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.docRemoveListener" id="apidoc.element.thinky.model.prototype.docRemoveListener">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docRemoveListener
        <span class="apidocSignatureSpan">(ev, listener)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">docRemoveListener = function (ev, listener) {
  if (Array.isArray(this._getModel()._listeners[ev])) {
    for(var i=0; i&#x3c;this._getModel()._listeners[ev].length; i++) {
      if (this._getModel()._listeners[ev][i] === listener) {
        this._getModel()._listeners[ev].splice(i, 1);
        break;
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.docSetMaxListeners" id="apidoc.element.thinky.model.prototype.docSetMaxListeners">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>docSetMaxListeners
        <span class="apidocSignatureSpan">(n)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">docSetMaxListeners = function (n) {
  this._getModel()._maxListeners = n;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.downcase" id="apidoc.element.thinky.model.prototype.downcase">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>downcase
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">downcase = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.during" id="apidoc.element.thinky.model.prototype.during">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>during
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">during = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.ensureIndex" id="apidoc.element.thinky.model.prototype.ensureIndex">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ensureIndex
        <span class="apidocSignatureSpan">(name, fn, opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ensureIndex = function (name, fn, opts) {
  var self = this;

  if ((opts === undefined) &#x26;&#x26; (util.isPlainObject(fn))) {
    opts = fn;
    fn = undefined;
  }

  return self._createIndex(name, fn, opts)
  .catch(function(error) {
    self._getModel()._setError(error);
    throw error;
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.epochTime" id="apidoc.element.thinky.model.prototype.epochTime">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>epochTime
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">epochTime = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.eq" id="apidoc.element.thinky.model.prototype.eq">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>eq
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eq = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  var promise = this.tableReady().then(function() {
return new Promise(function(resolve, reject) {
  return r.branch(
    r.table(tableName).indexList().contains(name),
    r.table(tableName).indexWait(name),
    r.branch(
      r.table(tableName).info()(&#x27;primary_key&#x27;).<span class="apidocCodeKeywordSpan">eq</span>(name),
      r.table(tableName).indexWait(name),
      r.table(tableName).indexCreate(name, fn, opts).do(function() {
        return r.table(tableName).indexWait(name);
      })
    )
  )
  .run()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.eqJoin" id="apidoc.element.thinky.model.prototype.eqJoin">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>eqJoin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eqJoin = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.error" id="apidoc.element.thinky.model.prototype.error">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>error
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">error = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
    });

    //TODO Remove once
    self.getModel().ready().then(function() {
      Promise.all(promises).then(function() {
        self._onSavedBelongsTo(copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject);
      }).<span class="apidocCodeKeywordSpan">error</span>(reject);
    });
  });
  return p;
}


/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.execute" id="apidoc.element.thinky.model.prototype.execute">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>execute
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">execute = function (options) {
  var query = new Query(this);
  return query.execute(options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Model.prototype.run = function(options) {
var query = new Query(this);
return query.run(options);
}
Model.prototype.execute = function(options) {
var query = new Query(this);
return query.<span class="apidocCodeKeywordSpan">execute</span>(options);
}

Model.prototype.save = function(docs, options) {
var self = this;
var r = self._getModel()._thinky.r;
var isArray = Array.isArray(docs);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.expr" id="apidoc.element.thinky.model.prototype.expr">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>expr
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expr = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

return Promise.all([self.ready(), joinedModel.ready()]);
  }
};

(function() {
  // Import rethinkdbdash methods
  var Term = require(&#x27;rethinkdbdash&#x27;)({pool: false}).<span class="apidocCodeKeywordSpan">expr</span>(1).__proto__;
  util.loopKeys(Term, function(Term, key) {
if (!Term.hasOwnProperty(key)) return;
if (key === &#x27;run&#x27; || key[0] === &#x27;_&#x27;) return;

(function(key) {
  switch (key) {
    case &#x27;orderBy&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.february" id="apidoc.element.thinky.model.prototype.february">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>february
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">february = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.fill" id="apidoc.element.thinky.model.prototype.fill">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>fill
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fill = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.filter" id="apidoc.element.thinky.model.prototype.filter">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>filter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">filter = function () {
  var query = new Query(this);
  if ((arguments.length === 1)
    &#x26;&#x26; (util.isPlainObject(arguments[0]))) {

    // Optimize a filter with an object
    // We replace the first key that match an index name
    var filter = arguments[0];

    var keys = Object.keys(filter).sort(); // Lexicographical order
    for(var i=0 ; i&#x3c;keys.length; i++) {
      var index = keys[i];

      if (this._getModel()._indexes[index] === true) { // Index found
        query = query.getAll(filter[index], {index: index});
        delete filter[index];
        break;
      }
    }
  }

  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.finally" id="apidoc.element.thinky.model.prototype.finally">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>finally
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">finally = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.floor" id="apidoc.element.thinky.model.prototype.floor">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>floor
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">floor = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.fold" id="apidoc.element.thinky.model.prototype.fold">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>fold
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fold = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.forEach" id="apidoc.element.thinky.model.prototype.forEach">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>forEach
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEach = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.friday" id="apidoc.element.thinky.model.prototype.friday">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>friday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">friday = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.ge" id="apidoc.element.thinky.model.prototype.ge">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ge = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.geojson" id="apidoc.element.thinky.model.prototype.geojson">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>geojson
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">geojson = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  else if (type.isPoint(schema)) {
if (util.isPlainObject(doc) &#x26;&#x26; (doc[&#x27;$reql_type$&#x27;] !== &#x22;GEOMETRY&#x22;)) {
  var keys = Object.keys(doc).sort();
  if ((keys.length === 2) &#x26;&#x26; (keys[0] === &#x27;latitude&#x27;) &#x26;&#x26; (keys[1] === &#x27;longitude&#x27;) &#x26
;&#x26; (typeof doc.latitude === &#x22;number&#x22;) &#x26;&#x26; (typeof doc.longitude === &#x22;number&#x22;)) {
    return r.point(doc.longitude, doc.latitude)
  }
  else if ((doc.type === &#x22;Point&#x22;) &#x26;&#x26; (Array.isArray(doc.coordinates)) &#x26;&#x26; (doc.coordinates.length ===
2)) { // Geojson
    return r.<span class="apidocCodeKeywordSpan">geojson</span>(doc)
  }
}
else if (Array.isArray(doc)) {
  if ((doc.length === 2) &#x26;&#x26; (typeof doc[0] === &#x22;number&#x22;) &#x26;&#x26; (typeof doc[1] === &#x22;number&#x22;)) {
    return r.point(doc[0], doc[1])
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.get" id="apidoc.element.thinky.model.prototype.get">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>get
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
});
```

Retrieve the post with its author.

```js
Post.<span class="apidocCodeKeywordSpan">get</span>(&#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;).getJoin().run().then(function
(result) {
/*
result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.getAll" id="apidoc.element.thinky.model.prototype.getAll">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getAll
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAll = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // Purge the database
  var promises = [];
  util.loopKeys(self._getModel()._joins, function(joins, field) {
var join = joins[field];
var joinedModel = join.model;

if ((join.type === &#x27;hasOne&#x27;) || (join.type === &#x27;hasMany&#x27;)) {
  promises.push(r.table(joinedModel.getTableName()).<span class="apidocCodeKeywordSpan">getAll</span>(self[join.leftKey], {index
: join.rightKey}).replace(function(doc) {
    return doc.without(join.rightKey)
  }).run())
}
// nothing to do for &#x22;belongsTo&#x22;
else if (join.type === &#x27;hasAndBelongsToMany&#x27;) {
  if (self.getModel()._getModel()._pk === join.leftKey) {
    // [1]
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.getField" id="apidoc.element.thinky.model.prototype.getField">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getField
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getField = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.getIntersecting" id="apidoc.element.thinky.model.prototype.getIntersecting">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getIntersecting
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getIntersecting = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.getJoin" id="apidoc.element.thinky.model.prototype.getJoin">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getJoin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getJoin = function () {
  var query = new Query(this);
  return query.getJoin.apply(query, arguments)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
});
```

Retrieve the post with its author.

```js
Post.get(&#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;).<span class="apidocCodeKeywordSpan">getJoin</span>().run().then(function
(result) {
/*
result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.getNearest" id="apidoc.element.thinky.model.prototype.getNearest">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getNearest
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getNearest = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.getOptions" id="apidoc.element.thinky.model.prototype.getOptions">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getOptions
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getOptions = function () {
  return this._options;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._model = model._getModel(); // The instance of Model

// We don&#x27;t want to store options if they are different
// than the one provided by the model
if (util.isPlainObject(options)) {
  this._schemaOptions = {};
  this._schemaOptions.enforce_missing =
      (options.enforce_missing != null) ? options.enforce_missing : model.<span class="apidocCodeKeywordSpan">getOptions</span>().
enforce_missing;
  this._schemaOptions.enforce_extra =
      (options.enforce_extra != null) ? options.enforce_extra : model.getOptions().enforce_extra;
  this._schemaOptions.enforce_type =
      (options.enforce_type != null) ? options.enforce_type : model.getOptions().enforce_type;
}

//TODO: We do not need to make a deep copy. We can do the same as for this._schemaOptions.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.getTableName" id="apidoc.element.thinky.model.prototype.getTableName">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>getTableName
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getTableName = function () {
  return this._getModel()._name;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
self._getModel()._schema.validate(self, prefix, schemaOptions)

if (util.isPlainObject(modelToValidate) === false) {
  modelToValidate = {};
}

var constructor = self.__proto__.constructor;
validatedModel[constructor.<span class="apidocCodeKeywordSpan">getTableName</span>()] = true;

// Validate joined documents
util.loopKeys(self._getModel()._joins, function(joins, key) {
  if (util.recurse(key, joins, modelToValidate, validateAll, validatedModel)) {
    switch (joins[key].type) {
      case &#x27;hasOne&#x27;:
      case &#x27;belongsTo&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.grant" id="apidoc.element.thinky.model.prototype.grant">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>grant
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">grant = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.group" id="apidoc.element.thinky.model.prototype.group">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>group
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">group = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.gt" id="apidoc.element.thinky.model.prototype.gt">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>gt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">gt = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.hasAndBelongsToMany" id="apidoc.element.thinky.model.prototype.hasAndBelongsToMany">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasAndBelongsToMany
        <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasAndBelongsToMany = function (joinedModel, fieldDoc, leftKey, rightKey, options) {
  var self = this;
  var link, query;
  var thinky = this._getModel()._thinky;
  options = options || {};

  if ((joinedModel instanceof Model) === false) {
    throw new Error(&#x22;First argument of `hasAndBelongsToMany` must be a Model&#x22;)
  }
  if (fieldDoc in self._getModel()._joins) {
    throw new Error(&#x22;The field `&#x22;+fieldDoc+&#x22;` is already used by another relation.&#x22;);
  }
  if (fieldDoc === &#x22;_apply&#x22;) {
    throw new Error(&#x22;The field `_apply` is reserved by thinky. Please use another one.&#x22;);
  }

  if (this._getModel()._name &#x3c; joinedModel._getModel()._name) {
    link = this._getModel()._name+&#x22;_&#x22;+joinedModel._getModel()._name;
  }
  else {
    link = joinedModel._getModel()._name+&#x22;_&#x22;+this._getModel()._name;
  }
  if (typeof options.type === &#x27;string&#x27;) {
    link = link+&#x22;_&#x22;+options.type;
  }
  else if (typeof options.type !== &#x27;undefined&#x27;) {
    throw new Error(&#x27;options.type should be a string or undefined.&#x27;)
  }

  var linkModel;
  if (thinky.models[link] === undefined) {
    // Create a model, claim the namespace and create the table
    // passes table options to the underlying model (e.g. replicas, shards)
    linkModel = thinky.createModel(link, {}, { table: options.table });
  }
  else {
    linkModel = thinky.models[link];
  }


  this._getModel()._joins[fieldDoc] = {
    model: joinedModel,
    leftKey: leftKey,
    rightKey: rightKey,
    type: &#x27;hasAndBelongsToMany&#x27;,
    link: link,
    linkModel: linkModel
  }

  joinedModel._getModel()._reverseJoins[self.getTableName()] = {
    leftKey: leftKey,
    rightKey: rightKey,
    type: &#x27;hasAndBelongsToMany&#x27;,
    link: link,
    linkModel: linkModel
  }

  if (options.init !== false) {
    var r = self._getModel()._thinky.r;

    var query;
    if ((this.getTableName() === joinedModel.getTableName())
      &#x26;&#x26; (leftKey === rightKey)) {
      // The relation is built for the same model, using the same key
      // Create a multi index
      query = r.branch(
        r.table(link).indexList().contains(leftKey+&#x22;_&#x22;+rightKey),
        r.table(link).indexWait(leftKey+&#x22;_&#x22;+rightKey),
        r.table(link).indexCreate(leftKey+&#x22;_&#x22;+rightKey, function(doc) {
          return doc(leftKey+&#x22;_&#x22;+rightKey)
        }, {multi: true}).do(function() {
          return r.table(link).indexWait(leftKey+&#x22;_&#x22;+rightKey)
        })
      )
    }
    else {
      query = r.branch(
        r.table(link).indexList().contains(self.getTableName()+&#x27;_&#x27;+leftKey),
        r.table(link).indexWait(self.getTableName()+&#x27;_&#x27;+leftKey),
        r.table(link).indexCreate(self.getTableName()+&#x27;_&#x27;+leftKey).do(function() {
          return r.table(link).indexWait(self.getTableName()+&#x27;_&#x27;+leftKey)
        })
      ).do(function() {
        return r.branch(
          r.table(link).indexList().contains(joinedModel.getTableName()+&#x27;_&#x27;+rightKey),
          r.table(link).indexWait(joinedModel.getTableName()+&#x27;_&#x27;+rightKey),
          r.table(link).indexCreate(joinedModel.getTableName()+&#x27;_&#x27;+rightKey).do(function() {
            return r.table(link).indexWait(joinedModel.getTableName()+&#x27;_&#x27;+rightKey)
          })
        )
      })

    }

    var linkPromise = linkModel.ready().then(function() {
      return query.run()
      .then(function() {
        self._getModel()._indexes[leftKey] = true;
        joinedModel._getModel()._indexes[rightKey] = true;
      })
      .error(function(error) {
        if (error.message.match(/^Index `/)) {
          return;
        }
        if (error.message.match(/^Table `.*` already exists/)) {
          return;
        }
        self._getModel()._setError(error);
        joinedModel._getModel()._setError(error);
        throw error;
      });
    })
    .then(function() {
      self._createIndex(leftKey)
      .catch(function(error) {
        self._getModel()._setError(error);
        joinedModel._getModel()._setError(error);
      });

      joinedModel._createIndex(rightKey)
      .catch(function(error) {
        self._getModel()._setError(error);
        joinedModel._getModel()._setError(error);
      });
    });

    joinedModel._wait ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    promises.push(r.table(joinedModel.getTableName()).getAll(self[join.rightKey], {index: join.leftKey}).replace(function(doc) {
      return doc.without(join.leftKey)
    }).run())
  }
  // nothing to do for &#x22;belongsTo&#x22;
  else if (join.type === &#x27;hasAndBelongsToMany&#x27;) {
    // Purge only if the key is a primary key
    // What was called is joinedModel.<span class="apidocCodeKeywordSpan">hasAndBelongsToMany</span>(self, fieldDoc, leftKey, rightKey
)
    if (self.getModel()._getModel()._pk === join.leftKey) {
      promises.push(r.table(join.link).getAll(self[join.rightKey], {index: self.getModel().getTableName()+&#x22;_&#x22;+join.rightKey
}).delete().run())
    }
  }
});

// Delete itself
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.hasFields" id="apidoc.element.thinky.model.prototype.hasFields">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasFields
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasFields = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  util.loopKeys(joins, function(joins, key) {
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.merge(function(doc) {
            return r.branch(
              doc.<span class="apidocCodeKeywordSpan">hasFields</span>(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#
x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.hasMany" id="apidoc.element.thinky.model.prototype.hasMany">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasMany
        <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasMany = function (joinedModel, fieldDoc, leftKey, rightKey, options) {
  var self  = this;

  if ((joinedModel instanceof Model) === false) {
    throw new Error(&#x22;First argument of `hasMany` must be a Model&#x22;)
  }
  if (fieldDoc in self._getModel()._joins) {
    throw new Error(&#x22;The field `&#x22;+fieldDoc+&#x22;` is already used by another relation.&#x22;);
  }
  if (fieldDoc === &#x22;_apply&#x22;) {
    throw new Error(&#x22;The field `_apply` is reserved by thinky. Please use another one.&#x22;);
  }

  this._getModel()._joins[fieldDoc] = {
    model: joinedModel,
    leftKey: leftKey,
    rightKey: rightKey,
    type: &#x27;hasMany&#x27;
  };
  joinedModel._getModel()._localKeys[rightKey] = true;

  options = options || {};
  if (options.init !== false) {
    var newIndex = joinedModel._createIndex(rightKey)
    .catch(function(error) {
      self._getModel()._setError(error);
      joinedModel._getModel()._setError(error);
    });
    self._waitFor(newIndex);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/*
 * joinedModel: the joined model
 * fieldDoc: the field where the joined document will be kept
 * leftKey: the key in the model used for the join
 * rightKey: the key in the joined model used for the join
 *
 * A post has one author, and an author can write multiple posts
 * Author.<span class="apidocCodeKeywordSpan">hasMany</span>(Post, &#x22;posts&#x22;, &#x22;id&#x22;, &#x22;authorId&#x22;
 *                 ^- author.id
 */
Model.prototype.hasMany = function(joinedModel, fieldDoc, leftKey, rightKey, options) {
var self  = this;

if ((joinedModel instanceof Model) === false) {
  throw new Error(&#x22;First argument of `hasMany` must be a Model&#x22;)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.hasOne" id="apidoc.element.thinky.model.prototype.hasOne">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hasOne
        <span class="apidocSignatureSpan">(joinedModel, fieldDoc, leftKey, rightKey, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasOne = function (joinedModel, fieldDoc, leftKey, rightKey, options) {
  var self  = this;

  if ((joinedModel instanceof Model) === false) {
    throw new Error(&#x22;First argument of `hasOne` must be a Model&#x22;)
  }
  if (fieldDoc in self._getModel()._joins) {
    throw new Error(&#x22;The field `&#x22;+fieldDoc+&#x22;` is already used by another relation.&#x22;);
  }
  if (fieldDoc === &#x22;_apply&#x22;) {
    throw new Error(&#x22;The field `_apply` is reserved by thinky. Please use another one.&#x22;);
  }
  self._getModel()._joins[fieldDoc] = {
    model: joinedModel,
    leftKey: leftKey,
    rightKey: rightKey,
    type: &#x27;hasOne&#x27;
  }
  joinedModel._getModel()._localKeys[rightKey] = true;

  options = options || {};
  if (options.init !== false) {
    var newIndex = joinedModel._createIndex(rightKey)
    .catch(function(error) {
      joinedModel._getModel()._setError(error);
      self._getModel()._setError(error);
    });
    self._waitFor(newIndex);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* joinedModel: the joined model
* fieldDoc: the field where the joined document will be kept
* leftKey: the key in the model used for the join
* rightKey: the key in the joined model used for the join
*
* The foreign key is stores in the joinedModel
*
* Post.<span class="apidocCodeKeywordSpan">hasOne</span>(Author, &#x22;author&#x22;, &#x22;id&#x22;, &#x22;postId&#x22;
*                ^- post.id
*
* options can be:
* - init: Boolean (create an index or not)
* - timeFormat: &#x27;raw&#x27;/&#x27;native&#x27;
* - enforce_extra: &#x27;strict&#x27;/&#x27;remove&#x27;/&#x27;none&#x27;
* - enforce_missing: Boolean
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.hours" id="apidoc.element.thinky.model.prototype.hours">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>hours
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hours = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.http" id="apidoc.element.thinky.model.prototype.http">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>http
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">http = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.inTimezone" id="apidoc.element.thinky.model.prototype.inTimezone">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>inTimezone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inTimezone = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.includes" id="apidoc.element.thinky.model.prototype.includes">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>includes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">includes = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.indexCreate" id="apidoc.element.thinky.model.prototype.indexCreate">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexCreate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexCreate = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return new Promise(function(resolve, reject) {
return r.branch(
  r.table(tableName).indexList().contains(name),
  r.table(tableName).indexWait(name),
  r.branch(
    r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
    r.table(tableName).indexWait(name),
    r.table(tableName).<span class="apidocCodeKeywordSpan">indexCreate</span>(name, fn, opts).do(function() {
      return r.table(tableName).indexWait(name);
    })
  )
)
.run()
.then(resolve)
.error(function(error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.indexDrop" id="apidoc.element.thinky.model.prototype.indexDrop">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexDrop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexDrop = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.indexList" id="apidoc.element.thinky.model.prototype.indexList">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexList
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexList = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  opts = fn;
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.branch(
      r.table(tableName).<span class="apidocCodeKeywordSpan">indexList</span>().contains(name),
      r.table(tableName).indexWait(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
        })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.indexRename" id="apidoc.element.thinky.model.prototype.indexRename">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexRename
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexRename = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.indexStatus" id="apidoc.element.thinky.model.prototype.indexStatus">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexStatus
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexStatus = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.indexWait" id="apidoc.element.thinky.model.prototype.indexWait">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexWait
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexWait = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.branch(
      r.table(tableName).indexList().contains(name),
      r.table(tableName).<span class="apidocCodeKeywordSpan">indexWait</span>(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
        })
      )
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.indexesOf" id="apidoc.element.thinky.model.prototype.indexesOf">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>indexesOf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexesOf = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.info" id="apidoc.element.thinky.model.prototype.info">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>info
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">info = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  var promise = this.tableReady().then(function() {
return new Promise(function(resolve, reject) {
  return r.branch(
    r.table(tableName).indexList().contains(name),
    r.table(tableName).indexWait(name),
    r.branch(
      r.table(tableName).<span class="apidocCodeKeywordSpan">info</span>()(&#x27;primary_key&#x27;).eq(name),
      r.table(tableName).indexWait(name),
      r.table(tableName).indexCreate(name, fn, opts).do(function() {
        return r.table(tableName).indexWait(name);
      })
    )
  )
  .run()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.innerJoin" id="apidoc.element.thinky.model.prototype.innerJoin">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>innerJoin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">innerJoin = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.insert" id="apidoc.element.thinky.model.prototype.insert">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>insert
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">insert = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var querySaveSelf; // The query to save the document on which `save`/`saveAll` was called.
// We haven&#x27;t validated the document yet, so building the query with `copy`
// may throw an error (for example if a Date has not a valid time).
var buildQuery = function () {
  if (self.__proto__._saved === false) {
    return querySaveSelf = r.table(constructor.getTableName())
      .<span class="apidocCodeKeywordSpan">insert</span>(copy, {returnChanges: &#x27;always&#x27;})
  }
  else {
    if (copy[model._pk] === undefined) {
      throw new Error(&#x22;The document was previously saved, but its primary key is undefined.&#x22;);
    }
    return querySaveSelf = r.table(constructor.getTableName())
      .get(copy[model._pk]).replace(copy, {returnChanges: &#x27;always&#x27;})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.insertAt" id="apidoc.element.thinky.model.prototype.insertAt">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>insertAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">insertAt = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.intersects" id="apidoc.element.thinky.model.prototype.intersects">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>intersects
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">intersects = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.isEmpty" id="apidoc.element.thinky.model.prototype.isEmpty">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>isEmpty
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isEmpty = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.january" id="apidoc.element.thinky.model.prototype.january">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>january
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">january = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.js" id="apidoc.element.thinky.model.prototype.js">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>js
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">js = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.json" id="apidoc.element.thinky.model.prototype.json">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>json
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.july" id="apidoc.element.thinky.model.prototype.july">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>july
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">july = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.june" id="apidoc.element.thinky.model.prototype.june">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>june
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">june = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.keys" id="apidoc.element.thinky.model.prototype.keys">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>keys
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">keys = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      doc = numericDate;
    }
  }
  return new Date(doc); // Use r.ISO8601 and not `new Date()` to keep timezone
}
else if (type.isPoint(schema)) {
  if (util.isPlainObject(doc) &#x26;&#x26; (doc[&#x27;$reql_type$&#x27;] !== &#x22;GEOMETRY&#x22;)) {
    var keys = Object.<span class="apidocCodeKeywordSpan">keys</span>(doc).sort();
    if ((keys.length === 2) &#x26;&#x26; (keys[0] === &#x27;latitude&#x27;) &#x26;&#x26; (keys[1] === &#x27;longitude&#x27;) &#x26
;&#x26; (typeof doc.latitude === &#x22;number&#x22;) &#x26;&#x26; (typeof doc.longitude === &#x22;number&#x22;)) {
      return r.point(doc.longitude, doc.latitude)
    }
    else if ((doc.type === &#x22;Point&#x22;) &#x26;&#x26; (Array.isArray(doc.coordinates)) &#x26;&#x26; (doc.coordinates.length
 === 2)) { // Geojson
      return r.geojson(doc)
    }
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.le" id="apidoc.element.thinky.model.prototype.le">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>le
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">le = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.limit" id="apidoc.element.thinky.model.prototype.limit">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>limit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">limit = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.line" id="apidoc.element.thinky.model.prototype.line">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>line
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">line = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.literal" id="apidoc.element.thinky.model.prototype.literal">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>literal
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">literal = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.lt" id="apidoc.element.thinky.model.prototype.lt">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>lt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lt = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

if ((model.getTableName() === joinedModel.getTableName())
    &#x26;&#x26; (joins[field].leftKey === joins[field].rightKey)) {
  linkValue = self._query(joins[field].leftKey).do(function(leftKey) {
    return link.do(function(rightKey) {
      return r.branch(
          rightKey.<span class="apidocCodeKeywordSpan">lt</span>(leftKey),
          r.object(
            &#x27;id&#x27;, rightKey.add(&#x27;_&#x27;).add(leftKey),
            joins[field].leftKey+&#x22;_&#x22;+joins[field].leftKey, [leftKey, rightKey]
          ),
          r.object(
            &#x27;id&#x27;, leftKey.add(&#x27;_&#x27;).add(rightKey),
            joins[field].leftKey+&#x22;_&#x22;+joins[field].leftKey, [leftKey, rightKey]
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.map" id="apidoc.element.thinky.model.prototype.map">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>map
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">map = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

raw = raw || true;
if (raw === true) {
  return this._getModel()._listeners[eventKey];
}
else {
  return this._getModel()._listeners[eventKey].<span class="apidocCodeKeywordSpan">map</span>(function(fn) {
    return fn.listener;
  });
}
}

Model.prototype.docSetMaxListeners = function(n) {
this._getModel()._maxListeners = n;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.march" id="apidoc.element.thinky.model.prototype.march">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>march
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">march = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.match" id="apidoc.element.thinky.model.prototype.match">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>match
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">match = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * Creates an appropriate error given either an instance of Error or a message
 * from the RethinkDB driver
 */
errors.create = function(errorOrMessage) {
var message = (errorOrMessage instanceof Error) ? errorOrMessage.message : errorOrMessage;
if (message.<span class="apidocCodeKeywordSpan">match</span>(errors.DOCUMENT_NOT_FOUND_REGEX)) {
  return new errors.DocumentNotFound(message);
} else if (message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)) {
  var primaryKey = message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)[1];
  return new errors.DuplicatePrimaryKey(message, primaryKey);
} else if (errorOrMessage instanceof Error) {
  return errorOrMessage;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.max" id="apidoc.element.thinky.model.prototype.max">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>max
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">max = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
options = util.mergeOptions(options, schema.options);
var result;
switch(schema._type) {
  case String:
    result = type.string().options(options).validator(schema.validator).enum(schema.enum);
    if (schema.default !== undefined) { result.default(schema.default); }
    if (typeof schema.min === &#x22;number&#x22;) { result.min(schema.min); }
    if (typeof schema.max === &#x22;number&#x22;) { result.<span class="apidocCodeKeywordSpan">max</span>(schema.max); }
    if (typeof schema.length === &#x22;number&#x22;) { result.length(schema.length); }
    if (schema.alphanum === true) { result.alphanum(); }
    if (schema.lowercase === true) { result.lowercase(); }
    if (schema.uppercase === true) { result.uppercase(); }
    if (typeof schema.regex === &#x22;string&#x22;) { result.regex(regex, schema.flags); }
    return result;
  case Number:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.maxval" id="apidoc.element.thinky.model.prototype.maxval">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>maxval
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">maxval = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.may" id="apidoc.element.thinky.model.prototype.may">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>may
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">may = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.merge" id="apidoc.element.thinky.model.prototype.merge">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>merge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merge = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  gotModel[model.getTableName()] = true;

  util.loopKeys(joins, function(joins, key) {
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.<span class="apidocCodeKeywordSpan">merge</span>(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#
x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.min" id="apidoc.element.thinky.model.prototype.min">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>min
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">min = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  content: String,
  idAuthor: String
});

// You can also add constraints on the schema
var Author = thinky.createModel(&#x22;Author&#x22;, {
  id: type.string(),      // a normal string
  name: type.string().<span class="apidocCodeKeywordSpan">min</span>(2),  // a string of at least two characters
  email: type.string().email()  // a string that is a valid email
});

// Join the models
Post.belongsTo(Author, &#x22;author&#x22;, &#x22;idAuthor&#x22;, &#x22;id&#x22;);
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.minutes" id="apidoc.element.thinky.model.prototype.minutes">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>minutes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">minutes = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.minval" id="apidoc.element.thinky.model.prototype.minval">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>minval
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">minval = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.mod" id="apidoc.element.thinky.model.prototype.mod">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>mod
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mod = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.monday" id="apidoc.element.thinky.model.prototype.monday">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>monday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">monday = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.month" id="apidoc.element.thinky.model.prototype.month">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>month
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">month = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.mul" id="apidoc.element.thinky.model.prototype.mul">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>mul
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mul = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.ne" id="apidoc.element.thinky.model.prototype.ne">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ne
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ne = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.not" id="apidoc.element.thinky.model.prototype.not">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>not
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">not = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.november" id="apidoc.element.thinky.model.prototype.november">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>november
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">november = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.now" id="apidoc.element.thinky.model.prototype.now">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>now
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">now = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.nth" id="apidoc.element.thinky.model.prototype.nth">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>nth
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">nth = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.merge(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#
x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.<span class="apidocCodeKeywordSpan">nth</span>(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
return r.branch(
  result.count().eq(1),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.object" id="apidoc.element.thinky.model.prototype.object">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>object
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">object = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
    innerQuery = modelToGet[key]._apply(innerQuery);
  }
  innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
  return r.branch(
    result.count().eq(1),
    r.<span class="apidocCodeKeywordSpan">object</span>(key, innerQuery),
    r.branch(
      result.count().eq(0),
      {},
      r.error(r.expr(&#x22;More than one element found for &#x22;).add(doc.coerceTo(&#x22;STRING&#x22;)).add(r.expr(&#x22;for the
 field &#x22;).add(key)))
    )
  )
}),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.october" id="apidoc.element.thinky.model.prototype.october">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>october
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">october = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.offsetsOf" id="apidoc.element.thinky.model.prototype.offsetsOf">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>offsetsOf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">offsetsOf = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.or" id="apidoc.element.thinky.model.prototype.or">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>or
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">or = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.orderBy" id="apidoc.element.thinky.model.prototype.orderBy">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>orderBy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">orderBy = function () {
  var query = new Query(this);
  if ((arguments.length === 1)
    &#x26;&#x26; (typeof arguments[0] === &#x27;string&#x27;)
    &#x26;&#x26; (this._getModel()._indexes[arguments[0]] === true)) {

      query = query[key]({index: arguments[0]});
      return query;
  }
  else {
    query = query[key].apply(query, arguments);
    return query;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.outerJoin" id="apidoc.element.thinky.model.prototype.outerJoin">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>outerJoin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">outerJoin = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.pluck" id="apidoc.element.thinky.model.prototype.pluck">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>pluck
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pluck = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.point" id="apidoc.element.thinky.model.prototype.point">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>point
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">point = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
  return new Date(doc); // Use r.ISO8601 and not `new Date()` to keep timezone
}
else if (type.isPoint(schema)) {
  if (util.isPlainObject(doc) &#x26;&#x26; (doc[&#x27;$reql_type$&#x27;] !== &#x22;GEOMETRY&#x22;)) {
    var keys = Object.keys(doc).sort();
    if ((keys.length === 2) &#x26;&#x26; (keys[0] === &#x27;latitude&#x27;) &#x26;&#x26; (keys[1] === &#x27;longitude&#x27;) &#x26
;&#x26; (typeof doc.latitude === &#x22;number&#x22;) &#x26;&#x26; (typeof doc.longitude === &#x22;number&#x22;)) {
      return r.<span class="apidocCodeKeywordSpan">point</span>(doc.longitude, doc.latitude)
    }
    else if ((doc.type === &#x22;Point&#x22;) &#x26;&#x26; (Array.isArray(doc.coordinates)) &#x26;&#x26; (doc.coordinates.length
 === 2)) { // Geojson
      return r.geojson(doc)
    }
  }
  else if (Array.isArray(doc)) {
    if ((doc.length === 2) &#x26;&#x26; (typeof doc[0] === &#x22;number&#x22;) &#x26;&#x26; (typeof doc[1] === &#x22;number&#x22
;)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.polygon" id="apidoc.element.thinky.model.prototype.polygon">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>polygon
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">polygon = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.polygonSub" id="apidoc.element.thinky.model.prototype.polygonSub">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>polygonSub
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">polygonSub = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.post" id="apidoc.element.thinky.model.prototype.post">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>post
        <span class="apidocSignatureSpan">(ev, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">post = function (ev, fn) {
  if (typeof fn !== &#x22;function&#x22;) {
    throw new Error(&#x22;Second argument to `pre` must be a function&#x22;);
  }
  if (fn.length &#x3e; 1) {
    throw new Error(&#x22;Second argument to `pre` must be a function with at most one argument.&#x22;);
  }
  if (Array.isArray(this._post[ev]) === false) {
    throw new Error(&#x22;No post-hook available for the event `&#x22;+ev+&#x22;`.&#x22;)
  }
  this._getModel()._async[ev] = this._getModel()._async[ev] || (fn.length === 1)
  this._getModel()._post[ev].push(fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.pre" id="apidoc.element.thinky.model.prototype.pre">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>pre
        <span class="apidocSignatureSpan">(ev, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pre = function (ev, fn) {
  if (typeof fn !== &#x22;function&#x22;) {
    throw new Error(&#x22;Second argument to `pre` must be a function&#x22;);
  }
  if (fn.length &#x3e; 1) {
    throw new Error(&#x22;Second argument to `pre` must be a function with at most one argument.&#x22;);
  }
  if (Array.isArray(this._pre[ev]) === false) {
    throw new Error(&#x22;No pre-hook available for the event `&#x22;+ev+&#x22;`.&#x22;)
  }
  this._getModel()._async[ev] = this._getModel()._async[ev] || (fn.length === 1)
  this._getModel()._pre[ev].push(fn);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.prepend" id="apidoc.element.thinky.model.prototype.prepend">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>prepend
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepend = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.random" id="apidoc.element.thinky.model.prototype.random">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>random
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">random = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.range" id="apidoc.element.thinky.model.prototype.range">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>range
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">range = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.ready" id="apidoc.element.thinky.model.prototype.ready">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ready
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ready = function () {
  var requirements = [];

  // Ensure the Model&#x27;s table is ready
  requirements.push(this.tableReady());

  // Ensure all other pending promises have been resolved
  requirements.push(this._promisesReady());

  return Promise.all(requirements);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {Function} executeInsert the method that will execute the batch insert
 * @return {Promise}
 */
Document.prototype._batchSaveSelf = function(executeInsert) {
  var self = this;

  return new Promise(function(resolve, reject) {
    self.getModel().<span class="apidocCodeKeywordSpan">ready</span>().then(function() {
      executeInsert(resolve, reject)
    });
  })
}


/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.rebalance" id="apidoc.element.thinky.model.prototype.rebalance">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>rebalance
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rebalance = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.reconfigure" id="apidoc.element.thinky.model.prototype.reconfigure">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>reconfigure
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reconfigure = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.reduce" id="apidoc.element.thinky.model.prototype.reduce">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>reduce
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reduce = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.removeRelations" id="apidoc.element.thinky.model.prototype.removeRelations">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>removeRelations
        <span class="apidocSignatureSpan">(relationsToRemove)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeRelations = function (relationsToRemove) {
  var query = new Query(this);
  return query.removeRelations(relationsToRemove);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Model.prototype.getJoin = function() {
  var query = new Query(this);
  return query.getJoin.apply(query, arguments)
}

Model.prototype.removeRelations = function(relationsToRemove) {
  var query = new Query(this);
  return query.<span class="apidocCodeKeywordSpan">removeRelations</span>(relationsToRemove);
}


Model.prototype.run = function(options) {
  var query = new Query(this);
  return query.run(options);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.replace" id="apidoc.element.thinky.model.prototype.replace">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>replace
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replace = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      .insert(copy, {returnChanges: &#x27;always&#x27;})
  }
  else {
    if (copy[model._pk] === undefined) {
      throw new Error(&#x22;The document was previously saved, but its primary key is undefined.&#x22;);
    }
    return querySaveSelf = r.table(constructor.getTableName())
      .get(copy[model._pk]).<span class="apidocCodeKeywordSpan">replace</span>(copy, {returnChanges: &#x27;always&#x27;})
  }
}

self.getModel().ready().then(function() {
  util.tryCatch(function() {
    // Validate the document before saving it
    var promise = self.validate();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.round" id="apidoc.element.thinky.model.prototype.round">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>round
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">round = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.row" id="apidoc.element.thinky.model.prototype.row">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>row
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">row = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.run" id="apidoc.element.thinky.model.prototype.run">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>run
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options) {
  var query = new Query(this);
  return query.run(options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
});
```

Retrieve the post with its author.

```js
Post.get(&#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;).getJoin().<span class="apidocCodeKeywordSpan">run</span>().then(function
(result) {
/*
result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.sample" id="apidoc.element.thinky.model.prototype.sample">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sample
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sample = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.saturday" id="apidoc.element.thinky.model.prototype.saturday">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>saturday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">saturday = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.save" id="apidoc.element.thinky.model.prototype.save">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>save
        <span class="apidocSignatureSpan">(docs, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">save = function (docs, options) {
  var self = this;
  var r = self._getModel()._thinky.r;
  var isArray = Array.isArray(docs);

  if (!isArray) {
    docs = [docs];
  }

  var p = new Promise(function(mainResolve, mainReject) {
    var toSave = docs.length;

    var resolves = [];
    var rejects = [];
    var executeInsert = function (resolve, reject) {
      toSave--;
      resolves.push(resolve);
      rejects.push(reject);

      if (toSave === 0) {
        var copies = [];
        for(var i=0; i&#x3c;docs.length; i++) {
          copies.push(docs[i]._makeSavableCopy());
        }
        var _options;
        if (util.isPlainObject(options)) {
          _options = util.deepCopy(options);
        }
        else {
          _options = {};
        }
        _options.returnChanges = &#x27;always&#x27;;
        r.table(self.getTableName()).insert(copies, _options).run().then(function(results) {
          if (results.errors === 0) {
            // results.changes currently does not enforce the same order as docs
            if (Array.isArray(results.changes)) {
              for(var i=0; i&#x3c;results.changes.length; i++) {
                docs[i]._merge(results.changes[i].new_val);
                if (docs[i]._getModel().needToGenerateFields === true) {
                  docs[i]._generateDefault();
                }
                docs[i]._setOldValue(util.deepCopy(results.changes[i].old_val));
                docs[i].setSaved();
                docs[i].emit(&#x27;saved&#x27;, docs[i]);
              }
            }
            for(i=0; i&#x3c;resolves.length; i++) {
              resolves[i]();
            }
          }
          else {
            //TODO Expand error with more information
            for(var i=0; i&#x3c;rejects.length; i++) {
              rejects[i](new Error(&#x22;An error occurred during the batch insert. Original results:\n&#x22;+JSON.stringify(results, null
, 2)));
            }
          }
        }).error(reject);
      }
    };

    var promises = [];
    var foundNonValidDoc = false;
    for(var i=0; i&#x3c;docs.length; i++) {
      if (foundNonValidDoc === true) {
        return;
      }
      if (docs[i] instanceof Document === false) {
        docs[i] = new self(docs[i]);
      }
      var promise;
      util.tryCatch(function() {
        promise = docs[i].validate();
        if (promise instanceof Promise) {
          promises.push(promise)
        }
      }, function(error) {
        foundNonValidDoc = true;
        mainReject(new Errors.ValidationError(&#x22;One of the documents is not valid. Original error:\n&#x22;+error.message))
      });
    }

    if (foundNonValidDoc === false) {
      Promise.all(promises).then(function() {
        var promises = [];
        for(var i=0; i&#x3c;docs.length; i++) {
          promises.push(docs[i]._batchSave(executeInsert));
        }
        Promise.all(promises).then(function() {
          mainResolve(docs);
        }).error(function(error) {
          mainReject(error)
        });
      }).error(function(error) {
        mainReject(new Errors.ValidationError(&#x22;One of the documents is not valid. Original error:\n&#x22;+error.message))
      });
    }
  })

  if (!isArray) {
    return p.get(0);
  }

  return p;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        }).error(reject);
      }))
    })(key);
  }
  else if ((deleteSelf === true) &#x26;&#x26; (deletedDocs.indexOf(self[key]) === -1)) {
    delete self[key][joins[key].rightKey];
    if (self[key].isSaved() === true) {
      promises.push(self[key].<span class="apidocCodeKeywordSpan">save</span>({}, false, {}, true, false));
    }
  }
}
if ((joins[key].type === &#x27;belongsTo&#x27;) &#x26;&#x26; (self[key] instanceof Document)) {
  if ((self[key].isSaved() === true) &#x26;&#x26;
    ((key in docToDelete) || ((deleteAll === true) &#x26;&#x26; (deletedDocs.indexOf(self[key]) === -1)))) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.seconds" id="apidoc.element.thinky.model.prototype.seconds">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>seconds
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">seconds = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.september" id="apidoc.element.thinky.model.prototype.september">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>september
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">september = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.setDifference" id="apidoc.element.thinky.model.prototype.setDifference">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setDifference
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setDifference = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.setInsert" id="apidoc.element.thinky.model.prototype.setInsert">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setInsert
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setInsert = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.setIntersection" id="apidoc.element.thinky.model.prototype.setIntersection">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setIntersection
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setIntersection = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.setUnion" id="apidoc.element.thinky.model.prototype.setUnion">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>setUnion
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setUnion = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.skip" id="apidoc.element.thinky.model.prototype.skip">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>skip
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">skip = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.slice" id="apidoc.element.thinky.model.prototype.slice">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>slice
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">slice = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return;
  }
  else {
    for(var k=0; k&#x3c;field.length; k++) {
      if (virtual != null) {
        virtualValue = virtual[k];
      }
      generateVirtual(field[k], {path: defaultField.path.<span class="apidocCodeKeywordSpan">slice</span>(j+1), value: defaultField
.value}, this, virtualValue);
    }
  }
  keepGoing = false;
}
else {
  // field cannot be undefined (doc is not undefined on the first iteration, and we&#x27;ll return if it becomes undefined
  field = field[path[j]];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.spliceAt" id="apidoc.element.thinky.model.prototype.spliceAt">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>spliceAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">spliceAt = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.split" id="apidoc.element.thinky.model.prototype.split">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>split
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">split = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.status" id="apidoc.element.thinky.model.prototype.status">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>status
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">status = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.sub" id="apidoc.element.thinky.model.prototype.sub">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sub
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sub = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.sum" id="apidoc.element.thinky.model.prototype.sum">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sum
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sum = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.sunday" id="apidoc.element.thinky.model.prototype.sunday">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sunday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sunday = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.sync" id="apidoc.element.thinky.model.prototype.sync">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>sync
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sync = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.table" id="apidoc.element.thinky.model.prototype.table">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>table
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">table = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

var querySaveSelf; // The query to save the document on which `save`/`saveAll` was called.
// We haven&#x27;t validated the document yet, so building the query with `copy`
// may throw an error (for example if a Date has not a valid time).
var buildQuery = function () {
  if (self.__proto__._saved === false) {
    return querySaveSelf = r.<span class="apidocCodeKeywordSpan">table</span>(constructor.getTableName())
      .insert(copy, {returnChanges: &#x27;always&#x27;})
  }
  else {
    if (copy[model._pk] === undefined) {
      throw new Error(&#x22;The document was previously saved, but its primary key is undefined.&#x22;);
    }
    return querySaveSelf = r.table(constructor.getTableName())
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.tableCreate" id="apidoc.element.thinky.model.prototype.tableCreate">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableCreate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tableCreate = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (!this._initModel) return Promise.resolve();
if (this._tableReadyPromise) return this._tableReadyPromise;

// Create the table, or push the table name in the queue.
var r = model._thinky.r;
this._tableReadyPromise = model._thinky.dbReady()
.then(function() {
  return r.<span class="apidocCodeKeywordSpan">tableCreate</span>(model._name, model._table).run();
})
.error(function(error) {
  if (error.message.match(/Table `.*` already exists/)) {
    return;
  }
  model._error = error;
  // Should we throw here?
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.tableDrop" id="apidoc.element.thinky.model.prototype.tableDrop">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableDrop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tableDrop = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.tableList" id="apidoc.element.thinky.model.prototype.tableList">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableList
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tableList = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.tableReady" id="apidoc.element.thinky.model.prototype.tableReady">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tableReady
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tableReady = function () {
  var self = this;
  var model = this._getModel();
  if (!this._initModel) return Promise.resolve();
  if (this._tableReadyPromise) return this._tableReadyPromise;

  // Create the table, or push the table name in the queue.
  var r = model._thinky.r;
  this._tableReadyPromise = model._thinky.dbReady()
  .then(function() {
    return r.tableCreate(model._name, model._table).run();
  })
  .error(function(error) {
    if (error.message.match(/Table `.*` already exists/)) {
      return;
    }
    model._error = error;
    // Should we throw here?
  });

  return this._tableReadyPromise.then(function() {
    self.emit(&#x27;created&#x27;);
    if (!self._pendingPromises.length) {
      self.emit(&#x27;ready&#x27;);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return doc;
}

model.__proto__ = proto;

if (options.init !== false) {
  // Setup the model&#x27;s table.
  model.<span class="apidocCodeKeywordSpan">tableReady</span>().then();
}
else {
  // We do not initialize the table and suppose that it already exists and
  // is ready.
  model.emit(&#x27;created&#x27;);
  model.emit(&#x27;ready&#x27;);
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.then" id="apidoc.element.thinky.model.prototype.then">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>then
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">then = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
email: &#x22;orphee@gmail.com&#x22;
});

// Join the documents
post.author = author;


post.saveAll().<span class="apidocCodeKeywordSpan">then</span>(function(result) {
/*
post = result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.thursday" id="apidoc.element.thinky.model.prototype.thursday">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>thursday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thursday = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.time" id="apidoc.element.thinky.model.prototype.time">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>time
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">time = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.timeOfDay" id="apidoc.element.thinky.model.prototype.timeOfDay">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>timeOfDay
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timeOfDay = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.timezone" id="apidoc.element.thinky.model.prototype.timezone">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>timezone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timezone = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.toEpochTime" id="apidoc.element.thinky.model.prototype.toEpochTime">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toEpochTime
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toEpochTime = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.toGeojson" id="apidoc.element.thinky.model.prototype.toGeojson">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toGeojson
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toGeojson = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.toISO8601" id="apidoc.element.thinky.model.prototype.toISO8601">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toISO8601
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toISO8601 = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.toJSON" id="apidoc.element.thinky.model.prototype.toJSON">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toJSON
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toJSON = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.toJsonString" id="apidoc.element.thinky.model.prototype.toJsonString">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toJsonString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toJsonString = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.toStream" id="apidoc.element.thinky.model.prototype.toStream">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toStream
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toStream = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.toString" id="apidoc.element.thinky.model.prototype.toString">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * Convert the query to its string representation.
 * @return {string}
 */
Query.prototype.toString = function() {
  return this._query.<span class="apidocCodeKeywordSpan">toString</span>();
}

module.exports = Query;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.tuesday" id="apidoc.element.thinky.model.prototype.tuesday">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>tuesday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tuesday = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.typeOf" id="apidoc.element.thinky.model.prototype.typeOf">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>typeOf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">typeOf = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.ungroup" id="apidoc.element.thinky.model.prototype.ungroup">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>ungroup
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ungroup = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.union" id="apidoc.element.thinky.model.prototype.union">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>union
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">union = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.upcase" id="apidoc.element.thinky.model.prototype.upcase">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>upcase
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upcase = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.update" id="apidoc.element.thinky.model.prototype.update">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>update
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (joinedDocument[joinedModel._pk] === undefined) {
    return new Query(model, self, {},
        new Error(&#x27;Primary key for the joined document not found for a `hasOne/hasMany` relation.&#x27;)
    );
  }
  var updateValue = {};
  updateValue[joins[field].rightKey] = self._query(joins[field].leftKey);
  return joinedModel.get(joinedDocument[joinedModel._pk]).<span class="apidocCodeKeywordSpan">update</span>(updateValue, {nonAtomic
: true}).run()
case &#x27;belongsTo&#x27;:
  var updateValue = {};
  if (joinedDocument[joins[field].rightKey] === undefined) {
    if (joinedDocument[joinedModel._pk] === undefined) {
      return new Query(model, self, {},
          new Error(&#x27;The primary key or the joined key must be defined in the joined document for a `belongsTo` relation.&#
x27;)
      );
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.uuid" id="apidoc.element.thinky.model.prototype.uuid">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>uuid
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uuid = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.values" id="apidoc.element.thinky.model.prototype.values">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>values
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">values = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.wait" id="apidoc.element.thinky.model.prototype.wait">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>wait
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wait = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.wednesday" id="apidoc.element.thinky.model.prototype.wednesday">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>wednesday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wednesday = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.withFields" id="apidoc.element.thinky.model.prototype.withFields">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>withFields
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">withFields = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.without" id="apidoc.element.thinky.model.prototype.without">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>without
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">without = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var promises = [];
  util.loopKeys(self._getModel()._joins, function(joins, field) {
var join = joins[field];
var joinedModel = join.model;

if ((join.type === &#x27;hasOne&#x27;) || (join.type === &#x27;hasMany&#x27;)) {
  promises.push(r.table(joinedModel.getTableName()).getAll(self[join.leftKey], {index: join.rightKey}).replace(function(doc) {
    return doc.<span class="apidocCodeKeywordSpan">without</span>(join.rightKey)
  }).run())
}
// nothing to do for &#x22;belongsTo&#x22;
else if (join.type === &#x27;hasAndBelongsToMany&#x27;) {
  if (self.getModel()._getModel()._pk === join.leftKey) {
    // [1]
    promises.push(r.table(join.link).getAll(self[join.leftKey], {index: self.getModel().getTableName()+&#x22;_&#x22;+join.leftKey
}).delete().run())
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.year" id="apidoc.element.thinky.model.prototype.year">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>year
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">year = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.model.prototype.zip" id="apidoc.element.thinky.model.prototype.zip">
        function <span class="apidocSignatureSpan">thinky.model.prototype.</span>zip
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">zip = function () {
  var query = new Query(this);
  query = query[key].apply(query, arguments);
  return query;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.query" id="apidoc.module.thinky.query">module thinky.query</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.query.query" id="apidoc.element.thinky.query.query">
        function <span class="apidocSignatureSpan">thinky.</span>query
        <span class="apidocSignatureSpan">(model, query, options, error)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Query(model, query, options, error) {
  var self = this;

  this._model = model; // constructor of the model we should use for the results.
  if (model !== undefined) {
    this._r = model._getModel()._thinky.r;
    util.loopKeys(model._getModel()._staticMethods, function(staticMethods, key) {
      (function(_key) {
        self[_key] = function() {
          return staticMethods[_key].apply(self, arguments);
        };
      })(key);
    });
  }

  if (query !== undefined) {
    this._query = query;
   }
  else if (model !== undefined) {
    // By default, we initialize the query to `r.table(&#x3c;tableName&#x3e;)`.
    this._query = this._r.table(model.getTableName());
  }

  if (util.isPlainObject(options)) {
    if (options.postValidation) {
      this._postValidation = options.postValidation === true;
    }
    if (options.ungroup) {
      this._ungroup = options.ungroup === true;
    }
    else {
      this._ungroup = false;
    }
  }
  else { // let the user rework the result after ungroup
    this._ungroup = false;
  }
  if (error) {
    // Note `Query.prototype.error` is defined because of `r.error`, so we shouldn&#x27;t
    // defined this.error.
    this._error = error;
  }
  this._pointWrite = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.query.prototype" id="apidoc.module.thinky.query.prototype">module thinky.query.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.query.prototype.ISO8601" id="apidoc.element.thinky.query.prototype.ISO8601">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ISO8601
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ISO8601 = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype._convertGroupedData" id="apidoc.element.thinky.query.prototype._convertGroupedData">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_convertGroupedData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_convertGroupedData = function (data) {
  if (util.isPlainObject(data) &#x26;&#x26; (data.$reql_type$ === &#x22;GROUPED_DATA&#x22;)) {
    var result = [];
    var reduction;
    for(var i=0; i&#x3c;data.data.length; i++) {
      result.push({
        group: data.data[i][0],
        reduction: data.data[i][1]
      });
    }
    return result;
  }
  else {
    return data;
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }

    if (parse === true) {
      return self._model._parse(result, self._ungroup);
    }

    if (groupFormat !== &#x27;raw&#x27;) {
      return Query.prototype.<span class="apidocCodeKeywordSpan">_convertGroupedData</span>(result);
    }

    return result;
  }).catch(function(err) {
    return Promise.reject(Errors.create(err));
  })
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype._execute" id="apidoc.element.thinky.query.prototype._execute">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_execute
        <span class="apidocSignatureSpan">(options, parse)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_execute = function (options, parse) {
  var self = this;
  options = options || {};
  var fullOptions = {groupFormat: &#x27;raw&#x27;}
  util.loopKeys(options, function(options, key) {
    fullOptions[key] = options[key]
  });
  if (parse === true) {
    fullOptions.cursor = false;
  }

  if (self._model._error !== null) {
    return Promise.reject(self._model._error);
  }
  return self._model.ready().then(function() {
    return self._executeCallback(fullOptions, parse, options.groupFormat);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* asynchronous hooks).
*/
Query.prototype.run = function(options, callback) {
 if (typeof options === &#x27;function&#x27;) {
   callback = options;
   options = {};
 }
 return this.<span class="apidocCodeKeywordSpan">_execute</span>(options, true).nodeify(callback);
}


/**
* Execute a Query
* @param {Object=} options The options passed to the driver&#x27;s method `run`
* @param {Function=} callback
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype._executeCallback" id="apidoc.element.thinky.query.prototype._executeCallback">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_executeCallback
        <span class="apidocSignatureSpan">(fullOptions, parse, groupFormat)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_executeCallback = function (fullOptions, parse, groupFormat) {
  var self = this;
  if (self._error !== undefined) {
    return Promise.reject(new Error(&#x22;The partial value is not valid, so the write was not executed. The original error was:\n&#x22;+self
._error.message));
  }

  return self._query.run(fullOptions).then(function(result) {
    if (result === null &#x26;&#x26; parse) {
      throw new Errors.DocumentNotFound();
    }

    // Expect a write result from RethinkDB
    if (self._postValidation === true) {
      return self._validateQueryResult(result);
    }

    if (result != null &#x26;&#x26; typeof result.getType === &#x27;function&#x27;) {
      var resultType = result.getType();
      if (resultType === &#x27;Feed&#x27; ||
        resultType === &#x27;OrderByLimitFeed&#x27; ||
        resultType === &#x27;UnionedFeed&#x27;
      ) {
        var feed = new Feed(result, self._model);
        return feed;
      }

      if (resultType === &#x27;AtomFeed&#x27;) {
        return result.next().then(function(initial) {
          var value = initial.new_val || {};
          return self._model._parse(value).then(function(doc) {
            doc._setFeed(result);
            return doc;
          });
        });
      }
    }

    if (parse === true) {
      return self._model._parse(result, self._ungroup);
    }

    if (groupFormat !== &#x27;raw&#x27;) {
      return Query.prototype._convertGroupedData(result);
    }

    return result;
  }).catch(function(err) {
    return Promise.reject(Errors.create(err));
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  fullOptions.cursor = false;
}

if (self._model._error !== null) {
  return Promise.reject(self._model._error);
}
return self._model.ready().then(function() {
  return self.<span class="apidocCodeKeywordSpan">_executeCallback</span>(fullOptions, parse, options.groupFormat);
});
}

Query.prototype._executeCallback = function(fullOptions, parse, groupFormat) {
var self = this;
if (self._error !== undefined) {
  return Promise.reject(new Error(&#x22;The partial value is not valid, so the write was not executed. The original error was:\n
&#x22;+self._error.message));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype._get" id="apidoc.element.thinky.query.prototype._get">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_get
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_get = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype._isPointWrite" id="apidoc.element.thinky.query.prototype._isPointWrite">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_isPointWrite
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_isPointWrite = function () {
  return this._pointWrite || (Array.isArray(this._query._query) &#x26;&#x26;
      (this._query._query.length &#x3e; 1) &#x26;&#x26;
      Array.isArray(this._query._query[1]) &#x26;&#x26;
      (this._query._query[1].length &#x3e; 0) &#x26;&#x26;
      Array.isArray(this._query._query[1][0]) &#x26;&#x26;
      (this._query._query[1][0].length &#x3e; 1) &#x26;&#x26;
      Array.isArray(this._query._query[1][0][1]) &#x26;&#x26;
      (this._query._query[1][0][1].length &#x3e; 0) &#x26;&#x26;
      Array.isArray(this._query._query[1][0][1][0]) &#x26;&#x26;
      (this._query._query[1][0][1][0][0] === 16))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Query.prototype._validateQueryResult = function(result) {
var self = this;
if (result.errors &#x3e; 0) {
  console.log(result);
  return Promise.reject(new Errors.InvalidWrite(&#x22;An error occured during the write&#x22;, result));
}
if (!Array.isArray(result.changes)) {
  if (self.<span class="apidocCodeKeywordSpan">_isPointWrite</span>()) {
    return Promise.resolve();
  }
  return Promise.resolve([]);
}

var promises = [];
for(var i=0; i&#x3c;result.changes.length; i++) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype._validateQueryResult" id="apidoc.element.thinky.query.prototype._validateQueryResult">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_validateQueryResult
        <span class="apidocSignatureSpan">(result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_validateQueryResult = function (result) {
  var self = this;
  if (result.errors &#x3e; 0) {
    console.log(result);
    return Promise.reject(new Errors.InvalidWrite(&#x22;An error occured during the write&#x22;, result));
  }
  if (!Array.isArray(result.changes)) {
    if (self._isPointWrite()) {
      return Promise.resolve();
    }
    return Promise.resolve([]);
  }

  var promises = [];
  for(var i=0; i&#x3c;result.changes.length; i++) {
    (function(i) {
      if (result.changes[i].new_val !== null) {
        promises.push(self._model._parse(result.changes[i].new_val));
      }
    })(i)
  }
  return Promise.all(promises).then(function(result) {
    if (self._isPointWrite()) {
      if (result.length &#x3e; 1) {
        throw new Error(&#x27;A point write returned multiple values&#x27;)
      }
      return result[0];
    }
    return result;
  }).catch(function(error) {
    if (error instanceof Errors.DocumentNotFound) {
      // Should we send back null?
    }
    else {
      var revertPromises = [];
      var primaryKeys = [];
      var keysToValues = {};
      var r = self._model._thinky.r;
      for(var p=0; p&#x3c;result.changes.length; p++) {
        // Extract the primary key of the document saved in the database
        var primaryKey = util.extractPrimaryKey(
            result.changes[p].old_val,
            result.changes[p].new_val,
            self._model._pk)
        if (primaryKey === undefined) {
          continue;
        }

        if (typeof primaryKey === &#x22;string&#x22;) {
          keysToValues[primaryKey] = result.changes[p].old_val;
          primaryKeys.push(primaryKey);
        }
        else {
          // Replace documents with non-string type primary keys
          // one by one.
          revertPromises.push(r.table(self._model.getTableName())
            .get(primaryKey)
            .replace(result.changes[p].old_val)
            .run());
        }
      }

      // Replace all documents with string-type primary keys
      // in a single replace() operation.
      if (primaryKeys.length) {
        revertPromises.push(
          r.table(self._model.getTableName()).getAll(r.args(primaryKeys)).replace(function(doc) {
            return r.expr(keysToValues)(doc(self._model._pk));
          }).run()
        );
      }

      return Promise.all(revertPromises).then(function(result) {
        throw new Error(&#x22;The write failed, and the changes were reverted.&#x22;);
      }).error(function(error) {
        throw new Error(&#x22;The write failed, and the attempt to revert the changes failed with the error:\n&#x22;+error.message);
      });
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return self._query.run(fullOptions).then(function(result) {
if (result === null &#x26;&#x26; parse) {
  throw new Errors.DocumentNotFound();
}

// Expect a write result from RethinkDB
if (self._postValidation === true) {
  return self.<span class="apidocCodeKeywordSpan">_validateQueryResult</span>(result);
}

if (result != null &#x26;&#x26; typeof result.getType === &#x27;function&#x27;) {
  var resultType = result.getType();
  if (resultType === &#x27;Feed&#x27; ||
    resultType === &#x27;OrderByLimitFeed&#x27; ||
    resultType === &#x27;UnionedFeed&#x27;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype._validateUngroupResult" id="apidoc.element.thinky.query.prototype._validateUngroupResult">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>_validateUngroupResult
        <span class="apidocSignatureSpan">(result)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_validateUngroupResult = function (result) {
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.add" id="apidoc.element.thinky.query.prototype.add">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>add
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">add = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
      return r.branch(
        result.count().eq(1),
        r.object(key, innerQuery),
        r.branch(
          result.count().eq(0),
          {},
          r.error(r.expr(&#x22;More than one element found for &#x22;).<span class="apidocCodeKeywordSpan">add</span>(doc.coerceTo
(&#x22;STRING&#x22;)).add(r.expr(&#x22;for the field &#x22;).add(key)))
        )
      )
    }),
    {}
  )
});
break;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.addRelation" id="apidoc.element.thinky.query.prototype.addRelation">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>addRelation
        <span class="apidocSignatureSpan">(field, joinedDocument)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addRelation = function (field, joinedDocument) {
  var self = this;
  var model = self._model;
  var joins = self._model._getModel()._joins;
  var joinedModel = joins[field].model;
  var r = self._model._thinky.r;

  switch (joins[field].type) {
    case &#x27;hasOne&#x27;:
    case &#x27;hasMany&#x27;:
      if (joinedDocument[joinedModel._pk] === undefined) {
        return new Query(model, self, {},
            new Error(&#x27;Primary key for the joined document not found for a `hasOne/hasMany` relation.&#x27;)
        );
      }
      var updateValue = {};
      updateValue[joins[field].rightKey] = self._query(joins[field].leftKey);
      return joinedModel.get(joinedDocument[joinedModel._pk]).update(updateValue, {nonAtomic: true}).run()
    case &#x27;belongsTo&#x27;:
      var updateValue = {};
      if (joinedDocument[joins[field].rightKey] === undefined) {
        if (joinedDocument[joinedModel._pk] === undefined) {
          return new Query(model, self, {},
              new Error(&#x27;The primary key or the joined key must be defined in the joined document for a `belongsTo` relation.&#x27;)
          );
        }
        updateValue[joins[field].leftKey] = joinedModel.get(joinedDocument[joinedModel._pk]).bracket(joins[field].rightKey)._query
;
      }
      else {
        updateValue[joins[field].leftKey] = joinedDocument[joins[field].rightKey];
      }
      return self.update(updateValue, {nonAtomic: true}).run();
    case &#x27;hasAndBelongsToMany&#x27;:
      var linkModel = joins[field].linkModel;
      var linkValue;
      var link;
      if (joinedDocument[joins[field].rightKey] === undefined) {
        if (joinedDocument[joinedModel._pk] === undefined) {
          return new Query(model, self, {},
              new Error(&#x27;The primary key or the joined key must be defined in the joined document for a `hasAndBelongsToMany` relation
.&#x27;)
          );
        }
        link = joinedModel.get(joinedDocument[joinedModel._pk]).bracket(joins[field].rightKey)._query
      }
      else {
        link = r.expr(joinedDocument[joins[field].rightKey]);
      }

      if ((model.getTableName() === joinedModel.getTableName())
          &#x26;&#x26; (joins[field].leftKey === joins[field].rightKey)) {
        linkValue = self._query(joins[field].leftKey).do(function(leftKey) {
          return link.do(function(rightKey) {
            return r.branch(
                rightKey.lt(leftKey),
                r.object(
                  &#x27;id&#x27;, rightKey.add(&#x27;_&#x27;).add(leftKey),
                  joins[field].leftKey+&#x22;_&#x22;+joins[field].leftKey, [leftKey, rightKey]
                ),
                r.object(
                  &#x27;id&#x27;, leftKey.add(&#x27;_&#x27;).add(rightKey),
                  joins[field].leftKey+&#x22;_&#x22;+joins[field].leftKey, [leftKey, rightKey]
                )
            )
          });
        });
      }
      else {
        linkValue = self._query(joins[field].leftKey).do(function(leftKey) {
          return link.do(function(rightKey) {
            if (model.getTableName() &#x3c; joinedModel.getTableName()) {
              return r.object(
                &#x27;id&#x27;, leftKey.add(&#x27;_&#x27;).add(rightKey),
                model.getTableName()+&#x22;_&#x22;+joins[field].leftKey, leftKey,
                joinedModel.getTableName()+&#x22;_&#x22;+joins[field].rightKey,rightKey
              )
            }
            else if (model.getTableName() &#x3e; joinedModel.getTableName()) {
              return r.object(
                &#x27;id&#x27;, rightKey.add(&#x27;_&#x27;).add(leftKey),
                model.getTableName()+&#x22;_&#x22;+joins[field].leftKey, leftKey,
                joinedModel.getTableName()+&#x22;_&#x22;+joins[field].rightKey,rightKey
              )
            }
            else {
              return r.branch(
                rightKey.lt(leftKey),
                r.object(
                  &#x27;id&#x27;, leftKey.add(&#x27;_&#x27;).add(rightKey),
                  model.getTableName()+&#x22;_&#x22;+joins[field].leftKey, leftKey,
                  joinedModel.getTableName()+&#x22;_&#x22;+joins[field].rightKey,rightKey
                ),
                r.object(
                  &#x27;id&#x27;, rightKey.add(&#x27;_&#x27;).add(leftKey),
                  model.getTableName()+&#x22;_&#x22;+joins[field].leftKey, leftKey, ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Add a relation
* @param {string} field The field of the joined document(s)
* @param {Object} joinedDocument An object with the primary key defined or the related key
* @return {Promise}
*
* hasOne, primary key required
* User.get(1).<span class="apidocCodeKeywordSpan">addRelation</span>(&#x22;account&#x22;, {id: 2, sold: 2132})
* The promise resolved the document on which addRelation is called
*
* hasMany, primary key required
* User.get(1).addRelation(&#x22;accounts&#x22;, {id: 2, sold: 2132})
* The promise resolved the updated joined document
*
* belongsTo, right joined key OR primary key required
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.and" id="apidoc.element.thinky.query.prototype.and">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>and
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">and = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.append" id="apidoc.element.thinky.query.prototype.append">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>append
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">append = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.april" id="apidoc.element.thinky.query.prototype.april">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>april
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">april = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.args" id="apidoc.element.thinky.query.prototype.args">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>args
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">args = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
}

// Replace all documents with string-type primary keys
// in a single replace() operation.
if (primaryKeys.length) {
  revertPromises.push(
    r.table(self._model.getTableName()).getAll(r.<span class="apidocCodeKeywordSpan">args</span>(primaryKeys)).replace(function(
doc) {
      return r.expr(keysToValues)(doc(self._model._pk));
    }).run()
  );
}

return Promise.all(revertPromises).then(function(result) {
  throw new Error(&#x22;The write failed, and the changes were reverted.&#x22;);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.asc" id="apidoc.element.thinky.query.prototype.asc">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>asc
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">asc = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.august" id="apidoc.element.thinky.query.prototype.august">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>august
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">august = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.avg" id="apidoc.element.thinky.query.prototype.avg">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>avg
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">avg = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.between" id="apidoc.element.thinky.query.prototype.between">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>between
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">between = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.binary" id="apidoc.element.thinky.query.prototype.binary">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>binary
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">binary = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.bindExecute" id="apidoc.element.thinky.query.prototype.bindExecute">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>bindExecute
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindExecute = function () {
  var curriedArgs = Array.prototype.slice.call(arguments);
  return Function.prototype.bind.apply( Query.prototype.execute, [ this ].concat( curriedArgs ) );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.bindRun" id="apidoc.element.thinky.query.prototype.bindRun">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>bindRun
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bindRun = function () {
  var curriedArgs = Array.prototype.slice.call(arguments);
  return Function.prototype.bind.apply( Query.prototype.run, [ this ].concat( curriedArgs ) );
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.bracket" id="apidoc.element.thinky.query.prototype.bracket">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>bracket
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">bracket = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var updateValue = {};
  if (joinedDocument[joins[field].rightKey] === undefined) {
    if (joinedDocument[joinedModel._pk] === undefined) {
      return new Query(model, self, {},
          new Error(&#x27;The primary key or the joined key must be defined in the joined document for a `belongsTo` relation.&#
x27;)
      );
    }
    updateValue[joins[field].leftKey] = joinedModel.get(joinedDocument[joinedModel._pk]).<span class="apidocCodeKeywordSpan">bracket
</span>(joins[field].rightKey)._query;
  }
  else {
    updateValue[joins[field].leftKey] = joinedDocument[joins[field].rightKey];
  }
  return self.update(updateValue, {nonAtomic: true}).run();
case &#x27;hasAndBelongsToMany&#x27;:
  var linkModel = joins[field].linkModel;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.branch" id="apidoc.element.thinky.query.prototype.branch">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>branch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">branch = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (opts === undefined &#x26;&#x26; util.isPlainObject(fn)) {
  opts = fn;
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.<span class="apidocCodeKeywordSpan">branch</span>(
      r.table(tableName).indexList().contains(name),
      r.table(tableName).indexWait(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.catch" id="apidoc.element.thinky.query.prototype.catch">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>catch
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">catch = function () {
  var promise = this.run();
  return promise[key].apply(promise, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

if ((opts === undefined) &#x26;&#x26; (util.isPlainObject(fn))) {
  opts = fn;
  fn = undefined;
}

return self._createIndex(name, fn, opts)
.<span class="apidocCodeKeywordSpan">catch</span>(function(error) {
  self._getModel()._setError(error);
  throw error;
});
}

Model.prototype._createIndex = function(name, fn, opts) {
var model = this._getModel();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.ceil" id="apidoc.element.thinky.query.prototype.ceil">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ceil
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ceil = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.changeAt" id="apidoc.element.thinky.query.prototype.changeAt">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>changeAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">changeAt = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.changes" id="apidoc.element.thinky.query.prototype.changes">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>changes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">changes = function () {
  // In case of `get().changes()` we want to remove the default(r.errror(...))
  // TODO: Do not hardcode this?
  if ((typeof this._query === &#x27;function&#x27;) &#x26;&#x26; (this._query._query[0] === 92)) {
    this._query._query = this._query._query[1][0];
  }
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
  })(key);
  break;

case &#x27;changes&#x27;:
  (function(key) {
    Query.prototype[key] = function() {
      // In case of `get().<span class="apidocCodeKeywordSpan">changes</span>()` we want to remove the default(r.errror(...))
      // TODO: Do not hardcode this?
      if ((typeof this._query === &#x27;function&#x27;) &#x26;&#x26; (this._query._query[0] === 92)) {
        this._query._query = this._query._query[1][0];
      }
      return new Query(this._model, this._query[key].apply(this._query, arguments));
    }
  })(key);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.circle" id="apidoc.element.thinky.query.prototype.circle">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>circle
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">circle = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.coerceTo" id="apidoc.element.thinky.query.prototype.coerceTo">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>coerceTo
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">coerceTo = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.merge(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).<span class
="apidocCodeKeywordSpan">coerceTo</span>(&#x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
return r.branch(
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.concatMap" id="apidoc.element.thinky.query.prototype.concatMap">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>concatMap
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">concatMap = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
          break;

        case &#x27;hasAndBelongsToMany&#x27;:
          self._query = self._query.merge(function(doc) {
            if ((model.getTableName() === joins[key].model.getTableName()) &#x26;&#x26; (joins[key].leftKey === joins[key].rightKey
)) {
// In case the model is linked with itself on the same key

innerQuery = r.table(joins[key].link).getAll(doc(joins[key].leftKey), {index: joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey
}).<span class="apidocCodeKeywordSpan">concatMap</span>(function(link) {
  return r.table(joins[key].model.getTableName()).getAll(
    r.branch(
      doc(joins[key].leftKey).eq(link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(0)),
      link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(1),
      link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(0)
    )
  , {index: joins[key].rightKey})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.config" id="apidoc.element.thinky.query.prototype.config">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>config
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">config = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.contains" id="apidoc.element.thinky.query.prototype.contains">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>contains
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">contains = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  opts = fn;
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.branch(
      r.table(tableName).indexList().<span class="apidocCodeKeywordSpan">contains</span>(name),
      r.table(tableName).indexWait(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
        })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.count" id="apidoc.element.thinky.query.prototype.count">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>count
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">count = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
return r.branch(
  result.<span class="apidocCodeKeywordSpan">count</span>().eq(1),
  r.object(key, innerQuery),
  r.branch(
    result.count().eq(0),
    {},
    r.error(r.expr(&#x22;More than one element found for &#x22;).add(doc.coerceTo(&#x22;STRING&#x22;)).add(r.expr(&#x22;for the
field &#x22;).add(key)))
  )
)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.date" id="apidoc.element.thinky.query.prototype.date">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>date
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">date = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (schema.integer === true) { result.integer(); }
  return result;
case Boolean:
  result = type.boolean().options(options).validator(schema.validator);
  if (schema.default !== undefined) { result.default(schema.default); }
  return result;
case Date:
  var result = type.<span class="apidocCodeKeywordSpan">date</span>().options(options).validator(schema.validator);
  if (schema.default !== undefined) { result.default(schema.default); }
  if (schema.min instanceof Date) { result.min(schema.min); }
  if (schema.max instanceof Date) { result.max(schema.max); }
  return result;
case Buffer:
  result = type.buffer().options(options).validator(schema.validator);
  if (schema.default !== undefined) { result.default(schema.default); }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.day" id="apidoc.element.thinky.query.prototype.day">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>day
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">day = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.dayOfWeek" id="apidoc.element.thinky.query.prototype.dayOfWeek">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dayOfWeek
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dayOfWeek = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.dayOfYear" id="apidoc.element.thinky.query.prototype.dayOfYear">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dayOfYear
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dayOfYear = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.db" id="apidoc.element.thinky.query.prototype.db">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>db
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">db = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.dbCreate" id="apidoc.element.thinky.query.prototype.dbCreate">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dbCreate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbCreate = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.dbDrop" id="apidoc.element.thinky.query.prototype.dbDrop">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dbDrop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbDrop = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.dbList" id="apidoc.element.thinky.query.prototype.dbList">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>dbList
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">dbList = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.december" id="apidoc.element.thinky.query.prototype.december">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>december
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">december = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.default" id="apidoc.element.thinky.query.prototype.default">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>default
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">default = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
// Note: We suppose that no method has an empty name
switch (key) {
  case &#x27;get&#x27;:
    // `get` in thinky returns an error if the document is not found.
    // The driver currently just returns `null`.
    (function(key) {
      Query.prototype[key] = function() {
        return new Query(this._model, this._query[key].apply(this._query, arguments)).<span class="apidocCodeKeywordSpan">default
</span>(this._r.error(new Errors.DocumentNotFound().message));
      }
    })(key);
    // Copy it in `_get` without `default`.
    (function(key) {
      Query.prototype[&#x27;_get&#x27;] = function() {
        // Create a new query to let people fork it
        return new Query(this._model, this._query[key].apply(this._query, arguments));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.delay" id="apidoc.element.thinky.query.prototype.delay">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>delay
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delay = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.delete" id="apidoc.element.thinky.query.prototype.delete">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>delete
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">delete = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._belongsTo = {};
this._hasOne = {};
this._hasMany = {};
// Example: { &#x3c;linkTableName&#x3e;: { &#x3c;valueOfRightKey&#x3e;: true, ... }, ... }
this._links = {}

// Keep reference of any doc having a link pointing to this
// So we can clean when users do doc.belongsToDoc.<span class="apidocCodeKeywordSpan">delete</span>()
this._parents = {
  _hasOne: {},      // &#x3c;tableName&#x3e;: [{doc, key}]
  _hasMany: {},     // &#x3c;tableName&#x3e;: [{doc, key}]
  _belongsTo: {},   // &#x3c;tableName&#x3e;: [{doc, key, foreignKey}]
  _belongsLinks: {} // &#x3c;tableName&#x3e;: [{doc, key}]
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.deleteAt" id="apidoc.element.thinky.query.prototype.deleteAt">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>deleteAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">deleteAt = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.desc" id="apidoc.element.thinky.query.prototype.desc">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>desc
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">desc = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.difference" id="apidoc.element.thinky.query.prototype.difference">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>difference
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">difference = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.distance" id="apidoc.element.thinky.query.prototype.distance">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>distance
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">distance = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.distinct" id="apidoc.element.thinky.query.prototype.distinct">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>distinct
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">distinct = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.div" id="apidoc.element.thinky.query.prototype.div">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>div
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">div = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.do" id="apidoc.element.thinky.query.prototype.do">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>do
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">do = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return new Promise(function(resolve, reject) {
return r.branch(
  r.table(tableName).indexList().contains(name),
  r.table(tableName).indexWait(name),
  r.branch(
    r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
    r.table(tableName).indexWait(name),
    r.table(tableName).indexCreate(name, fn, opts).<span class="apidocCodeKeywordSpan">do</span>(function() {
      return r.table(tableName).indexWait(name);
    })
  )
)
.run()
.then(resolve)
.error(function(error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.downcase" id="apidoc.element.thinky.query.prototype.downcase">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>downcase
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">downcase = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.during" id="apidoc.element.thinky.query.prototype.during">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>during
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">during = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.epochTime" id="apidoc.element.thinky.query.prototype.epochTime">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>epochTime
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">epochTime = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.eq" id="apidoc.element.thinky.query.prototype.eq">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>eq
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eq = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  var promise = this.tableReady().then(function() {
return new Promise(function(resolve, reject) {
  return r.branch(
    r.table(tableName).indexList().contains(name),
    r.table(tableName).indexWait(name),
    r.branch(
      r.table(tableName).info()(&#x27;primary_key&#x27;).<span class="apidocCodeKeywordSpan">eq</span>(name),
      r.table(tableName).indexWait(name),
      r.table(tableName).indexCreate(name, fn, opts).do(function() {
        return r.table(tableName).indexWait(name);
      })
    )
  )
  .run()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.eqJoin" id="apidoc.element.thinky.query.prototype.eqJoin">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>eqJoin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">eqJoin = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.error" id="apidoc.element.thinky.query.prototype.error">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>error
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">error = function () {
  var promise = this.run();
  return promise[key].apply(promise, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      }
    });

    //TODO Remove once
    self.getModel().ready().then(function() {
      Promise.all(promises).then(function() {
        self._onSavedBelongsTo(copy, docToSave, belongsToKeysSaved, saveAll, savedModel, resolve, reject);
      }).<span class="apidocCodeKeywordSpan">error</span>(reject);
    });
  });
  return p;
}


/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.execute" id="apidoc.element.thinky.query.prototype.execute">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>execute
        <span class="apidocSignatureSpan">(options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">execute = function (options, callback) {
  if (typeof options === &#x27;function&#x27;) {
    callback = options;
    options = {};
  }
  return this._execute(options, false).nodeify(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Model.prototype.run = function(options) {
var query = new Query(this);
return query.run(options);
}
Model.prototype.execute = function(options) {
var query = new Query(this);
return query.<span class="apidocCodeKeywordSpan">execute</span>(options);
}

Model.prototype.save = function(docs, options) {
var self = this;
var r = self._getModel()._thinky.r;
var isArray = Array.isArray(docs);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.expr" id="apidoc.element.thinky.query.prototype.expr">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>expr
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">expr = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

return Promise.all([self.ready(), joinedModel.ready()]);
  }
};

(function() {
  // Import rethinkdbdash methods
  var Term = require(&#x27;rethinkdbdash&#x27;)({pool: false}).<span class="apidocCodeKeywordSpan">expr</span>(1).__proto__;
  util.loopKeys(Term, function(Term, key) {
if (!Term.hasOwnProperty(key)) return;
if (key === &#x27;run&#x27; || key[0] === &#x27;_&#x27;) return;

(function(key) {
  switch (key) {
    case &#x27;orderBy&#x27;:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.february" id="apidoc.element.thinky.query.prototype.february">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>february
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">february = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.fill" id="apidoc.element.thinky.query.prototype.fill">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>fill
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fill = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.filter" id="apidoc.element.thinky.query.prototype.filter">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>filter
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">filter = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.finally" id="apidoc.element.thinky.query.prototype.finally">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>finally
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">finally = function () {
  var promise = this.run();
  return promise[key].apply(promise, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.floor" id="apidoc.element.thinky.query.prototype.floor">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>floor
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">floor = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.fold" id="apidoc.element.thinky.query.prototype.fold">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>fold
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">fold = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.forEach" id="apidoc.element.thinky.query.prototype.forEach">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>forEach
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">forEach = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.friday" id="apidoc.element.thinky.query.prototype.friday">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>friday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">friday = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.ge" id="apidoc.element.thinky.query.prototype.ge">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ge = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.geojson" id="apidoc.element.thinky.query.prototype.geojson">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>geojson
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">geojson = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  else if (type.isPoint(schema)) {
if (util.isPlainObject(doc) &#x26;&#x26; (doc[&#x27;$reql_type$&#x27;] !== &#x22;GEOMETRY&#x22;)) {
  var keys = Object.keys(doc).sort();
  if ((keys.length === 2) &#x26;&#x26; (keys[0] === &#x27;latitude&#x27;) &#x26;&#x26; (keys[1] === &#x27;longitude&#x27;) &#x26
;&#x26; (typeof doc.latitude === &#x22;number&#x22;) &#x26;&#x26; (typeof doc.longitude === &#x22;number&#x22;)) {
    return r.point(doc.longitude, doc.latitude)
  }
  else if ((doc.type === &#x22;Point&#x22;) &#x26;&#x26; (Array.isArray(doc.coordinates)) &#x26;&#x26; (doc.coordinates.length ===
2)) { // Geojson
    return r.<span class="apidocCodeKeywordSpan">geojson</span>(doc)
  }
}
else if (Array.isArray(doc)) {
  if ((doc.length === 2) &#x26;&#x26; (typeof doc[0] === &#x22;number&#x22;) &#x26;&#x26; (typeof doc[1] === &#x22;number&#x22;)) {
    return r.point(doc[0], doc[1])
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.get" id="apidoc.element.thinky.query.prototype.get">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>get
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">get = function () {
  return new Query(this._model, this._query[key].apply(this._query, arguments)).default(this._r.error(new Errors.DocumentNotFound
().message));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
});
```

Retrieve the post with its author.

```js
Post.<span class="apidocCodeKeywordSpan">get</span>(&#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;).getJoin().run().then(function
(result) {
/*
result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.getAll" id="apidoc.element.thinky.query.prototype.getAll">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getAll
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAll = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  // Purge the database
  var promises = [];
  util.loopKeys(self._getModel()._joins, function(joins, field) {
var join = joins[field];
var joinedModel = join.model;

if ((join.type === &#x27;hasOne&#x27;) || (join.type === &#x27;hasMany&#x27;)) {
  promises.push(r.table(joinedModel.getTableName()).<span class="apidocCodeKeywordSpan">getAll</span>(self[join.leftKey], {index
: join.rightKey}).replace(function(doc) {
    return doc.without(join.rightKey)
  }).run())
}
// nothing to do for &#x22;belongsTo&#x22;
else if (join.type === &#x27;hasAndBelongsToMany&#x27;) {
  if (self.getModel()._getModel()._pk === join.leftKey) {
    // [1]
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.getField" id="apidoc.element.thinky.query.prototype.getField">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getField
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getField = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.getIntersecting" id="apidoc.element.thinky.query.prototype.getIntersecting">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getIntersecting
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getIntersecting = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.getJoin" id="apidoc.element.thinky.query.prototype.getJoin">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getJoin
        <span class="apidocSignatureSpan">(modelToGet, getAll, gotModel)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getJoin = function (modelToGet, getAll, gotModel) {
  var self = this;
  var r = self._model._getModel()._thinky.r;

  var model = this._model;
  var joins = this._model._getModel()._joins;

  var getAll = modelToGet === undefined;
  if (util.isPlainObject(modelToGet) === false) {
    modelToGet = {};
  }
  var innerQuery;

  gotModel = gotModel || {};
  gotModel[model.getTableName()] = true;

  util.loopKeys(joins, function(joins, key) {
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.merge(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#x22;ARRAY
&#x22;).do(function(result) {
                innerQuery = new Query(joins[key].model, result.nth(0));

                if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
                  innerQuery = modelToGet[key]._apply(innerQuery);
                }
                innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
                return r.branch(
                  result.count().eq(1),
                  r.object(key, innerQuery),
                  r.branch(
                    result.count().eq(0),
                    {},
                    r.error(r.expr(&#x22;More than one element found for &#x22;).add(doc.coerceTo(&#x22;STRING&#x22;)).add(r.expr(&#x22;for the field &#x22;).
add(key)))
                  )
                )
              }),
              {}
            )
          });
          break;

        case &#x27;hasMany&#x27;:
          self._query = self._query.merge(function(doc) {
            innerQuery = new Query(joins[key].model,
                       r.table(joins[key].model.getTableName())
                      .getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}))

            if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
              innerQuery = modelToGet[key]._apply(innerQuery);
            }
            innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel);
            if ((modelToGet[key] == null) || (modelToGet[key]._array !== false)) {
              innerQuery = innerQuery.coerceTo(&#x22;ARRAY&#x22;);
            }
            innerQuery = innerQuery._query;

            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.object(key, innerQuery),
              {}
            )
          });
          break;

        case &#x27;hasAndBelongsToMany&#x27;:
          self._query = self._query.merge(function(doc) {
            if ((model.getTableName() === joins[key].model.getTableName()) &#x26;&#x26; (joins[key].leftKey === joins[key].rightKey)) {
              // In case the model is linked with itself on the same key

              innerQuery = r.table(joins[key].link).getAll(doc(joins[key].leftKey), {index: joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey
}).concatMap(function(link) {
                return r.table(joins[key].model.getTableName()).getAll(
                  r.branch(
                    doc(joins[key].leftKey).eq(link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(0)),
                    link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(1),
                    link(joins[key].leftKey+&#x22;_&#x22;+joins[key].leftKey).nth(0)
                  )
                , {index: joins[key].rightKey})
              });

              if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
                innerQuery = modelToGet[key]._apply(innerQuery);
              }

              if ((modelToGet[key] == null) || (modelToGet[key]._array !== false)) {
                innerQuery = innerQuery.coerceTo(&#x22;ARRAY&#x22;);
              }

              return r.branch(
                doc.hasFields(joins[key].leftKey),
                r.object(key, new Query(joins[key].model, innerQuery).getJoin(modelToGet[key], getAll, gotModel)._query),
                {}
              ) ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
});
```

Retrieve the post with its author.

```js
Post.get(&#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;).<span class="apidocCodeKeywordSpan">getJoin</span>().run().then(function
(result) {
/*
result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.getNearest" id="apidoc.element.thinky.query.prototype.getNearest">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>getNearest
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getNearest = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.grant" id="apidoc.element.thinky.query.prototype.grant">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>grant
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">grant = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.group" id="apidoc.element.thinky.query.prototype.group">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>group
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">group = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.gt" id="apidoc.element.thinky.query.prototype.gt">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>gt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">gt = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.hasFields" id="apidoc.element.thinky.query.prototype.hasFields">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>hasFields
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hasFields = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  util.loopKeys(joins, function(joins, key) {
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.merge(function(doc) {
            return r.branch(
              doc.<span class="apidocCodeKeywordSpan">hasFields</span>(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#
x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.hours" id="apidoc.element.thinky.query.prototype.hours">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>hours
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">hours = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.http" id="apidoc.element.thinky.query.prototype.http">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>http
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">http = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.inTimezone" id="apidoc.element.thinky.query.prototype.inTimezone">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>inTimezone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">inTimezone = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.includes" id="apidoc.element.thinky.query.prototype.includes">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>includes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">includes = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.indexCreate" id="apidoc.element.thinky.query.prototype.indexCreate">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexCreate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexCreate = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return new Promise(function(resolve, reject) {
return r.branch(
  r.table(tableName).indexList().contains(name),
  r.table(tableName).indexWait(name),
  r.branch(
    r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
    r.table(tableName).indexWait(name),
    r.table(tableName).<span class="apidocCodeKeywordSpan">indexCreate</span>(name, fn, opts).do(function() {
      return r.table(tableName).indexWait(name);
    })
  )
)
.run()
.then(resolve)
.error(function(error) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.indexDrop" id="apidoc.element.thinky.query.prototype.indexDrop">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexDrop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexDrop = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.indexList" id="apidoc.element.thinky.query.prototype.indexList">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexList
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexList = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  opts = fn;
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.branch(
      r.table(tableName).<span class="apidocCodeKeywordSpan">indexList</span>().contains(name),
      r.table(tableName).indexWait(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
        })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.indexRename" id="apidoc.element.thinky.query.prototype.indexRename">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexRename
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexRename = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.indexStatus" id="apidoc.element.thinky.query.prototype.indexStatus">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexStatus
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexStatus = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.indexWait" id="apidoc.element.thinky.query.prototype.indexWait">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexWait
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexWait = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  fn = undefined;
}

var promise = this.tableReady().then(function() {
  return new Promise(function(resolve, reject) {
    return r.branch(
      r.table(tableName).indexList().contains(name),
      r.table(tableName).<span class="apidocCodeKeywordSpan">indexWait</span>(name),
      r.branch(
        r.table(tableName).info()(&#x27;primary_key&#x27;).eq(name),
        r.table(tableName).indexWait(name),
        r.table(tableName).indexCreate(name, fn, opts).do(function() {
          return r.table(tableName).indexWait(name);
        })
      )
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.indexesOf" id="apidoc.element.thinky.query.prototype.indexesOf">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>indexesOf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">indexesOf = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.info" id="apidoc.element.thinky.query.prototype.info">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>info
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">info = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  var promise = this.tableReady().then(function() {
return new Promise(function(resolve, reject) {
  return r.branch(
    r.table(tableName).indexList().contains(name),
    r.table(tableName).indexWait(name),
    r.branch(
      r.table(tableName).<span class="apidocCodeKeywordSpan">info</span>()(&#x27;primary_key&#x27;).eq(name),
      r.table(tableName).indexWait(name),
      r.table(tableName).indexCreate(name, fn, opts).do(function() {
        return r.table(tableName).indexWait(name);
      })
    )
  )
  .run()
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.innerJoin" id="apidoc.element.thinky.query.prototype.innerJoin">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>innerJoin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">innerJoin = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.insert" id="apidoc.element.thinky.query.prototype.insert">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>insert
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">insert = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var querySaveSelf; // The query to save the document on which `save`/`saveAll` was called.
// We haven&#x27;t validated the document yet, so building the query with `copy`
// may throw an error (for example if a Date has not a valid time).
var buildQuery = function () {
  if (self.__proto__._saved === false) {
    return querySaveSelf = r.table(constructor.getTableName())
      .<span class="apidocCodeKeywordSpan">insert</span>(copy, {returnChanges: &#x27;always&#x27;})
  }
  else {
    if (copy[model._pk] === undefined) {
      throw new Error(&#x22;The document was previously saved, but its primary key is undefined.&#x22;);
    }
    return querySaveSelf = r.table(constructor.getTableName())
      .get(copy[model._pk]).replace(copy, {returnChanges: &#x27;always&#x27;})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.insertAt" id="apidoc.element.thinky.query.prototype.insertAt">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>insertAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">insertAt = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.intersects" id="apidoc.element.thinky.query.prototype.intersects">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>intersects
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">intersects = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.isEmpty" id="apidoc.element.thinky.query.prototype.isEmpty">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>isEmpty
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isEmpty = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.january" id="apidoc.element.thinky.query.prototype.january">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>january
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">january = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.js" id="apidoc.element.thinky.query.prototype.js">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>js
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">js = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.json" id="apidoc.element.thinky.query.prototype.json">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>json
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">json = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.july" id="apidoc.element.thinky.query.prototype.july">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>july
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">july = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.june" id="apidoc.element.thinky.query.prototype.june">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>june
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">june = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.keys" id="apidoc.element.thinky.query.prototype.keys">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>keys
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">keys = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      doc = numericDate;
    }
  }
  return new Date(doc); // Use r.ISO8601 and not `new Date()` to keep timezone
}
else if (type.isPoint(schema)) {
  if (util.isPlainObject(doc) &#x26;&#x26; (doc[&#x27;$reql_type$&#x27;] !== &#x22;GEOMETRY&#x22;)) {
    var keys = Object.<span class="apidocCodeKeywordSpan">keys</span>(doc).sort();
    if ((keys.length === 2) &#x26;&#x26; (keys[0] === &#x27;latitude&#x27;) &#x26;&#x26; (keys[1] === &#x27;longitude&#x27;) &#x26
;&#x26; (typeof doc.latitude === &#x22;number&#x22;) &#x26;&#x26; (typeof doc.longitude === &#x22;number&#x22;)) {
      return r.point(doc.longitude, doc.latitude)
    }
    else if ((doc.type === &#x22;Point&#x22;) &#x26;&#x26; (Array.isArray(doc.coordinates)) &#x26;&#x26; (doc.coordinates.length
 === 2)) { // Geojson
      return r.geojson(doc)
    }
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.le" id="apidoc.element.thinky.query.prototype.le">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>le
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">le = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.limit" id="apidoc.element.thinky.query.prototype.limit">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>limit
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">limit = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.line" id="apidoc.element.thinky.query.prototype.line">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>line
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">line = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.literal" id="apidoc.element.thinky.query.prototype.literal">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>literal
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">literal = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.lt" id="apidoc.element.thinky.query.prototype.lt">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>lt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">lt = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

if ((model.getTableName() === joinedModel.getTableName())
    &#x26;&#x26; (joins[field].leftKey === joins[field].rightKey)) {
  linkValue = self._query(joins[field].leftKey).do(function(leftKey) {
    return link.do(function(rightKey) {
      return r.branch(
          rightKey.<span class="apidocCodeKeywordSpan">lt</span>(leftKey),
          r.object(
            &#x27;id&#x27;, rightKey.add(&#x27;_&#x27;).add(leftKey),
            joins[field].leftKey+&#x22;_&#x22;+joins[field].leftKey, [leftKey, rightKey]
          ),
          r.object(
            &#x27;id&#x27;, leftKey.add(&#x27;_&#x27;).add(rightKey),
            joins[field].leftKey+&#x22;_&#x22;+joins[field].leftKey, [leftKey, rightKey]
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.map" id="apidoc.element.thinky.query.prototype.map">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>map
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">map = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

raw = raw || true;
if (raw === true) {
  return this._getModel()._listeners[eventKey];
}
else {
  return this._getModel()._listeners[eventKey].<span class="apidocCodeKeywordSpan">map</span>(function(fn) {
    return fn.listener;
  });
}
}

Model.prototype.docSetMaxListeners = function(n) {
this._getModel()._maxListeners = n;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.march" id="apidoc.element.thinky.query.prototype.march">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>march
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">march = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.match" id="apidoc.element.thinky.query.prototype.match">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>match
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">match = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * Creates an appropriate error given either an instance of Error or a message
 * from the RethinkDB driver
 */
errors.create = function(errorOrMessage) {
var message = (errorOrMessage instanceof Error) ? errorOrMessage.message : errorOrMessage;
if (message.<span class="apidocCodeKeywordSpan">match</span>(errors.DOCUMENT_NOT_FOUND_REGEX)) {
  return new errors.DocumentNotFound(message);
} else if (message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)) {
  var primaryKey = message.match(errors.DUPLICATE_PRIMARY_KEY_REGEX)[1];
  return new errors.DuplicatePrimaryKey(message, primaryKey);
} else if (errorOrMessage instanceof Error) {
  return errorOrMessage;
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.max" id="apidoc.element.thinky.query.prototype.max">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>max
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">max = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
options = util.mergeOptions(options, schema.options);
var result;
switch(schema._type) {
  case String:
    result = type.string().options(options).validator(schema.validator).enum(schema.enum);
    if (schema.default !== undefined) { result.default(schema.default); }
    if (typeof schema.min === &#x22;number&#x22;) { result.min(schema.min); }
    if (typeof schema.max === &#x22;number&#x22;) { result.<span class="apidocCodeKeywordSpan">max</span>(schema.max); }
    if (typeof schema.length === &#x22;number&#x22;) { result.length(schema.length); }
    if (schema.alphanum === true) { result.alphanum(); }
    if (schema.lowercase === true) { result.lowercase(); }
    if (schema.uppercase === true) { result.uppercase(); }
    if (typeof schema.regex === &#x22;string&#x22;) { result.regex(regex, schema.flags); }
    return result;
  case Number:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.maxval" id="apidoc.element.thinky.query.prototype.maxval">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>maxval
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">maxval = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.may" id="apidoc.element.thinky.query.prototype.may">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>may
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">may = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.merge" id="apidoc.element.thinky.query.prototype.merge">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>merge
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">merge = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  gotModel[model.getTableName()] = true;

  util.loopKeys(joins, function(joins, key) {
    if (util.recurse(key, joins, modelToGet, getAll, gotModel)) {
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.<span class="apidocCodeKeywordSpan">merge</span>(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#
x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.nth(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.min" id="apidoc.element.thinky.query.prototype.min">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>min
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">min = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  content: String,
  idAuthor: String
});

// You can also add constraints on the schema
var Author = thinky.createModel(&#x22;Author&#x22;, {
  id: type.string(),      // a normal string
  name: type.string().<span class="apidocCodeKeywordSpan">min</span>(2),  // a string of at least two characters
  email: type.string().email()  // a string that is a valid email
});

// Join the models
Post.belongsTo(Author, &#x22;author&#x22;, &#x22;idAuthor&#x22;, &#x22;id&#x22;);
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.minutes" id="apidoc.element.thinky.query.prototype.minutes">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>minutes
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">minutes = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.minval" id="apidoc.element.thinky.query.prototype.minval">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>minval
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">minval = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.mod" id="apidoc.element.thinky.query.prototype.mod">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>mod
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mod = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.monday" id="apidoc.element.thinky.query.prototype.monday">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>monday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">monday = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.month" id="apidoc.element.thinky.query.prototype.month">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>month
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">month = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.mul" id="apidoc.element.thinky.query.prototype.mul">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>mul
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mul = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.ne" id="apidoc.element.thinky.query.prototype.ne">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ne
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ne = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.not" id="apidoc.element.thinky.query.prototype.not">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>not
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">not = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.november" id="apidoc.element.thinky.query.prototype.november">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>november
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">november = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.now" id="apidoc.element.thinky.query.prototype.now">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>now
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">now = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.nth" id="apidoc.element.thinky.query.prototype.nth">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>nth
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">nth = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      switch (joins[key].type) {
        case &#x27;hasOne&#x27;:
        case &#x27;belongsTo&#x27;:
          self._query = self._query.merge(function(doc) {
            return r.branch(
              doc.hasFields(joins[key].leftKey),
              r.table(joins[key].model.getTableName()).getAll(doc(joins[key].leftKey), {index: joins[key].rightKey}).coerceTo(&#
x22;ARRAY&#x22;).do(function(result) {
innerQuery = new Query(joins[key].model, result.<span class="apidocCodeKeywordSpan">nth</span>(0));

if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
  innerQuery = modelToGet[key]._apply(innerQuery);
}
innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
return r.branch(
  result.count().eq(1),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.object" id="apidoc.element.thinky.query.prototype.object">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>object
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">object = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

  if ((modelToGet[key] != null) &#x26;&#x26; (typeof modelToGet[key]._apply === &#x27;function&#x27;)) {
    innerQuery = modelToGet[key]._apply(innerQuery);
  }
  innerQuery = innerQuery.getJoin(modelToGet[key], getAll, gotModel)._query;
  return r.branch(
    result.count().eq(1),
    r.<span class="apidocCodeKeywordSpan">object</span>(key, innerQuery),
    r.branch(
      result.count().eq(0),
      {},
      r.error(r.expr(&#x22;More than one element found for &#x22;).add(doc.coerceTo(&#x22;STRING&#x22;)).add(r.expr(&#x22;for the
 field &#x22;).add(key)))
    )
  )
}),
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.october" id="apidoc.element.thinky.query.prototype.october">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>october
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">october = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.offsetsOf" id="apidoc.element.thinky.query.prototype.offsetsOf">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>offsetsOf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">offsetsOf = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.or" id="apidoc.element.thinky.query.prototype.or">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>or
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">or = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.orderBy" id="apidoc.element.thinky.query.prototype.orderBy">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>orderBy
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">orderBy = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.outerJoin" id="apidoc.element.thinky.query.prototype.outerJoin">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>outerJoin
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">outerJoin = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.pluck" id="apidoc.element.thinky.query.prototype.pluck">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>pluck
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">pluck = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.point" id="apidoc.element.thinky.query.prototype.point">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>point
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">point = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }
  return new Date(doc); // Use r.ISO8601 and not `new Date()` to keep timezone
}
else if (type.isPoint(schema)) {
  if (util.isPlainObject(doc) &#x26;&#x26; (doc[&#x27;$reql_type$&#x27;] !== &#x22;GEOMETRY&#x22;)) {
    var keys = Object.keys(doc).sort();
    if ((keys.length === 2) &#x26;&#x26; (keys[0] === &#x27;latitude&#x27;) &#x26;&#x26; (keys[1] === &#x27;longitude&#x27;) &#x26
;&#x26; (typeof doc.latitude === &#x22;number&#x22;) &#x26;&#x26; (typeof doc.longitude === &#x22;number&#x22;)) {
      return r.<span class="apidocCodeKeywordSpan">point</span>(doc.longitude, doc.latitude)
    }
    else if ((doc.type === &#x22;Point&#x22;) &#x26;&#x26; (Array.isArray(doc.coordinates)) &#x26;&#x26; (doc.coordinates.length
 === 2)) { // Geojson
      return r.geojson(doc)
    }
  }
  else if (Array.isArray(doc)) {
    if ((doc.length === 2) &#x26;&#x26; (typeof doc[0] === &#x22;number&#x22;) &#x26;&#x26; (typeof doc[1] === &#x22;number&#x22
;)) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.polygon" id="apidoc.element.thinky.query.prototype.polygon">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>polygon
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">polygon = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.polygonSub" id="apidoc.element.thinky.query.prototype.polygonSub">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>polygonSub
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">polygonSub = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.prepend" id="apidoc.element.thinky.query.prototype.prepend">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>prepend
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepend = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.random" id="apidoc.element.thinky.query.prototype.random">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>random
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">random = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.range" id="apidoc.element.thinky.query.prototype.range">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>range
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">range = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.rebalance" id="apidoc.element.thinky.query.prototype.rebalance">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>rebalance
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">rebalance = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.reconfigure" id="apidoc.element.thinky.query.prototype.reconfigure">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>reconfigure
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reconfigure = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.reduce" id="apidoc.element.thinky.query.prototype.reduce">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>reduce
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reduce = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.removeRelation" id="apidoc.element.thinky.query.prototype.removeRelation">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>removeRelation
        <span class="apidocSignatureSpan">(field, joinedDocument)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">removeRelation = function (field, joinedDocument) {
  var self = this;
  var model = self._model;
  var joins = self._model._getModel()._joins;
  var joinedModel = joins[field].model;
  var r = self._model._thinky.r;

  var query;
  switch (joins[field].type) {
    case &#x27;hasOne&#x27;:
      query = joinedModel.getAll(self._query(joins[field].leftKey), {index: joins[field].rightKey}).replace(function(row) {
        return row.without(joins[field].rightKey)
      });
      query.setPostValidation();
      query.setPointWrite();
      return query;
    case &#x27;hasMany&#x27;:
      if (joinedDocument === undefined) {
        query = joinedModel.getAll(self._query(joins[field].leftKey), {index: joins[field].rightKey}).replace(function(row) {
          return row.without(joins[field].rightKey)
        })
      }
      else {
        query = joinedModel.getAll(r.expr(joinedDocument)(joinedModel._pk)).replace(function(row) {
          return row.without(joins[field].rightKey)
        })
      }
      query.setPostValidation();
      return query;
    case &#x27;belongsTo&#x27;:
      query = self.replace(function(row) {
        return row.without(joins[field].leftKey)
      })
      query.setPostValidation();
      return query;
    case &#x27;hasAndBelongsToMany&#x27;:
      var linkModel = joins[field].linkModel;
      if (joinedDocument === undefined) {
        query = self._query(joins[field].leftKey).do(function(leftKey) {
          // range are not supported at the moment, so keys is an object and we don&#x27;t have to worry about empty sequences
          if ((model.getTableName() === joinedModel.getTableName())
              &#x26;&#x26; (joins[field].leftKey === joins[field].rightKey)) {
            return linkModel.getAll(leftKey, {index: joins[field].leftKey+&#x27;_&#x27;+joins[field].leftKey}).delete()._query
          }
          else {
            return linkModel.getAll(leftKey, {index: model.getTableName()+&#x27;_&#x27;+joins[field].leftKey}).delete()._query
          }
        }).do(function(result) {
          return r.branch(
              result(&#x27;errors&#x27;).eq(0),
              true, // not relevant value
              r.error(result(&#x27;errors&#x27;))
           )
        })
      }
      else {
        if (joinedDocument[joins[field].rightKey] === undefined) {
          if (joinedDocument[joinedModel._pk] === undefined) {
            return new Query(model, self, {},
                new Error(&#x27;The primary key or the joined key must be defined in the joined document for a `hasAndBelongsToMany`
relation.&#x27;)
            );
          }

          if ((model.getTableName() === joinedModel.getTableName())
              &#x26;&#x26; (joins[field].leftKey === joins[field].rightKey)) {
            query = self._query(joins[field].leftKey).do(function(leftKey) {
              return joinedModel.get(joinedDocument[joinedModel._pk]).bracket(joins[field].rightKey).do(function(rightKey) {
                if (model.getTableName() &#x3c; joinedModel.getTableName()) {
                  return linkModel.getAll(leftKey.add(&#x27;_&#x27;).add(rightKey)).delete()._query;
                }
                else if (model.getTableName() &#x3e; joinedModel.getTableName()) {
                  return linkModel.getAll(rightKey.add(&#x27;_&#x27;).add(leftKey)).delete()._query;
                }
                else {
                  return r.branch(
                    leftKey.lt(rightKey),
                    linkModel.getAll(leftKey.add(&#x27;_&#x27;).add(rightKey)).delete()._query,
                    linkModel.getAll(rightKey.add(&#x27;_&#x27;).add(leftKey)).delete()._query
                  )
                }
              });
            })
          }
          else {
            query = self._query(joins[field].leftKey).do(function(leftKey) {
              return joinedModel.get(joinedDocument[joinedModel._pk]).bracket(joins[field].rightKey).do(function(rightKey) {
                if (model.getTableName() &#x3c; joinedModel.getTableName()) {
                  return linkModel.getAll(leftKey.add(&#x27;_&#x27;).add(rightKey)).delete()._query
                }
                else if (model.getTableName() &#x3e; joinedModel.getTableName()) {
                  return linkModel.getAll(rightKey.add(&#x27;_ ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.replace" id="apidoc.element.thinky.query.prototype.replace">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>replace
        <span class="apidocSignatureSpan">(value, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">replace = function (value, options) {
  options = options || {};
  options.returnChanges = &#x27;always&#x27;;
  var error = null;
  var self = this;
  util.tryCatch(function() {
    if (util.isPlainObject(value)) {
      schemaUtil.validate(value, self._model._schema, &#x27;&#x27;, {enforce_missing: false});
    }
  }, function(err) {
    error = err;
  });
  return new Query(this._model, this._query[key].call(this._query, value, options), {postValidation: true}, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
      .insert(copy, {returnChanges: &#x27;always&#x27;})
  }
  else {
    if (copy[model._pk] === undefined) {
      throw new Error(&#x22;The document was previously saved, but its primary key is undefined.&#x22;);
    }
    return querySaveSelf = r.table(constructor.getTableName())
      .get(copy[model._pk]).<span class="apidocCodeKeywordSpan">replace</span>(copy, {returnChanges: &#x27;always&#x27;})
  }
}

self.getModel().ready().then(function() {
  util.tryCatch(function() {
    // Validate the document before saving it
    var promise = self.validate();
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.round" id="apidoc.element.thinky.query.prototype.round">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>round
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">round = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.row" id="apidoc.element.thinky.query.prototype.row">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>row
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">row = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.run" id="apidoc.element.thinky.query.prototype.run">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>run
        <span class="apidocSignatureSpan">(options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">run = function (options, callback) {
  if (typeof options === &#x27;function&#x27;) {
    callback = options;
    options = {};
  }
  return this._execute(options, true).nodeify(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
*/
});
```

Retrieve the post with its author.

```js
Post.get(&#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;).getJoin().<span class="apidocCodeKeywordSpan">run</span>().then(function
(result) {
/*
result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.sample" id="apidoc.element.thinky.query.prototype.sample">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sample
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sample = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.saturday" id="apidoc.element.thinky.query.prototype.saturday">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>saturday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">saturday = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.seconds" id="apidoc.element.thinky.query.prototype.seconds">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>seconds
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">seconds = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.september" id="apidoc.element.thinky.query.prototype.september">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>september
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">september = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.setDifference" id="apidoc.element.thinky.query.prototype.setDifference">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setDifference
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setDifference = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.setInsert" id="apidoc.element.thinky.query.prototype.setInsert">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setInsert
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setInsert = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.setIntersection" id="apidoc.element.thinky.query.prototype.setIntersection">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setIntersection
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setIntersection = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.setPointWrite" id="apidoc.element.thinky.query.prototype.setPointWrite">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setPointWrite
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setPointWrite = function () {
  this._pointWrite = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var query;
switch (joins[field].type) {
  case &#x27;hasOne&#x27;:
    query = joinedModel.getAll(self._query(joins[field].leftKey), {index: joins[field].rightKey}).replace(function(row) {
      return row.without(joins[field].rightKey)
    });
    query.setPostValidation();
    query.<span class="apidocCodeKeywordSpan">setPointWrite</span>();
    return query;
  case &#x27;hasMany&#x27;:
    if (joinedDocument === undefined) {
      query = joinedModel.getAll(self._query(joins[field].leftKey), {index: joins[field].rightKey}).replace(function(row) {
        return row.without(joins[field].rightKey)
      })
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.setPostValidation" id="apidoc.element.thinky.query.prototype.setPostValidation">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setPostValidation
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setPostValidation = function () {
  this._postValidation = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var query;
switch (joins[field].type) {
  case &#x27;hasOne&#x27;:
    query = joinedModel.getAll(self._query(joins[field].leftKey), {index: joins[field].rightKey}).replace(function(row) {
      return row.without(joins[field].rightKey)
    });
    query.<span class="apidocCodeKeywordSpan">setPostValidation</span>();
    query.setPointWrite();
    return query;
  case &#x27;hasMany&#x27;:
    if (joinedDocument === undefined) {
      query = joinedModel.getAll(self._query(joins[field].leftKey), {index: joins[field].rightKey}).replace(function(row) {
        return row.without(joins[field].rightKey)
      })
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.setUnion" id="apidoc.element.thinky.query.prototype.setUnion">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>setUnion
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setUnion = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.skip" id="apidoc.element.thinky.query.prototype.skip">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>skip
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">skip = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.slice" id="apidoc.element.thinky.query.prototype.slice">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>slice
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">slice = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    return;
  }
  else {
    for(var k=0; k&#x3c;field.length; k++) {
      if (virtual != null) {
        virtualValue = virtual[k];
      }
      generateVirtual(field[k], {path: defaultField.path.<span class="apidocCodeKeywordSpan">slice</span>(j+1), value: defaultField
.value}, this, virtualValue);
    }
  }
  keepGoing = false;
}
else {
  // field cannot be undefined (doc is not undefined on the first iteration, and we&#x27;ll return if it becomes undefined
  field = field[path[j]];
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.spliceAt" id="apidoc.element.thinky.query.prototype.spliceAt">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>spliceAt
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">spliceAt = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.split" id="apidoc.element.thinky.query.prototype.split">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>split
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">split = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.status" id="apidoc.element.thinky.query.prototype.status">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>status
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">status = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.sub" id="apidoc.element.thinky.query.prototype.sub">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sub
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sub = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.sum" id="apidoc.element.thinky.query.prototype.sum">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sum
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sum = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.sunday" id="apidoc.element.thinky.query.prototype.sunday">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sunday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sunday = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.sync" id="apidoc.element.thinky.query.prototype.sync">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>sync
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sync = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.table" id="apidoc.element.thinky.query.prototype.table">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>table
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">table = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

var querySaveSelf; // The query to save the document on which `save`/`saveAll` was called.
// We haven&#x27;t validated the document yet, so building the query with `copy`
// may throw an error (for example if a Date has not a valid time).
var buildQuery = function () {
  if (self.__proto__._saved === false) {
    return querySaveSelf = r.<span class="apidocCodeKeywordSpan">table</span>(constructor.getTableName())
      .insert(copy, {returnChanges: &#x27;always&#x27;})
  }
  else {
    if (copy[model._pk] === undefined) {
      throw new Error(&#x22;The document was previously saved, but its primary key is undefined.&#x22;);
    }
    return querySaveSelf = r.table(constructor.getTableName())
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.tableCreate" id="apidoc.element.thinky.query.prototype.tableCreate">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tableCreate
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tableCreate = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (!this._initModel) return Promise.resolve();
if (this._tableReadyPromise) return this._tableReadyPromise;

// Create the table, or push the table name in the queue.
var r = model._thinky.r;
this._tableReadyPromise = model._thinky.dbReady()
.then(function() {
  return r.<span class="apidocCodeKeywordSpan">tableCreate</span>(model._name, model._table).run();
})
.error(function(error) {
  if (error.message.match(/Table `.*` already exists/)) {
    return;
  }
  model._error = error;
  // Should we throw here?
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.tableDrop" id="apidoc.element.thinky.query.prototype.tableDrop">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tableDrop
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tableDrop = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.tableList" id="apidoc.element.thinky.query.prototype.tableList">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tableList
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tableList = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.then" id="apidoc.element.thinky.query.prototype.then">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>then
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">then = function () {
  var promise = this.run();
  return promise[key].apply(promise, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
email: &#x22;orphee@gmail.com&#x22;
});

// Join the documents
post.author = author;


post.saveAll().<span class="apidocCodeKeywordSpan">then</span>(function(result) {
/*
post = result = {
  id: &#x22;0e4a6f6f-cc0c-4aa5-951a-fcfc480dd05a&#x22;,
  title: &#x22;Hello World!&#x22;,
  content: &#x22;This is an example.&#x22;,
  idAuthor: &#x22;3851d8b4-5358-43f2-ba23-f4d481358901&#x22;,
  author: {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.thursday" id="apidoc.element.thinky.query.prototype.thursday">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>thursday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">thursday = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.time" id="apidoc.element.thinky.query.prototype.time">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>time
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">time = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.timeOfDay" id="apidoc.element.thinky.query.prototype.timeOfDay">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>timeOfDay
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timeOfDay = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.timezone" id="apidoc.element.thinky.query.prototype.timezone">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>timezone
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">timezone = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.toEpochTime" id="apidoc.element.thinky.query.prototype.toEpochTime">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toEpochTime
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toEpochTime = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.toGeojson" id="apidoc.element.thinky.query.prototype.toGeojson">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toGeojson
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toGeojson = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.toISO8601" id="apidoc.element.thinky.query.prototype.toISO8601">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toISO8601
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toISO8601 = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.toJSON" id="apidoc.element.thinky.query.prototype.toJSON">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toJSON
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toJSON = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.toJsonString" id="apidoc.element.thinky.query.prototype.toJsonString">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toJsonString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toJsonString = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.toStream" id="apidoc.element.thinky.query.prototype.toStream">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toStream
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toStream = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.toString" id="apidoc.element.thinky.query.prototype.toString">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>toString
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">toString = function () {
  return this._query.toString();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

/**
 * Convert the query to its string representation.
 * @return {string}
 */
Query.prototype.toString = function() {
  return this._query.<span class="apidocCodeKeywordSpan">toString</span>();
}

module.exports = Query;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.tuesday" id="apidoc.element.thinky.query.prototype.tuesday">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>tuesday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">tuesday = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.typeOf" id="apidoc.element.thinky.query.prototype.typeOf">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>typeOf
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">typeOf = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.ungroup" id="apidoc.element.thinky.query.prototype.ungroup">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>ungroup
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ungroup = function () {
  return new Query(this._model, this._query[key].apply(this._query, arguments), {ungroup: true});
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.union" id="apidoc.element.thinky.query.prototype.union">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>union
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">union = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.upcase" id="apidoc.element.thinky.query.prototype.upcase">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>upcase
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upcase = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.update" id="apidoc.element.thinky.query.prototype.update">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>update
        <span class="apidocSignatureSpan">(value, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">update = function (value, options) {
  options = options || {};
  options.returnChanges = &#x27;always&#x27;;
  var error = null;
  var self = this;
  util.tryCatch(function() {
    if (util.isPlainObject(value)) {
      schemaUtil.validate(value, self._model._schema, &#x27;&#x27;, {enforce_missing: false});
    }
  }, function(err) {
    error = err;
  });
  return new Query(this._model, this._query[key].call(this._query, value, options), {postValidation: true}, error);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  if (joinedDocument[joinedModel._pk] === undefined) {
    return new Query(model, self, {},
        new Error(&#x27;Primary key for the joined document not found for a `hasOne/hasMany` relation.&#x27;)
    );
  }
  var updateValue = {};
  updateValue[joins[field].rightKey] = self._query(joins[field].leftKey);
  return joinedModel.get(joinedDocument[joinedModel._pk]).<span class="apidocCodeKeywordSpan">update</span>(updateValue, {nonAtomic
: true}).run()
case &#x27;belongsTo&#x27;:
  var updateValue = {};
  if (joinedDocument[joins[field].rightKey] === undefined) {
    if (joinedDocument[joinedModel._pk] === undefined) {
      return new Query(model, self, {},
          new Error(&#x27;The primary key or the joined key must be defined in the joined document for a `belongsTo` relation.&#
x27;)
      );
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.uuid" id="apidoc.element.thinky.query.prototype.uuid">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>uuid
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">uuid = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.values" id="apidoc.element.thinky.query.prototype.values">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>values
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">values = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.wait" id="apidoc.element.thinky.query.prototype.wait">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>wait
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wait = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.wednesday" id="apidoc.element.thinky.query.prototype.wednesday">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>wednesday
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">wednesday = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.withFields" id="apidoc.element.thinky.query.prototype.withFields">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>withFields
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">withFields = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.without" id="apidoc.element.thinky.query.prototype.without">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>without
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">without = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var promises = [];
  util.loopKeys(self._getModel()._joins, function(joins, field) {
var join = joins[field];
var joinedModel = join.model;

if ((join.type === &#x27;hasOne&#x27;) || (join.type === &#x27;hasMany&#x27;)) {
  promises.push(r.table(joinedModel.getTableName()).getAll(self[join.leftKey], {index: join.rightKey}).replace(function(doc) {
    return doc.<span class="apidocCodeKeywordSpan">without</span>(join.rightKey)
  }).run())
}
// nothing to do for &#x22;belongsTo&#x22;
else if (join.type === &#x27;hasAndBelongsToMany&#x27;) {
  if (self.getModel()._getModel()._pk === join.leftKey) {
    // [1]
    promises.push(r.table(join.link).getAll(self[join.leftKey], {index: self.getModel().getTableName()+&#x22;_&#x22;+join.leftKey
}).delete().run())
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.year" id="apidoc.element.thinky.query.prototype.year">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>year
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">year = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.query.prototype.zip" id="apidoc.element.thinky.query.prototype.zip">
        function <span class="apidocSignatureSpan">thinky.query.prototype.</span>zip
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">zip = function () {
  // Create a new query to let people fork it
  return new Query(this._model, this._query[key].apply(this._query, arguments));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.schema" id="apidoc.module.thinky.schema">module thinky.schema</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.schema.generateDefault" id="apidoc.element.thinky.schema.generateDefault">
        function <span class="apidocSignatureSpan">thinky.schema.</span>generateDefault
        <span class="apidocSignatureSpan">(doc, defaultField, originalDoc)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function generateDefault(doc, defaultField, originalDoc) {
  var path = defaultField.path;
  var value = defaultField.value;
  var field = doc;

  var keepGoing = true;
  for(var j=0; j&#x3c;path.length-1; j++) {
    if (path[j] === arrayPrefix) {
      if (!Array.isArray(field)) {
        // This is caught by validate, except if there is an `enforce_type: &#x22;none&#x22;`.
        return;
      }
      else {
        for(var k=0; k&#x3c;field.length; k++) {
          generateDefault(field[k], {path: defaultField.path.slice(j+1), value: defaultField.value}, this);
        }
      }
      keepGoing = false;
    }
    else {
      field = field[path[j]];
      if (field === undefined) {
        // We do not populate parent of default fields by default
        return;
      }
    }
  }
  if (keepGoing &#x26;&#x26; util.isPlainObject(field) &#x26;&#x26; field[path[path.length-1]] === undefined) {
    if ((typeof value === &#x22;function&#x22;) &#x26;&#x26; !Array.isArray(value._query)) {
      field[path[path.length-1]] = value.call(doc);
    }
    else {
      if (util.isPlainObject(value) || Array.isArray(value)) {
        field[path[path.length-1]] = util.deepCopy(value);
      }
      else {
        field[path[path.length-1]] = value;
      }
    }
  }
  return doc;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

/**
 * Generate the default values for the document, first the non virtual fields, and then
 * the virtual fields.
 */
Document.prototype._generateDefault = function() {
  for(var i=0; i&#x3c;this._getModel().defaultFields.length; i++) {
    schemaUtil.<span class="apidocCodeKeywordSpan">generateDefault</span>(this, this._getModel().defaultFields[i], this);
  }
  if (this._getModel().virtualFields.length &#x3e; 0) {
    this.generateVirtualValues();
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.schema.generateVirtual" id="apidoc.element.thinky.schema.generateVirtual">
        function <span class="apidocSignatureSpan">thinky.schema.</span>generateVirtual
        <span class="apidocSignatureSpan">(doc, defaultField, originalDoc, virtual)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function generateVirtual(doc, defaultField, originalDoc, virtual) {
  var path = defaultField.path;
  var value = defaultField.value;
  var field = doc;

  var keepGoing = true;
  var virtualValue = virtual;

  for(var j=0; j&#x3c;path.length-1; j++) {
    if (util.isPlainObject(virtualValue)) {
      virtualValue = virtualValue[path[j]];
    }
    else {
      virtualValue = undefined;
    }

    if (path[j] === arrayPrefix) {
      if (!Array.isArray(field)) {
        // This is caught by validate, except if there is an `enforce_type: &#x22;none&#x22;`.
        return;
      }
      else {
        for(var k=0; k&#x3c;field.length; k++) {
          if (virtual != null) {
            virtualValue = virtual[k];
          }
          generateVirtual(field[k], {path: defaultField.path.slice(j+1), value: defaultField.value}, this, virtualValue);
        }
      }
      keepGoing = false;
    }
    else {
      // field cannot be undefined (doc is not undefined on the first iteration, and we&#x27;ll return if it becomes undefined
      field = field[path[j]];
      if (field === undefined) {
        // We do not populate parent of default fields by default
        return;
      }
    }
  }
  if (keepGoing) {
    if (value === undefined) {
      if (util.isPlainObject(virtualValue) &#x26;&#x26; (virtualValue[[path[path.length-1]]] !== undefined)) {
        field[path[path.length-1]] = virtualValue[[path[path.length-1]]];
      }
    }
    else if ((typeof value === &#x22;function&#x22;) &#x26;&#x26; !Array.isArray(value._query)) {
      field[path[path.length-1]] = value.call(doc);
    }
    else {
      if (util.isPlainObject(value)) {
        field[path[path.length-1]] = util.deepCopy(value);
      }
      else if (value !== undefined) {
        field[path[path.length-1]] = value;
      }
    }
  }
  return doc;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Generate the virtual values for the document, or re-inject the ones
* previously saved.
* This should be called **after** `_generateDefault`.
*/
Document.prototype.generateVirtualValues = function() {
 for(var i=0; i&#x3c;this._getModel().virtualFields.length; i++) {
   schemaUtil.<span class="apidocCodeKeywordSpan">generateVirtual</span>(this, this._getModel().virtualFields[i], this, this._getVirtual
());
 }
}


/**
* Generate the default values for the document, first the non virtual fields, and then
* the virtual fields.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.schema.parse" id="apidoc.element.thinky.schema.parse">
        function <span class="apidocSignatureSpan">thinky.schema.</span>parse
        <span class="apidocSignatureSpan">(schema, prefix, options, model)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function parse(schema, prefix, options, model) {
  var result;

  if ((prefix === &#x27;&#x27;) &#x26;&#x26; (type.isObject(schema) === false) &#x26;&#x26; (util.isPlainObject(schema) === false)) {
    throw new Errors.ValidationError(&#x22;The schema must be a plain object.&#x22;)
  }

  // Validate a schema and add the field _enum if needed
  if (util.isPlainObject(schema)) {
    if (schema._type !== undefined) {
      options = util.mergeOptions(options, schema.options);
      var result;
      switch(schema._type) {
        case String:
          result = type.string().options(options).validator(schema.validator).enum(schema.enum);
          if (schema.default !== undefined) { result.default(schema.default); }
          if (typeof schema.min === &#x22;number&#x22;) { result.min(schema.min); }
          if (typeof schema.max === &#x22;number&#x22;) { result.max(schema.max); }
          if (typeof schema.length === &#x22;number&#x22;) { result.length(schema.length); }
          if (schema.alphanum === true) { result.alphanum(); }
          if (schema.lowercase === true) { result.lowercase(); }
          if (schema.uppercase === true) { result.uppercase(); }
          if (typeof schema.regex === &#x22;string&#x22;) { result.regex(regex, schema.flags); }
          return result;
        case Number:
          result = type.number().options(options).validator(schema.validator);
          if (schema.default !== undefined) { result.default(schema.default); }
          if (typeof schema.min === &#x22;number&#x22;) { result.min(schema.min); }
          if (typeof schema.max === &#x22;number&#x22;) { result.max(schema.max); }
          if (typeof schema.length === &#x22;number&#x22;) { result.length(schema.length); }
          if (schema.integer === true) { result.integer(); }
          return result;
        case Boolean:
          result = type.boolean().options(options).validator(schema.validator);
          if (schema.default !== undefined) { result.default(schema.default); }
          return result;
        case Date:
          var result = type.date().options(options).validator(schema.validator);
          if (schema.default !== undefined) { result.default(schema.default); }
          if (schema.min instanceof Date) { result.min(schema.min); }
          if (schema.max instanceof Date) { result.max(schema.max); }
          return result;
        case Buffer:
          result = type.buffer().options(options).validator(schema.validator);
          if (schema.default !== undefined) { result.default(schema.default); }
          return result
        case Object:
          result = type.object().options(options).validator(schema.validator);
          if (schema.default !== undefined) { result.default(schema.default); }
          util.loopKeys(schema.schema, function(_schema, key) {
            result.setKey(key, parse(_schema[key], prefix+&#x22;[&#x22;+key+&#x22;]&#x22;, options));
          })
          if (prefix === &#x27;&#x27;) {
            result._setModel(model)
          }
          return result;
        case Array:
          var result = type.array().options(options).validator(schema.validator);
          if (schema.default !== undefined) { result.default(schema.default); }
          if (schema.schema !== undefined) {
            result.schema(parse(schema.schema, prefix+&#x22;[0]&#x22;, options));
          }
          if (typeof schema.min === &#x22;number&#x22;) { result.min(schema.min); }
          if (typeof schema.max === &#x22;number&#x22;) { result.max(schema.max); }
          if (typeof schema.length === &#x22;number&#x22;) { result.length(schema.length); }
          return result;
        case &#x27;Point&#x27;:
          result = type.point().options(options).validator(schema.validator);
          if (schema.default !== undefined) { result.default(schema.default); }
          return result;
        case &#x27;virtual&#x27;:
          result = type.virtual();
          if (schema.default !== undefined) { result.default(schema.default); }
          return result
        default: // Unknown type
          throw new Errors.ValidationError(&#x22;The field `_type` must be `String`/`Number`/`Boolean`/`Date`/`Buffer`/`Object`/`Array
`/`&#x27;virtual&#x27;`/`&#x27;Point&#x27;` for &#x22;+prefix);
      }
    }
    else if (type.isString(sc ...</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this._options = {};
this._options.enforce_missing = (options.enforce_missing != null) ? options.enforce_missing : thinky._options.enforce_missing;
this._options.enforce_extra = (options.enforce_extra != null) ? options.enforce_extra : thinky._options.enforce_extra;
this._options.enforce_type = (options.enforce_type != null) ? options.enforce_type : thinky._options.enforce_type;
this._options.timeFormat = (options.timeFormat != null) ? options.timeFormat : thinky._options.timeFormat;
this._options.validate = (options.validate != null) ? options.validate : thinky._options.validate;

this._schema = schemaUtil.<span class="apidocCodeKeywordSpan">parse</span>(schema, &#x27;&#x27;, this._options, this);
//console.log(JSON.stringify(this._schema, null, 2));

this.virtualFields = [];
this.defaultFields = [];
this._schema._getDefaultFields([], this.defaultFields, this.virtualFields)

this.needToGenerateFields = (this.defaultFields.length+this.virtualFields.length) !== 0;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.schema.validate" id="apidoc.element.thinky.schema.validate">
        function <span class="apidocSignatureSpan">thinky.schema.</span>validate
        <span class="apidocSignatureSpan">(doc, schema, prefix, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validate(doc, schema, prefix, options) {
  schema.validate(doc, prefix, options);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {Object=} modelToValidate Internal parameter, model to validate
* @return {Promise=} return a promise if the validation is asynchrone, else undefined.
*/
Document.prototype.validateAll = function(options, modelToValidate) {
 var validateAll = modelToValidate === undefined;
 modelToValidate = modelToValidate || {};

 return this.<span class="apidocCodeKeywordSpan">validate</span>(options, modelToValidate, validateAll, {}, &#x27;&#x27;, true);
}


/*
* Internal methods that will validate the document (but that will not execute the hooks).
* @param {Object=} options Options to overwrite the ones of the document.
* @param {Object=} modelToValidate Internal parameter, model to validate
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.thinky.util" id="apidoc.module.thinky.util">module thinky.util</a></h1>


    <h2>
        <a href="#apidoc.element.thinky.util.bindEmitter" id="apidoc.element.thinky.util.bindEmitter">
        function <span class="apidocSignatureSpan">thinky.util.</span>bindEmitter
        <span class="apidocSignatureSpan">(self)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function bindEmitter(self) {
  util.loopKeys(EventEmitter.prototype, function(emitter, key) {
    var fn = emitter[key];
    if (typeof fn === &#x27;function&#x27;) {
      self[key] = function() {
        var args = new Array(arguments.length);
        for(var i = 0; i &#x3c; arguments.length; i++) {
          args[i] = arguments[i];
        }
        fn.apply(self, args);
      }
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
options = options || {};
this._options = {};
this._options.timeFormat = (options.timeFormat != null) ? options.timeFormat : model.getOptions().timeFormat;
this._options.validate = (options.validate != null) ? options.validate : model.getOptions().validate;

this._saved = options.saved || false;  // Whether the document is saved or not

util.<span class="apidocCodeKeywordSpan">bindEmitter</span>(self);  // Copy methods from eventEmitter

// links to hasOne/hasMany documents
// We use it to know if some links have been removed/added before saving.
// Example: { key: doc } or { key: [docs] }
this._belongsTo = {};
this._hasOne = {};
this._hasMany = {};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.changeProto" id="apidoc.element.thinky.util.changeProto">
        function <span class="apidocSignatureSpan">thinky.util.</span>changeProto
        <span class="apidocSignatureSpan">(object, newProto)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function changeProto(object, newProto) {
  object.__proto__ = newProto;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  throw new Error(&#x22;Cannot build a new instance of `&#x22;+proto._name+&#x22;` without an object&#x22;)
}
// We create a deepcopy only if doc was already used to create a document
if (doc instanceof Document) {
  doc = util.deepCopy(doc);
}

util.<span class="apidocCodeKeywordSpan">changeProto</span>(doc, new Document(model, options));

// Create joins document. We do it here because `options` are easily available
util.loopKeys(proto._joins, function(joins, key) {
  if (doc[key] != null) {
    if ((joins[key].type === &#x27;hasOne&#x27;) &#x26;&#x26; (doc[key] instanceof Document === false)) {
      doc[key] = new joins[key].model(doc[key], options);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.deepCopy" id="apidoc.element.thinky.util.deepCopy">
        function <span class="apidocSignatureSpan">thinky.util.</span>deepCopy
        <span class="apidocSignatureSpan">(value)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function deepCopy(value) {
  var result;
  if (value instanceof Buffer) {
    // isPlainObject(buffer) returns true.
    return new Buffer(value);
  }

  if (isPlainObject(value) === true) {
    result = {};
    loopKeys(value, function(_value, key) {
      if (_value.hasOwnProperty(key)) {
        result[key] = deepCopy(_value[key]);
      }
    });
    return result;
  }

  if (Array.isArray(value)) {
    result = []
    for(var i=0; i&#x3c;value.length; i++) {
      result.push(deepCopy(value[i]));
    }
    return result;
  }

  return value;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 // when virtual fields are nested in arrays.
 // This implementation still allows no overhead if no virtual fields exist,
 // which should be the most common case
 for(var i=0; i&#x3c;this._getModel().virtualFields.length; i++) {
   var key = this._getModel().virtualFields[i].path[0];
   copy[key] = this[key];
 }
 this.__proto__.virtualValue = util.<span class="apidocCodeKeywordSpan">deepCopy</span>(copy);
}


/**
* Get the virtual fields saved by `_saveVirtual`.
* @return {Object=}
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.extraField" id="apidoc.element.thinky.util.extraField">
        function <span class="apidocSignatureSpan">thinky.util.</span>extraField
        <span class="apidocSignatureSpan">(prefix, key)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function extraField(prefix, key) {
  if (prefix === &#x27;&#x27;) {
    throw new Errors.ValidationError(&#x22;Extra field `&#x22;+key+&#x22;` not allowed.&#x22;)
  }
  throw new Errors.ValidationError(&#x22;Extra field `&#x22;+key+&#x22;` in &#x22;+prefix+&#x22; not allowed.&#x22;)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.extractPrimaryKey" id="apidoc.element.thinky.util.extractPrimaryKey">
        function <span class="apidocSignatureSpan">thinky.util.</span>extractPrimaryKey
        <span class="apidocSignatureSpan">(oldValue, newValue, primaryKey)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function extractPrimaryKey(oldValue, newValue, primaryKey) {
  var primaryKey;
  if (oldValue !== null) {
    return oldValue[primaryKey];
  }
  if (newValue !== null) {
    return newValue[primaryKey];
  }
  return undefined;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    else {
var revertPromises = [];
var primaryKeys = [];
var keysToValues = {};
var r = self._model._thinky.r;
for(var p=0; p&#x3c;result.changes.length; p++) {
  // Extract the primary key of the document saved in the database
  var primaryKey = util.<span class="apidocCodeKeywordSpan">extractPrimaryKey</span>(
      result.changes[p].old_val,
      result.changes[p].new_val,
      self._model._pk)
  if (primaryKey === undefined) {
    continue;
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.hook" id="apidoc.element.thinky.util.hook">
        function <span class="apidocSignatureSpan">thinky.util.</span>hook
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function hook(options) {
  var preHooks = options.preHooks;
  if (Array.isArray(preHooks) === false) {
    preHooks = [];
  }
  var postHooks = options.postHooks;
  if (Array.isArray(postHooks) === false) {
    postHooks = [];
  }
  var doc = options.doc; // We need the doc to set the context of the hooks
  var async = options.async || false;
  var fn = options.fn; // The function that we are hook
  var fnArgs = options.fnArgs;

  if (async === true) {
    return new Promise(function(resolve, reject) {
      _asyncHook({
        resolve: resolve,
        reject: reject,
        preHooks: preHooks,
        postHooks: postHooks,
        doc: doc,
        fn: fn,
        fnArgs: fnArgs
      });
    });
  }

  return _syncHook({
    preHooks: preHooks,
    postHooks: postHooks,
    doc: doc,
    fn: fn,
    fnArgs: fnArgs
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var self = this;
var validatedModelCopy = util.deepCopy(validatedModel);

//TODO: Can we not always call this?
var async = self._validateIsAsync(modelToValidate, validateAll, validatedModelCopy);

return util.<span class="apidocCodeKeywordSpan">hook</span>({
  preHooks: self._getModel()._pre.validate,
  postHooks: self._getModel()._post.validate,
  doc: self,
  async: async,
  fn: self._validateHook,
  fnArgs: [options, modelToValidate, validateAll, validatedModel, prefix]
})
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.isPlainObject" id="apidoc.element.thinky.util.isPlainObject">
        function <span class="apidocSignatureSpan">thinky.util.</span>isPlainObject
        <span class="apidocSignatureSpan">(obj)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function isPlainObject(obj) {
  return Object.prototype.toString.call(obj) === &#x27;[object Object]&#x27;;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var self = this;  // Keep a reference to itself.

this.constructor = model;  // The constructor for this model
this._model = model._getModel(); // The instance of Model

// We don&#x27;t want to store options if they are different
// than the one provided by the model
if (util.<span class="apidocCodeKeywordSpan">isPlainObject</span>(options)) {
  this._schemaOptions = {};
  this._schemaOptions.enforce_missing =
      (options.enforce_missing != null) ? options.enforce_missing : model.getOptions().enforce_missing;
  this._schemaOptions.enforce_extra =
      (options.enforce_extra != null) ? options.enforce_extra : model.getOptions().enforce_extra;
  this._schemaOptions.enforce_type =
      (options.enforce_type != null) ? options.enforce_type : model.getOptions().enforce_type;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.loopKeys" id="apidoc.element.thinky.util.loopKeys">
        function <span class="apidocSignatureSpan">thinky.util.</span>loopKeys
        <span class="apidocSignatureSpan">(obj, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function loopKeys(obj, fn) {
  if (isPlainObject(obj)) {
    var keys = Object.keys(obj);
    var result;
    for(var i=0; i&#x3c;keys.length; i++) {
      result = fn(obj, keys[i]);
      if (result === false) return;
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  _hasOne: {},      // &#x3c;tableName&#x3e;: [{doc, key}]
  _hasMany: {},     // &#x3c;tableName&#x3e;: [{doc, key}]
  _belongsTo: {},   // &#x3c;tableName&#x3e;: [{doc, key, foreignKey}]
  _belongsLinks: {} // &#x3c;tableName&#x3e;: [{doc, key}]
}

// Bind listeners of the model to this documents.
util.<span class="apidocCodeKeywordSpan">loopKeys</span>(model._listeners, function(listeners, eventKey) {
  for(var j=0; j&#x3c;listeners[eventKey].length; j++) {
    if (listeners[eventKey][j].once === false) {
      self.addListener(eventKey, listeners[eventKey][j].listener);
    }
    else if (listeners[eventKey][j].once === true) {
      self.once(eventKey, listeners[eventKey][j].listener);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.looseType" id="apidoc.element.thinky.util.looseType">
        function <span class="apidocSignatureSpan">thinky.util.</span>looseType
        <span class="apidocSignatureSpan">(prefix, expected)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function looseType(prefix, expected) {
  if ((expected.length &#x3e; 0) &#x26;&#x26; (vowels[expected[0]])) {
    throw new Errors.ValidationError(&#x22;Value for &#x22;+prefix+&#x22; must be an &#x22;+expected+&#x22; or null.&#x22;)
  }
  throw new Errors.ValidationError(&#x22;Value for &#x22;+prefix+&#x22; must be a &#x22;+expected+&#x22; or null.&#x22;)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.mergeOptions" id="apidoc.element.thinky.util.mergeOptions">
        function <span class="apidocSignatureSpan">thinky.util.</span>mergeOptions
        <span class="apidocSignatureSpan">(options, newOptions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function mergeOptions(options, newOptions) {
  if (util.isPlainObject(newOptions)) {
    if (!options) {
      options = {};
    }
    var localOptions = {};
    localOptions.enforce_missing = (newOptions.enforce_missing != null) ? newOptions.enforce_missing : options.enforce_missing;
    localOptions.enforce_type = (newOptions.enforce_type != null) ? newOptions.enforce_type : options.enforce_type;
    localOptions.enforce_extra = (newOptions.enforce_extra != null) ? newOptions.enforce_extra : options.enforce_extra;
    return localOptions;
  }
  return options;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Document.prototype._validateHook = function(options, modelToValidate, validateAll, validatedModel, prefix) {
var self = this;
var promises = [];
var error;

var schemaOptions = self._getSchemaOptions();
if (util.isPlainObject(schemaOptions)) {
  schemaOptions = util.<span class="apidocCodeKeywordSpan">mergeOptions</span>(schemaOptions, options);
}
else {
  schemaOptions = options;
}


if (typeof self._getModel()._validator === &#x27;function&#x27;) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.pseudoTypeError" id="apidoc.element.thinky.util.pseudoTypeError">
        function <span class="apidocSignatureSpan">thinky.util.</span>pseudoTypeError
        <span class="apidocSignatureSpan">(type, missingField, prefix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function pseudoTypeError(type, missingField, prefix) {
  throw new Errors.ValidationError(&#x22;The raw &#x22;+type+&#x22; object for &#x22;+prefix+&#x22; is missing the required field &#x22;+missingField+&#x22;.&#x22;)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.recurse" id="apidoc.element.thinky.util.recurse">
        function <span class="apidocSignatureSpan">thinky.util.</span>recurse
        <span class="apidocSignatureSpan">(key, joins, modelTo, all, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function recurse(key, joins, modelTo, all, done) {
  return (util.isPlainObject(modelTo) &#x26;&#x26; modelTo.hasOwnProperty(key))
    || ((all === true) &#x26;&#x26; (done[joins[key].model.getTableName()] !== true))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

var constructor = self.__proto__.constructor;
validatedModel[constructor.getTableName()] = true;

// Validate joined documents
util.loopKeys(self._getModel()._joins, function(joins, key) {
  if (util.<span class="apidocCodeKeywordSpan">recurse</span>(key, joins, modelToValidate, validateAll, validatedModel)) {
    switch (joins[key].type) {
      case &#x27;hasOne&#x27;:
      case &#x27;belongsTo&#x27;:
        if (util.isPlainObject(self[key])) {
          if (self[key] instanceof Document === false) {
            self[key] = new self._getModel()._joins[key].model(self[key]);
          }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.strictType" id="apidoc.element.thinky.util.strictType">
        function <span class="apidocSignatureSpan">thinky.util.</span>strictType
        <span class="apidocSignatureSpan">(prefix, expected)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function strictType(prefix, expected) {
  if ((expected.length &#x3e; 0) &#x26;&#x26; (vowels[expected[0]])) {
    throw new Errors.ValidationError(&#x22;Value for &#x22;+prefix+&#x22; must be an &#x22;+expected+&#x22;.&#x22;)
  }
  throw new Errors.ValidationError(&#x22;Value for &#x22;+prefix+&#x22; must be a &#x22;+expected+&#x22;.&#x22;)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.toArray" id="apidoc.element.thinky.util.toArray">
        function <span class="apidocSignatureSpan">thinky.util.</span>toArray
        <span class="apidocSignatureSpan">(args)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function toArray(args) {
    return Array.prototype.slice.call(args);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
        self._makeEmitter();
        setImmediate(function() {
          self.feed._each(self._eachCb.bind(self), function() {
            self._eventEmitter.emit(&#x27;end&#x27;);
          });
        });
      }
      self._eventEmitter[method].apply(self._eventEmitter, util.<span class="apidocCodeKeywordSpan">toArray</span>(arguments));
    };
  })(i);
}

module.exports = Feed;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.tryCatch" id="apidoc.element.thinky.util.tryCatch">
        function <span class="apidocSignatureSpan">thinky.util.</span>tryCatch
        <span class="apidocSignatureSpan">(toTry, handleError)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function tryCatch(toTry, handleError) {
  try{
    toTry()
  }
  catch(err) {
    handleError(err)
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    }
    return querySaveSelf = r.table(constructor.getTableName())
      .get(copy[model._pk]).replace(copy, {returnChanges: &#x27;always&#x27;})
  }
}

self.getModel().ready().then(function() {
  util.<span class="apidocCodeKeywordSpan">tryCatch</span>(function() {
    // Validate the document before saving it
    var promise = self.validate();
    if (promise instanceof Promise) {
      promise.then(function() {
        querySaveSelf = buildQuery();
        querySaveSelf.run().then(function(result) {
          self._onSaved(result, docToSave, saveAll, savedModel, resolve, reject)
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.undefinedField" id="apidoc.element.thinky.util.undefinedField">
        function <span class="apidocSignatureSpan">thinky.util.</span>undefinedField
        <span class="apidocSignatureSpan">(prefix)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function undefinedField(prefix) {
  throw new Errors.ValidationError(&#x22;Value for &#x22;+prefix+&#x22; must be defined.&#x22;)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.thinky.util.validateIfUndefined" id="apidoc.element.thinky.util.validateIfUndefined">
        function <span class="apidocSignatureSpan">thinky.util.</span>validateIfUndefined
        <span class="apidocSignatureSpan">(value, prefix, type, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function validateIfUndefined(value, prefix, type, options) {
  if (value === undefined) {
    if (options.enforce_missing === true) {
      undefinedField(prefix);
    }
    return true;
  }
  return false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
